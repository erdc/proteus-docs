<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Proteus &ndash; SWFlow API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX-AMS-MML_HTMLorMML.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Proteus &ndash; SWFlow API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The SWFlow API contains solvers for the the 2D nonlinear Shallow Water Equations, and the 2D dispersive Serre-Green-Naghdi equations (also known as Green-Naghdi equations, nonlinear Boussinesq, etc.). Both models are numerically solved using continuous, linear finite elements as seen in <a href="https://doi.org/10.1137/17M1156162">Guermond, <em>et al</em> 2018</a>, <a href="https://doi.org/10.1016/j.jcp.2019.108917">Guermond <em>et al</em> 2019</a> and [Guermond <em>et al</em> 2020].</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Getting Started</h1>
<p>These instructions will help you run and create new SWFlow tests on your local machine.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Prerequisites</h2>
<p>The only prerequisite that you need is a working copy of Proteus. If you have yet to build Proteus, go to your Proteus directory and run</p>
<div class="fragment"><div class="line">make develop</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3"></a>
Running the tests</h1>
<p>Each test is located in <code>proteus/tests/SWFlow/</code> and is a python file named something like <code>test_problem.py</code> (examples are <code><a class="el" href="dam3Bumps_8py.html">dam3Bumps.py</a></code>, <code>solitary_reef.py</code>, etc.). This is the file that sets up the computational domain, initial conditions, boundary conditions, and other problem specific options.</p>
<p>Each <code>test_problem.py</code> file has its own set of default context options. These include choosing which PDE model to use, final run time of the simulation, refinement level of mesh, etc. For example, in <code>proteus/tests/dam3Bumps.py</code>, a dam break problem with 3 conical obstacles, we see the following set of default options:</p>
<div class="fragment"><div class="line">opts = Context.Options([</div>
<div class="line">    (&#39;sw_model&#39;, 0, &quot;sw_model = {0,1} for {SWEs,DSWEs}&quot;),</div>
<div class="line">    (&quot;final_time&quot;, 20.0, &quot;Final time for simulation&quot;),</div>
<div class="line">    (&quot;dt_output&quot;, 0.1, &quot;Time interval to output solution&quot;),</div>
<div class="line">    (&quot;refinement&quot;, 4, &quot;Level of refinement&quot;),</div>
<div class="line">    (&quot;structured&quot;, True, &quot;Structured or unstructured mesh&quot;),</div>
<div class="line">    (&quot;he&quot;, 0.5, &quot;Mesh size for unstructured mesh&quot;),</div>
<div class="line">    (&quot;cfl&quot;, 0.33, &quot;Desired CFL restriction&quot;),</div>
<div class="line">    (&quot;reflecting_BCs&quot;, True, &quot;Use reflecting BCs&quot;),</div>
<div class="line">    (&quot;mannings&quot;, 0.02, &quot;Mannings roughness coefficient&quot;)</div>
<div class="line">])</div>
</div><!-- fragment --><p>Here <code>sw_model</code> refers to which PDE model is chosen: <code>0</code> for the Shallow Water Equations and <code>1</code> for the dispersive Serre&ndash;Saint-Venant (or "Dispersive SWEs"). The rest of the options are straight forward.</p>
<p>To run a test on a single processor, one can use the following commands:</p>
<div class="fragment"><div class="line">parun --SWEs -l1 -v dam3Bumps.py</div>
</div><!-- fragment --><p>or </p><div class="fragment"><div class="line">runSWEs.py -l1 -v -f dam3Bumps.py</div>
</div><!-- fragment --><p>which will execute the solver with the above default context options. The <code>-l1</code> flag controls the amount of output during the execution; you can choose any number between 1 and 10. The <code>-v</code> flag stands for verbose. (See the <code>proteus/parun.py</code> or <code>proteus/runSWEs.py</code> files for more details on the different flag options for <code>parun</code> and <code>runSWEs.py</code>.)</p>
<p>To use more than one processor, execute the following commands:</p>
<div class="fragment"><div class="line">mpiexec -np 4 parun --SWEs -l1 -v dam3Bumps.py</div>
</div><!-- fragment --><p>or </p><div class="fragment"><div class="line">mpiexec -np 4 runSWEs.py -l1 -v -f dam3Bumps.py</div>
</div><!-- fragment --><p>which runs the <code><a class="el" href="dam3Bumps_8py.html">dam3Bumps.py</a></code> problem on 4 processors.</p>
<p>To use options other than the default options, one can add these in the run command as follows:</p>
<div class="fragment"><div class="line">parun --SWEs -l1 -v dam3Bumps.py -C &quot;sw_model=1 final_time=100&quot;</div>
</div><!-- fragment --><p>which switches the model to the dispersive model and increases the final time to 100 seconds.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Creating a test</h1>
<p>Creating a new test is as simple as copying one of the existing files, and modifying appropriately to fit your needs.</p>
<p>Currently, most of the tests are set up to use a rectangular domain with triangle elements created by a function in <code>proteus/SpatialTool.py</code>. To see examples with slightly more complicated domains, take a look at <code><a class="el" href="mach__flow_8py.html">mach_flow.py</a></code> and <code><a class="el" href="obstacle__flow_8py.html">obstacle_flow.py</a></code>. The SWFlow API can be used with meshes created by Triangle and Gmsh. The "real world" tests such as the Malpesset problem use meshes created by the software SMS (<a href="https://www.aquaveo.com/software/sms-surface-water-modeling-system-introduction">https://www.aquaveo.com/software/sms-surface-water-modeling-system-introduction</a>) in the ADH format. If you would like to use your own mesh, but aren't sure how to use it, please contact us and we can gladly help.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Authors</h1>
<ul>
<li><b>Dr. Manuel Quezada De Luna</b></li>
<li><b>Dr. Chris Kees</b></li>
<li><b>Eric Tovar(*)</b></li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
Contributing</h1>
<p>Please read <a href="https://github.com/erdc/proteus/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a> for details on the Proteus code of conduct, and the process for submitting pull requests to us.</p>
<p>See also the list of Proteus <a href="https://github.com/erdc/proteus/blob/master/CONTRIBUTORS.md">contributors</a> who participated in this project.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
License</h1>
<p>This project is licensed under the MIT License - see the LICENSE.md file for details</p>
<h1><a class="anchor" id="autotoc_md10"></a>
References</h1>
<ul>
<li>J.-L. Guermond, M. Quezada de Luna, B. Popov, C. Kees, and M. Farthing. Well-balanced second-order finite element approximation of the shallow water equations with friction. SIAM Journal on Scientific Computing, 40(6):A3873â€“ A3901, 2018.</li>
<li>J.-L. Guermond, B. Popov, E. Tovar, C. Kees. Robust explicit relaxation technique for solving the Green-Naghdi equations. Journal of Computational Physics, Volume 399, 2019, 108917.</li>
<li>J.-L. Guermond, B. Popov, E. Tovar, C. Kees. Hyperbolic relaxation technique for solving the dispersive Saint-Venant shallow water equations with topography. Submitted, 2020. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
