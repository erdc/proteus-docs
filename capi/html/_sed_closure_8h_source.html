<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>proteus: SedClosure.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX-AMS-MML_HTMLorMML.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proteus
   &#160;<span id="projectnumber">1.8.1</span>
   </div>
   <div id="projectbrief">C/C++/Fortran libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_0b864a2621483f2d5e047492858c9f2a.html">cekees</a></li><li class="navelem"><a class="el" href="dir_4ad49f643cfe3beef94593057dbbb329.html">proteus</a></li><li class="navelem"><a class="el" href="dir_492f78248aacc14ac3304a897fd427ac.html">proteus</a></li><li class="navelem"><a class="el" href="dir_fe942153297951da8feb4e848dcf3066.html">mprans</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SedClosure.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_sed_closure_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SEDCLOSURE_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define SEDCLOSURE_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;xtensor-python/pyarray.hpp&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceproteus.html">proteus</a></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{  </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> nSpace&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html">   11</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html">cppHsuSedStress</a></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#af00a36372c63b832620d79a3ea9fc352">   14</a></span>&#160; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#af00a36372c63b832620d79a3ea9fc352">cppHsuSedStress</a>(</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                 <span class="keywordtype">double</span> aDarcy, <span class="comment">// darcy parameter for drag term. Default value from Ergun (1952) is 150</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                 <span class="keywordtype">double</span> betaForch, <span class="comment">// forchheimer parameter for drag term. Default value from Ergun (1952) is 1.75</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                 <span class="keywordtype">double</span> grain, <span class="comment">// Grain size, default assumed as d50</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                 <span class="keywordtype">double</span> packFraction, <span class="comment">//Critical volume fraction for switching the drag relation 0.2 by default, see Chen and Hsu 2014</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                 <span class="keywordtype">double</span> packMargin, <span class="comment">// For packFraction +- packmargin, the drag coefficient is calculated by taking a weighted combination of the two relation (for packed and non-packed sediment</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                 <span class="keywordtype">double</span> maxFraction,</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                 <span class="keywordtype">double</span> frFraction,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                 <span class="keywordtype">double</span> sigmaC,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                 <span class="keywordtype">double</span> C3e,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                 <span class="keywordtype">double</span> C4e,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                 <span class="keywordtype">double</span> eR,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                 <span class="keywordtype">double</span> fContact,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                 <span class="keywordtype">double</span> mContact,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                 <span class="keywordtype">double</span> nContact,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                 <span class="keywordtype">double</span> angFriction,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                 <span class="keywordtype">double</span> vos_limiter,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                 <span class="keywordtype">double</span> mu_fr_limiter</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;): </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae771a2f9ff8d1c9dcfdaebad1ef953c2">aDarcy_</a>(aDarcy), </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aeafe89f3c5beb814edd8bcc784000f7b">betaForch_</a>(betaForch), </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>(grain),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">packFraction_</a>(packFraction),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">packMargin_</a>(packMargin),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>(frFraction),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">maxFraction_</a>(maxFraction),    </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">sigmaC_</a>(sigmaC),  </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abdce1f6470ab69f24475b540579f6fea">C3e_</a>(C3e),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad89a75964bee316df977fed198b1ada0">C4e_</a>(C4e),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>(eR),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a1c3608989450828f4cdf8a1ebe501c6d">fContact_</a>(fContact),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">mContact_</a>(mContact),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">nContact_</a>(nContact),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aa9f23dda0b78d962752e9e9b3cb7a7ec">angFriction_</a>(angFriction),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>(1e-100),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#adc9e4f2c2aadfa1f8bae00c9413b5b67">notSoLarge_</a>(1e+6),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ac0a5922204ff6b4996d19507ddae00b6">large_</a>(1e+100),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">vos_limiter_</a>(vos_limiter),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3fecee907f597c66423e840db994f139">mu_fr_limiter_</a>(mu_fr_limiter)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;         </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a49e34b768295281f360d256bb58fdabf">   59</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a49e34b768295281f360d256bb58fdabf">xt_betaCoeff</a>(     </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                              <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                              <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                              )</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF, rhoFluid, uFluid.data(), uSolid.data(), nu);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">   71</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(     </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                              <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                              <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                              )</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">double</span> du2 = 0.;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        du2+= (uFluid[ii] - uSolid[ii])*(uFluid[ii] - uSolid[ii]);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> du = sqrt(du2);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">double</span> weight = 1.;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">double</span> gDrag1 = (<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae771a2f9ff8d1c9dcfdaebad1ef953c2">aDarcy_</a>*sedF*nu/((1. - sedF)*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aeafe89f3c5beb814edd8bcc784000f7b">betaForch_</a>*du/<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>); <span class="comment">// Darcy forchheimer term     </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">double</span> Cd = 0.44;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">double</span> Re = (1-sedF)*du*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>/nu;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">double</span> Re_min = 1.0e-3;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (Re &lt; 1000) </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        Cd = 24*(1. + 0.15*pow(fmax(Re_min,Re), 0.687))/fmax(Re_min,Re);                       <span class="comment">//Particle cloud resistance Wen and Yu 1966</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">double</span> gDrag2 = 0.75 * Cd * du * pow(1. - sedF, -1.65)/<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//cek  debug -- this makes the drag term nonlinear</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;     <span class="keywordflow">if</span>(sedF &lt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">packFraction_</a> + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">packMargin_</a>)  </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       {  </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;         <span class="keywordflow">if</span> (sedF &gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">packFraction_</a> - <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">packMargin_</a>) </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;           {       </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;             weight =  0.5 + 0.5* (sedF - <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">packFraction_</a>) /<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">packMargin_</a>; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           } </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;           {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            weight =  0.; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;           } </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       } </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> (weight*gDrag1 + (1.-weight)*gDrag2)*rhoFluid;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">  115</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(<span class="keywordtype">double</span> sedF)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordtype">double</span> g0(0.);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">if</span>(sedF&lt; 0.635)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordflow">if</span>(sedF&lt; 0.49)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              g0 = 0.5*(2.-sedF)/((1-sedF)*(1-sedF)*(1-sedF));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;              g0= 0.853744035/(0.64-sedF);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">else</span> g0 = 170.74880702;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> g0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a64ea9e606e572bac73b2a5ce6a9b917f">  133</a></span>&#160;     <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a64ea9e606e572bac73b2a5ce6a9b917f">xt_deps_sed_deps</a>(</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                      <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradC, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                      <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                      <span class="keywordtype">double</span> nuT_n,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; g)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a44ffa322af8d3911ebbf990b8a65986d">deps_sed_deps</a>(sedF,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                              rhoFluid,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                              rhoSolid,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                              uFluid.data(),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                              uSolid.data(),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                              gradC.data(),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                              nu,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                              theta_n,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                              kappa_n,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                              epsilon_n,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                              nuT_n,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                              g.data());</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;     }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a44ffa322af8d3911ebbf990b8a65986d">  162</a></span>&#160;     <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a44ffa322af8d3911ebbf990b8a65986d">deps_sed_deps</a>(</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;              <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace],</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace],</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> gradC[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                      <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                      <span class="keywordtype">double</span> nuT_n,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> g[nSpace])</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                   </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {              </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordtype">double</span> gs = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordtype">double</span> l_c = sqrt(M_PI)*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>/(24.*(sedF+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>)*gs);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordtype">double</span> t_p = rhoSolid/beta;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">double</span> t_c = l_c/(sqrt(theta_n) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordtype">double</span> t_l = 0.165*kappa_n/(epsilon_n + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordtype">double</span> t_cl = <a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_c,t_l);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">double</span> alpha= t_cl/(t_cl + t_p);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordtype">double</span> term = beta/(rhoFluid*(1.-sedF));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordtype">double</span> es_1 = 2.*term*(1-alpha)*sedF*kappa_n;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">double</span> g_gradC = 0.;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          g_gradC+= g[ii]*gradC[ii];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">double</span> ss = rhoSolid/rhoFluid - 1.;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">double</span> es_2 = nuT_n*ss*g_gradC/<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">sigmaC_</a>/(1.-sedF) ;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abdce1f6470ab69f24475b540579f6fea">C3e_</a> * es_1 / kappa_n +<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad89a75964bee316df977fed198b1ada0">C4e_</a> * es_2 / kappa_n;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                      </div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#af99c4eedfd1e5e563ffc64068fad5f70">  202</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#af99c4eedfd1e5e563ffc64068fad5f70">xt_kappa_sed1</a>(</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                      <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradC,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                      <span class="keywordtype">double</span> nu, </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                      <span class="keywordtype">double</span> nuT_n,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; g)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                           </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a657681b2fef174114162627c9b5307d7">kappa_sed1</a>(sedF,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                          rhoFluid,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                          rhoSolid,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                          uFluid.data(),</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                          uSolid.data(),</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                          gradC.data(),</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                          nu,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                          theta_n,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                          kappa_n,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                          epsilon_n,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                          nuT_n,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                          g.data());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a657681b2fef174114162627c9b5307d7">  231</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a657681b2fef174114162627c9b5307d7">kappa_sed1</a>(</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                      <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace],</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace],</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> gradC[nSpace],</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                      <span class="keywordtype">double</span> nu, </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                      <span class="keywordtype">double</span> nuT_n,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> g[nSpace])</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordtype">double</span> gs = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordtype">double</span> l_c = sqrt(M_PI)*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>/(24.*(sedF+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>)*gs);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordtype">double</span> t_p = rhoSolid/beta;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordtype">double</span> t_c = l_c/(sqrt(theta_n) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">double</span> t_l = 0.165*kappa_n/(epsilon_n + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">double</span> t_cl = <a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_c,t_l);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordtype">double</span> alpha= t_cl/(t_cl + t_p);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordtype">double</span> term = beta/(rhoFluid*(1.-sedF));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordtype">double</span> es_1 = 2.*term*(1-alpha)*sedF*kappa_n;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordtype">double</span> g_gradC = 0.;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          g_gradC+= g[ii]*gradC[ii];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">double</span> ss = rhoSolid/rhoFluid - 1.;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordtype">double</span> es_2 = nuT_n*ss*g_gradC/<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">sigmaC_</a>/(1.-sedF) ;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">return</span>  es_1  + es_2;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a48746ecc00597a81504cb32612f430a1">  269</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48746ecc00597a81504cb32612f430a1">xt_dkappa_sed1_dk</a>(</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                      <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                      <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradC, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                      <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                      <span class="keywordtype">double</span> nuT_n)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a65f44247cea053d71c0a6ceecec87de7">dkappa_sed1_dk</a>(sedF,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                              rhoFluid,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                              rhoSolid,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                              uFluid.data(),</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                              uSolid.data(),</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                              gradC.data(),</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                              nu,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                              theta_n,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                              kappa_n,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                              epsilon_n,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                              nuT_n);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a65f44247cea053d71c0a6ceecec87de7">  296</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a65f44247cea053d71c0a6ceecec87de7">dkappa_sed1_dk</a>(</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// Sediment fraction</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                      <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> gradC[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                      <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                      <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                      <span class="keywordtype">double</span> kappa_n,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                      <span class="keywordtype">double</span> epsilon_n,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                      <span class="keywordtype">double</span> nuT_n)                        </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {              </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordtype">double</span> gs = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordtype">double</span> l_c = sqrt(M_PI)*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>/(24.*(sedF+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>)*gs);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordtype">double</span> t_p = rhoSolid/beta;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordtype">double</span> t_c = l_c/(sqrt(theta_n) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordtype">double</span> t_l = 0.165*kappa_n/(epsilon_n + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordtype">double</span> t_cl = <a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_c,t_l);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordtype">double</span> alpha= t_cl/(t_cl + t_p);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordtype">double</span> term = beta/(rhoFluid*(1.-sedF));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordtype">double</span> es_1 = 2.*term*rhoSolid*(1-alpha)*sedF;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">return</span> es_1;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">  325</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">psc</a>(                <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                      <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                      <span class="keywordtype">double</span> theta )</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordtype">double</span> gs_0 = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordtype">double</span> eRp1 = 1.+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">psc</a> = rhoSolid * sedF * (1.+2.*eRp1*sedF*gs_0)*theta;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">psc</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a146e5117ee20ce1121e83e122ab71ac9">  336</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a146e5117ee20ce1121e83e122ab71ac9">psc_term</a>(                   <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                              <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                              <span class="keywordtype">double</span> theta_np1,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                              <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                              <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                              <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">return</span> -2.*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">psc</a>(sedF,rhoSolid,theta_np1)*(du_dx + dv_dy + dw_dz)/(3.*rhoSolid * sedF);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a61260d98f20e684c48a645d75057cf0a">  348</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a61260d98f20e684c48a645d75057cf0a">dpsc_term_dtheta</a>(                   <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                              <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                              <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                              <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                              <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordtype">double</span> gs_0 = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordtype">double</span> eRp1 = 1.+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordtype">double</span> dpsc = rhoSolid * sedF * (1.+2.*eRp1*sedF*gs_0);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">return</span> -2.*dpsc*(du_dx + dv_dy + dw_dz)/(3.*rhoSolid * sedF);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    </div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">  363</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">mu_sc</a>(                      <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                              <span class="keywordtype">double</span> rhoSolid, </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                              <span class="keywordtype">double</span> theta )</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordtype">double</span> gs_0 = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordtype">double</span> sq_pi = (sqrt(M_PI));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">double</span> sedF2 = sedF * sedF;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordtype">double</span> eRp1 = 1.+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordtype">double</span> sq_theta = sqrt(theta);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">mu_sc</a> = rhoSolid*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>*sq_theta*( 0.8*sedF2*gs_0*eRp1/(sq_pi) + (1./15.)*sq_pi*sedF2*gs_0*eRp1 + (1./6.)*sq_pi*sedF + (5./48)*sq_pi/(gs_0*eRp1) );</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">mu_sc</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ad122a8836e431653158b8c235960a597">  379</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad122a8836e431653158b8c235960a597">l_sc</a>(               <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                      <span class="keywordtype">double</span> rhoSolid, </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                      <span class="keywordtype">double</span> theta_n )</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordtype">double</span> gs_0 = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">double</span> sq_pi = (sqrt(M_PI));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordtype">double</span> sedF2 = sedF * sedF;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordtype">double</span> eRp1 = 1.+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordtype">double</span> sq_theta = sqrt(theta_n);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordtype">double</span> lambda = (4./3.)*sedF2*rhoSolid*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>*gs_0*eRp1*sq_theta/sq_pi;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">return</span> lambda;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a20966173a3b6be30ae0c1326cfc0b2a9">  401</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a20966173a3b6be30ae0c1326cfc0b2a9">tausc_term_theta</a>(</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                      <span class="keywordtype">double</span> sedF, <span class="comment">// IN</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                      <span class="keywordtype">double</span> rhoSolid, <span class="comment">//IN</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                      <span class="keywordtype">double</span> theta_n, <span class="comment">//IN</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                      <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                      <span class="keywordtype">double</span> du_dy,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                      <span class="keywordtype">double</span> du_dz,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                      <span class="keywordtype">double</span> dv_dx,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                      <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                      <span class="keywordtype">double</span> dv_dz,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                      <span class="keywordtype">double</span> dw_dx,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                      <span class="keywordtype">double</span> dw_dy,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                      <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                     </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                           </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    {              </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordtype">double</span> la = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad122a8836e431653158b8c235960a597">l_sc</a>(sedF, rhoSolid, theta_n);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordtype">double</span> mu = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">mu_sc</a>(sedF, rhoSolid, theta_n);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordtype">double</span> divU = du_dx + dv_dy + dw_dz;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordtype">double</span> t11 = 2*mu*du_dx + (la - (2./3.)*mu)*divU ;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordtype">double</span> t22 = 2*mu*dv_dy + (la - (2./3.)*mu)*divU ;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordtype">double</span> t33 = 2*mu*dw_dz + (la - (2./3.)*mu)*divU ;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordtype">double</span> t13 = mu*(du_dz + dw_dx);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordtype">double</span> t23 = mu*(dv_dz + dw_dy);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordtype">double</span> t12 = mu*(du_dy + dv_dx);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="comment">// No need to define t31, t32 and t21 as tensor is symmetric</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordtype">double</span> term = t11 * du_dx + t22 * dv_dy + t33 * dw_dz;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      term +=  t12*(du_dy +dv_dx);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      term +=  t13*(du_dz +dw_dx);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      term +=  t23*(dv_dz +dw_dy);                                                 </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">return</span> term* (2./3.) / (rhoSolid*sedF);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">  440</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">gamma_s</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                             <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                             <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                             <span class="keywordtype">double</span> theta_np1,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                             <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                             <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                             <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                              </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordtype">double</span> sq_pi = (sqrt(M_PI));</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">double</span> sq_theta = sqrt(theta_n);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordtype">double</span> divU = du_dx + dv_dy + dw_dz;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">gamma_s</a> =  - 2*(1-<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>)*sedF*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)*(4.*sq_theta/(sq_pi*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>) - divU)*theta_np1;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">gamma_s</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ae52a6a882e66dafa684423eb6b72172b">  457</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae52a6a882e66dafa684423eb6b72172b">dgamma_s_dtheta</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                             <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                             <span class="keywordtype">double</span> theta_n,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                             <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                             <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                             <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                              </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordtype">double</span> sq_pi = (sqrt(M_PI));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">double</span> sq_theta = sqrt(theta_n);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordtype">double</span> divU = du_dx + dv_dy + dw_dz;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">gamma_s</a> =  - 2*(1-<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>)*sedF*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)*(4.*sq_theta/(sq_pi*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>) - divU);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">gamma_s</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a6d7782e5f88a4fbfadd58a3337cae786">  473</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a6d7782e5f88a4fbfadd58a3337cae786">xt_jint1</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                           <span class="keywordtype">double</span> kappa,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                           <span class="keywordtype">double</span> epsilon,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                           <span class="keywordtype">double</span> theta,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                           <span class="keywordtype">double</span> nu)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a37dc7fccc7bb2c86373469d95e820d59">jint1</a>(sedF,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                     rhoFluid,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                     rhoSolid,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                     uFluid.data(),</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                     uSolid.data(),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                     kappa,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                     epsilon,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                     theta,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                     nu);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    </div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a37dc7fccc7bb2c86373469d95e820d59">  494</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a37dc7fccc7bb2c86373469d95e820d59">jint1</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace],</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace],</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                           <span class="keywordtype">double</span> kappa,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                           <span class="keywordtype">double</span> epsilon,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                           <span class="keywordtype">double</span> theta,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                           <span class="keywordtype">double</span> nu)                 </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordtype">double</span> gs = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordtype">double</span> l_c = sqrt(M_PI)*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>/(24.*(sedF+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>)*gs);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordtype">double</span> t_p = rhoSolid/beta;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordtype">double</span> t_c = l_c/(sqrt(theta) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordtype">double</span> t_l = 0.165*kappa/(epsilon + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordtype">double</span> t_cl = <a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_c,t_l);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordtype">double</span> alpha= t_cl/(t_cl + t_p);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordtype">double</span> Jint1 = 4. * alpha * beta * kappa /( 3.* rhoSolid)  ;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> Jint1;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a82a0955a1594681252e825a5c2b5bc4a">  518</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a82a0955a1594681252e825a5c2b5bc4a">xt_jint2</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                           <span class="keywordtype">double</span> theta,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                           <span class="keywordtype">double</span> nu)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab6df5e05ae6c7cb09bac5af8386f3e4d">jint2</a>(sedF,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                     rhoFluid,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                     rhoSolid,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                     uFluid.data(),</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                     uSolid.data(),</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                     theta,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                     nu);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ab6df5e05ae6c7cb09bac5af8386f3e4d">  536</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab6df5e05ae6c7cb09bac5af8386f3e4d">jint2</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace],</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace],</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                           <span class="keywordtype">double</span> theta,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                           <span class="keywordtype">double</span> nu)                 </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">return</span> - 2*beta*theta/rhoSolid;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a307420e5f8783966de5999035021583e">  550</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a307420e5f8783966de5999035021583e">xt_djint2_dtheta</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                           <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                           <span class="keywordtype">double</span> nu)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae03aca8f896454e17c794868b48d0582">djint2_dtheta</a>(sedF,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                             rhoFluid,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                             rhoSolid,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                             uFluid.data(),</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                             uSolid.data(),</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                             nu);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ae03aca8f896454e17c794868b48d0582">  565</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae03aca8f896454e17c794868b48d0582">djint2_dtheta</a>(  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                           <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid[nSpace],</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid[nSpace],</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                           <span class="keywordtype">double</span> nu)      </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid,uSolid,nu)+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">return</span> - 2*beta/rhoSolid;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a2577a0f2359811ac8a9a2f2f303c2cbc">  578</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2577a0f2359811ac8a9a2f2f303c2cbc">k_diff</a>(                     <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                              <span class="keywordtype">double</span> rhoSolid, </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                              <span class="keywordtype">double</span> theta )</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordtype">double</span> gs_0 = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">gs0</a>(sedF);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordtype">double</span> sq_pi = (sqrt(M_PI));</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordtype">double</span> sedF2 = sedF * sedF;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keywordtype">double</span> eRp1 = 1.+<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordtype">double</span> sq_theta = sqrt(theta);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2577a0f2359811ac8a9a2f2f303c2cbc">k_diff</a> = rhoSolid*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>*sq_theta*( 2.*sedF2*gs_0*eRp1/(sq_pi) + (0.5625)*sq_pi*sedF2*gs_0*eRp1 + (0.9375)*sq_pi*sedF + (0.390625)*sq_pi/(gs_0*eRp1) );</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2577a0f2359811ac8a9a2f2f303c2cbc">k_diff</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   </div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">  594</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">p_friction</a>(<span class="keywordtype">double</span> sedF)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> = 0.;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">if</span> (sedF &gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keywordtype">double</span> sedLim =<a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(sedF,<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">vos_limiter_</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> =<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a1c3608989450828f4cdf8a1ebe501c6d">fContact_</a>*pow(sedLim-<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>,<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">mContact_</a>) / ( pow(<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">maxFraction_</a> - sedLim,<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">nContact_</a>) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        } </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    </div>
<div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#accfc23ce49b0b588fc1104786d8d2bb8">  609</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#accfc23ce49b0b588fc1104786d8d2bb8">gradp_friction</a>(<span class="keywordtype">double</span> sedF)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#ae62d0b7e5a1af6ff6d6257554340d2d1">coeff</a> = 0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">p_friction</a>(sedF);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">if</span> (sedF &gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a> ) </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keywordtype">double</span> sedLim =<a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(sedF,<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">vos_limiter_</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keywordtype">double</span> den1 = (sedLim - <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keywordtype">double</span> den2 = (<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">maxFraction_</a> - sedLim);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <a class="code" href="_headers_8h.html#ae62d0b7e5a1af6ff6d6257554340d2d1">coeff</a> = <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> *( (<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">mContact_</a>/den1) + (<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">nContact_</a>/den2) );</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_headers_8h.html#ae62d0b7e5a1af6ff6d6257554340d2d1">coeff</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">  626</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">mu_fr</a>(<span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                      <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                      <span class="keywordtype">double</span> du_dy,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                      <span class="keywordtype">double</span> du_dz,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                      <span class="keywordtype">double</span> dv_dx,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                      <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                      <span class="keywordtype">double</span> dv_dz,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                      <span class="keywordtype">double</span> dw_dx,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                      <span class="keywordtype">double</span> dw_dy,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                          <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordtype">double</span> divU = du_dx + dv_dy + dw_dz;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">p_friction</a>(sedF);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordtype">double</span> s11 = du_dx - (1./nSpace)*divU;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordtype">double</span> s22 = dv_dy - (1./nSpace)*divU;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordtype">double</span> s33 = dw_dz - (1./nSpace)*divU;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordtype">double</span> s12 = 0.5*(du_dy + dv_dx);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordtype">double</span> s13 = 0.5*(du_dz + dw_dx);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordtype">double</span> s23 = 0.5*(dv_dz + dw_dy);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordtype">double</span> sumS = s11*s11 + s22*s22 + s33*s33 + 2.*s12*s12 + 2.*s13*s13 + 2.*s23*s23;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordtype">double</span> mu_sf = 0.0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">mu_fr</a> = 0.0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">if</span> (sedF &gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>) </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          mu_sf = <a class="code" href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a> * sqrt(2.) * sin(<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aa9f23dda0b78d962752e9e9b3cb7a7ec">angFriction_</a>) / (2 * sqrt(sumS) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">mu_fr</a> = <a class="code" href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(mu_sf,<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3fecee907f597c66423e840db994f139">mu_fr_limiter_</a>); </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        } </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">//      if (sedF  &gt; 0.0 )</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//      {</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">//     printf(&quot;sedF --&gt; %2.20f&quot;, sedF);</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">//      } </span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">//      if (mu_sf  &gt; 0.0 )</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">//      {</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">//     printf(&quot;mu_sf --&gt; %2.20f&quot;, mu_sf);</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">//      } </span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">//      if (mu_fr  &gt; 0.0 )</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">//      {</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">//     printf(&quot;mu_fr --&gt; %2.20f&quot;, mu_fr);</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">//      } </span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">//      if (pf  &gt; 0.0 )</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">//      {</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">//     printf(&quot;pf --&gt; %2.20f&quot;, pf);</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//      } </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">mu_fr</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">    inline double  diffusion_theta_rhs(  double sedF,</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">                                         double rhoSolid,</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">                                     double theta_n,</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">                                     double dtheta_dx,</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">                                     double dtheta_dy,</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">                                     double dtheta_dz</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">                              )</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">      double gs_0 = gs0(sedF);</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">      double sq_pi = (sqrt(M_PI));</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">      double sedF2 = sedF * sedF;</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">      double eRp1 = 1.+eR_;</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">      double sq_theta = sqrt(theta_n);</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">      double divTheta = dtheta_dx + dtheta_dy + dtheta_dz; </span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">      double k_diff = k_diff(rhoSolid);</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">      return kappa*divTheta;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">      }*/</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a47ebe9f796f264249cc782a0344e8de4">  711</a></span>&#160;    <span class="keyword">inline</span> xt::pyarray&lt;double&gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a47ebe9f796f264249cc782a0344e8de4">xt_mIntFluid</a>(<span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_n, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_n, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_np1, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                              <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                              <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradc</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                              )</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keyword">auto</span> mint2 = xt::pyarray&lt;double&gt;::from_shape({2});</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48e42a47d37eb6e141f220f74403bf02">mIntFluid</a>(mint2.data(),</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                  sedF,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  rhoFluid,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                  uFluid_n.data(),</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  uSolid_n.data(),</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  uFluid_np1.data(),</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                  nu,</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                  nuT,</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  gradc.data());</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">return</span> mint2;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a48e42a47d37eb6e141f220f74403bf02">  734</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48e42a47d37eb6e141f220f74403bf02">mIntFluid</a>( <span class="keywordtype">double</span> * mint2, <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_n[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_n[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_np1[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                              <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                              <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> gradc[nSpace]</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                              )</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid_n,uSolid_n,nu);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          mint2[ii] =  -sedF*beta*(uFluid_np1[ii])/(rhoFluid * (1. - sedF)) ;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ab8a4618211c3fe135e54f894611faf1a">  753</a></span>&#160;    <span class="keyword">inline</span> xt::pyarray&lt;double&gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab8a4618211c3fe135e54f894611faf1a">xt_mIntSolid</a>(<span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_n, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_n, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_np1, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                              <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                              <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradc</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                              )</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keyword">auto</span> mint2 = xt::pyarray&lt;double&gt;::from_shape({2});</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a797c94651bcd7f567f5dc5a1b6f2e31e">mIntSolid</a>(mint2.data(),</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                  sedF,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                  rhoFluid,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                  uFluid_n.data(),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                  uSolid_n.data(),</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                  uSolid_np1.data(),</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                  nu,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                  nuT,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                  gradc.data());</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">return</span> mint2;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a797c94651bcd7f567f5dc5a1b6f2e31e">  776</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a797c94651bcd7f567f5dc5a1b6f2e31e">mIntSolid</a>(   <span class="keywordtype">double</span> * mint2, <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_n[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_n[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_np1[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                              <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                              <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> gradc[nSpace]</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                              )</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid_n,uSolid_n,nu);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          mint2[ii] = -sedF*beta*(-uSolid_np1[ii])/(rhoFluid * (1. - sedF)) ;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a4754259322d52af936e1648353e3e11c">  794</a></span>&#160;    <span class="keyword">inline</span> xt::pyarray&lt;double&gt; <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a4754259322d52af936e1648353e3e11c">xt_mIntgradC</a>(<span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                  <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_n, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                  <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_n, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                  <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                  <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                                  <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; gradc</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                              )</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keyword">auto</span> mint2 = xt::pyarray&lt;double&gt;::from_shape({2});</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab0b7bed15129e50d4d2b3d0106bacd99">mIntgradC</a>(mint2.data(),</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                  sedF,</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                  rhoFluid,</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                  uFluid_n.data(),</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                  uSolid_n.data(),</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                  nu,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                  nuT,</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                  gradc.data());</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">return</span> mint2;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ab0b7bed15129e50d4d2b3d0106bacd99">  816</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab0b7bed15129e50d4d2b3d0106bacd99">mIntgradC</a>(<span class="keywordtype">double</span> * mint2,  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_n[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_n[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                  <span class="keywordtype">double</span> nu, <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                  <span class="keywordtype">double</span> nuT, <span class="comment">//Turbulent viscosity</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> gradc[nSpace]</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                              )</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordtype">double</span> beta = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid_n,uSolid_n,nu);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> ii=0; ii&lt;nSpace;  ii++)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          mint2[ii] = - sedF*beta*nuT*gradc[ii]/<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">sigmaC_</a>/(rhoFluid * (1. - sedF));</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   </div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#aeb06426a450fa4c85300c177828b3209">  838</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aeb06426a450fa4c85300c177828b3209">xt_dmInt_duFluid</a></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                            (  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_n, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_n, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                              )</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3120394f6f4021777b40bbd61e5861ae">dmInt_duFluid</a>(sedF,</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                             rhoFluid,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                             uFluid_n.data(),</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                             uSolid_n.data(),</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                             nu);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a3120394f6f4021777b40bbd61e5861ae">  854</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3120394f6f4021777b40bbd61e5861ae">dmInt_duFluid</a></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                            (  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_n[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_n[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                              )</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">return</span> -sedF*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid_n,uSolid_n,nu)/(rhoFluid * (1. - sedF));</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a7ba03c7509517323212ec5abc1785584">  868</a></span>&#160;       <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a7ba03c7509517323212ec5abc1785584">xt_dmInt_duSolid</a></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                            (  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uFluid_n, <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                              <span class="keyword">const</span> xt::pyarray&lt;double&gt;&amp; uSolid_n, <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                              )</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab121e71bde7552bd5b4e63d2bec399f6">dmInt_duSolid</a>(sedF,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                             rhoFluid,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                             uFluid_n.data(),</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                             uSolid_n.data(),</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                             nu);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ab121e71bde7552bd5b4e63d2bec399f6">  884</a></span>&#160;       <span class="keyword">inline</span> <span class="keywordtype">double</span>  <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab121e71bde7552bd5b4e63d2bec399f6">dmInt_duSolid</a></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                            (  <span class="keywordtype">double</span> sedF,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                           <span class="keywordtype">double</span> rhoFluid,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uFluid_n[nSpace], <span class="comment">//Fluid velocity</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> uSolid_n[nSpace], <span class="comment">//Sediment velocity</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                              <span class="keywordtype">double</span> nu <span class="comment">//Kinematic viscosity</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                              )</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">return</span> +sedF*<a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">betaCoeff</a>(sedF,rhoFluid,uFluid_n,uSolid_n,nu)/(rhoFluid * (1. - sedF));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a0c7291ee62d0991a73cef9bf9e520ee3">  897</a></span>&#160;       <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a0c7291ee62d0991a73cef9bf9e520ee3">p_s</a>(                     <span class="keywordtype">double</span> sedF, </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                              <span class="keywordtype">double</span> rhoSolid,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                                              <span class="keywordtype">double</span> theta,</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                              <span class="keywordtype">double</span> du_dx,</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                              <span class="keywordtype">double</span> du_dy,</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                              <span class="keywordtype">double</span> du_dz,</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                              <span class="keywordtype">double</span> dv_dx,</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                              <span class="keywordtype">double</span> dv_dy,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                              <span class="keywordtype">double</span> dv_dz,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                              <span class="keywordtype">double</span> dw_dx,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                              <span class="keywordtype">double</span> dw_dy,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                              <span class="keywordtype">double</span> dw_dz)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordtype">double</span> divU = du_dx + dv_dy + dw_dz;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordtype">double</span> mf = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">mu_fr</a>(sedF, du_dx, du_dy, du_dz, dv_dx, dv_dy, dv_dz, dw_dx, dw_dy, dw_dz);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordtype">double</span> msc = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">mu_sc</a>(sedF, rhoSolid, theta );</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordtype">double</span> lam = <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad122a8836e431653158b8c235960a597">l_sc</a>(sedF, rhoSolid, theta );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordtype">double</span> pcorr = ( (2./3.)*(msc + mf) - lam ) * divU;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">p_friction</a>(sedF) + <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">psc</a>(sedF, rhoSolid, theta) + pcorr ;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ae771a2f9ff8d1c9dcfdaebad1ef953c2">  925</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ae771a2f9ff8d1c9dcfdaebad1ef953c2">aDarcy_</a>;</div>
<div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#aeafe89f3c5beb814edd8bcc784000f7b">  926</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aeafe89f3c5beb814edd8bcc784000f7b">betaForch_</a>;</div>
<div class="line"><a name="l00927"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">  927</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">grain_</a>; </div>
<div class="line"><a name="l00928"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">  928</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">packFraction_</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">  929</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">packMargin_</a>;</div>
<div class="line"><a name="l00930"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">  930</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">frFraction_</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">  931</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">maxFraction_</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">  932</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">sigmaC_</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#abdce1f6470ab69f24475b540579f6fea">  933</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abdce1f6470ab69f24475b540579f6fea">C3e_</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ad89a75964bee316df977fed198b1ada0">  934</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ad89a75964bee316df977fed198b1ada0">C4e_</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">  935</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">eR_</a>;</div>
<div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a1c3608989450828f4cdf8a1ebe501c6d">  936</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a1c3608989450828f4cdf8a1ebe501c6d">fContact_</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">  937</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">mContact_</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">  938</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">nContact_</a>;</div>
<div class="line"><a name="l00939"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#aa9f23dda0b78d962752e9e9b3cb7a7ec">  939</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#aa9f23dda0b78d962752e9e9b3cb7a7ec">angFriction_</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">  940</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">small_</a>;</div>
<div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#adc9e4f2c2aadfa1f8bae00c9413b5b67">  941</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#adc9e4f2c2aadfa1f8bae00c9413b5b67">notSoLarge_</a>;</div>
<div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#ac0a5922204ff6b4996d19507ddae00b6">  942</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#ac0a5922204ff6b4996d19507ddae00b6">large_</a>;</div>
<div class="line"><a name="l00943"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">  943</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">vos_limiter_</a>;</div>
<div class="line"><a name="l00944"></a><span class="lineno"><a class="line" href="classproteus_1_1cpp_hsu_sed_stress.html#a3fecee907f597c66423e840db994f139">  944</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html#a3fecee907f597c66423e840db994f139">mu_fr_limiter_</a>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;};</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno"><a class="line" href="namespaceproteus.html#ad6e60169b6d890f254386e6473efd3e0">  948</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classproteus_1_1cpp_hsu_sed_stress.html">cppHsuSedStress&lt;2&gt;</a> <a class="code" href="namespaceproteus.html#ad6e60169b6d890f254386e6473efd3e0">cppHsuSedStress2D</a>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;}</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ae52a6a882e66dafa684423eb6b72172b"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ae52a6a882e66dafa684423eb6b72172b">proteus::cppHsuSedStress::dgamma_s_dtheta</a></div><div class="ttdeci">double dgamma_s_dtheta(double sedF, double rhoSolid, double theta_n, double du_dx, double dv_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00457">SedClosure.h:457</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a37dc7fccc7bb2c86373469d95e820d59"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a37dc7fccc7bb2c86373469d95e820d59">proteus::cppHsuSedStress::jint1</a></div><div class="ttdeci">double jint1(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], double kappa, double epsilon, double theta, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00494">SedClosure.h:494</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a82a0955a1594681252e825a5c2b5bc4a"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a82a0955a1594681252e825a5c2b5bc4a">proteus::cppHsuSedStress::xt_jint2</a></div><div class="ttdeci">double xt_jint2(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, double theta, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00518">SedClosure.h:518</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a6d7782e5f88a4fbfadd58a3337cae786"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a6d7782e5f88a4fbfadd58a3337cae786">proteus::cppHsuSedStress::xt_jint1</a></div><div class="ttdeci">double xt_jint1(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, double kappa, double epsilon, double theta, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00473">SedClosure.h:473</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a797c94651bcd7f567f5dc5a1b6f2e31e"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a797c94651bcd7f567f5dc5a1b6f2e31e">proteus::cppHsuSedStress::mIntSolid</a></div><div class="ttdeci">void mIntSolid(double *mint2, double sedF, double rhoFluid, const double uFluid_n[nSpace], const double uSolid_n[nSpace], const double uSolid_np1[nSpace], double nu, double nuT, const double gradc[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00776">SedClosure.h:776</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a51aab86ff789ec3c042baa1dcdade474"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a51aab86ff789ec3c042baa1dcdade474">proteus::cppHsuSedStress::grain_</a></div><div class="ttdeci">double grain_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00927">SedClosure.h:927</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ada2e498d032394502b157b4fd06bf82a"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ada2e498d032394502b157b4fd06bf82a">proteus::cppHsuSedStress::mu_sc</a></div><div class="ttdeci">double mu_sc(double sedF, double rhoSolid, double theta)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00363">SedClosure.h:363</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a3fecee907f597c66423e840db994f139"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a3fecee907f597c66423e840db994f139">proteus::cppHsuSedStress::mu_fr_limiter_</a></div><div class="ttdeci">double mu_fr_limiter_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00944">SedClosure.h:944</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a0c7291ee62d0991a73cef9bf9e520ee3"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a0c7291ee62d0991a73cef9bf9e520ee3">proteus::cppHsuSedStress::p_s</a></div><div class="ttdeci">double p_s(double sedF, double rhoSolid, double theta, double du_dx, double du_dy, double du_dz, double dv_dx, double dv_dy, double dv_dz, double dw_dx, double dw_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00897">SedClosure.h:897</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a64ea9e606e572bac73b2a5ce6a9b917f"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a64ea9e606e572bac73b2a5ce6a9b917f">proteus::cppHsuSedStress::xt_deps_sed_deps</a></div><div class="ttdeci">double xt_deps_sed_deps(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, const xt::pyarray&lt; double &gt; &amp;gradC, double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n, const xt::pyarray&lt; double &gt; &amp;g)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00133">SedClosure.h:133</a></div></div>
<div class="ttc" id="anamespaceproteus_html_ad6e60169b6d890f254386e6473efd3e0"><div class="ttname"><a href="namespaceproteus.html#ad6e60169b6d890f254386e6473efd3e0">proteus::cppHsuSedStress2D</a></div><div class="ttdeci">cppHsuSedStress&lt; 2 &gt; cppHsuSedStress2D</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00948">SedClosure.h:948</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ab121e71bde7552bd5b4e63d2bec399f6"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ab121e71bde7552bd5b4e63d2bec399f6">proteus::cppHsuSedStress::dmInt_duSolid</a></div><div class="ttdeci">double dmInt_duSolid(double sedF, double rhoFluid, const double uFluid_n[nSpace], const double uSolid_n[nSpace], double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00884">SedClosure.h:885</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a1c3608989450828f4cdf8a1ebe501c6d"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a1c3608989450828f4cdf8a1ebe501c6d">proteus::cppHsuSedStress::fContact_</a></div><div class="ttdeci">double fContact_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00936">SedClosure.h:936</a></div></div>
<div class="ttc" id="ajf_8h_html_a8ed7b83d132a542e57a2b1b6cac74aad"><div class="ttname"><a href="jf_8h.html#a8ed7b83d132a542e57a2b1b6cac74aad">pf</a></div><div class="ttdeci">#define pf(x)</div><div class="ttdef"><b>Definition:</b> <a href="jf_8h_source.html#l00023">jf.h:23</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ad122a8836e431653158b8c235960a597"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ad122a8836e431653158b8c235960a597">proteus::cppHsuSedStress::l_sc</a></div><div class="ttdeci">double l_sc(double sedF, double rhoSolid, double theta_n)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00379">SedClosure.h:379</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a657681b2fef174114162627c9b5307d7"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a657681b2fef174114162627c9b5307d7">proteus::cppHsuSedStress::kappa_sed1</a></div><div class="ttdeci">double kappa_sed1(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], const double gradC[nSpace], double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n, const double g[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00231">SedClosure.h:231</a></div></div>
<div class="ttc" id="a_headers_8h_html_ae62d0b7e5a1af6ff6d6257554340d2d1"><div class="ttname"><a href="_headers_8h.html#ae62d0b7e5a1af6ff6d6257554340d2d1">coeff</a></div><div class="ttdeci">Double * coeff</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00042">Headers.h:42</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ab0b7bed15129e50d4d2b3d0106bacd99"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ab0b7bed15129e50d4d2b3d0106bacd99">proteus::cppHsuSedStress::mIntgradC</a></div><div class="ttdeci">void mIntgradC(double *mint2, double sedF, double rhoFluid, const double uFluid_n[nSpace], const double uSolid_n[nSpace], double nu, double nuT, const double gradc[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00816">SedClosure.h:816</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a12646787f736e7c71cb84401db07bcc5"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a12646787f736e7c71cb84401db07bcc5">proteus::cppHsuSedStress::psc</a></div><div class="ttdeci">double psc(double sedF, double rhoSolid, double theta)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00325">SedClosure.h:325</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_abdce1f6470ab69f24475b540579f6fea"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#abdce1f6470ab69f24475b540579f6fea">proteus::cppHsuSedStress::C3e_</a></div><div class="ttdeci">double C3e_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00933">SedClosure.h:933</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a7ba03c7509517323212ec5abc1785584"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a7ba03c7509517323212ec5abc1785584">proteus::cppHsuSedStress::xt_dmInt_duSolid</a></div><div class="ttdeci">double xt_dmInt_duSolid(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_n, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00868">SedClosure.h:869</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a20966173a3b6be30ae0c1326cfc0b2a9"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a20966173a3b6be30ae0c1326cfc0b2a9">proteus::cppHsuSedStress::tausc_term_theta</a></div><div class="ttdeci">double tausc_term_theta(double sedF, double rhoSolid, double theta_n, double du_dx, double du_dy, double du_dz, double dv_dx, double dv_dy, double dv_dz, double dw_dx, double dw_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00401">SedClosure.h:401</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_afec6cf7081d58a646eda5db3998a2114"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#afec6cf7081d58a646eda5db3998a2114">proteus::cppHsuSedStress::gamma_s</a></div><div class="ttdeci">double gamma_s(double sedF, double rhoSolid, double theta_n, double theta_np1, double du_dx, double dv_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00440">SedClosure.h:440</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ab9bcda64d491498219bdf32f21eb2f48"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ab9bcda64d491498219bdf32f21eb2f48">proteus::cppHsuSedStress::small_</a></div><div class="ttdeci">double small_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00940">SedClosure.h:940</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a49e34b768295281f360d256bb58fdabf"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a49e34b768295281f360d256bb58fdabf">proteus::cppHsuSedStress::xt_betaCoeff</a></div><div class="ttdeci">double xt_betaCoeff(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00059">SedClosure.h:59</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a44ffa322af8d3911ebbf990b8a65986d"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a44ffa322af8d3911ebbf990b8a65986d">proteus::cppHsuSedStress::deps_sed_deps</a></div><div class="ttdeci">double deps_sed_deps(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], const double gradC[nSpace], double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n, const double g[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00162">SedClosure.h:162</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a307420e5f8783966de5999035021583e"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a307420e5f8783966de5999035021583e">proteus::cppHsuSedStress::xt_djint2_dtheta</a></div><div class="ttdeci">double xt_djint2_dtheta(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00550">SedClosure.h:550</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a8d28107b126a8e8d8e151375d448ad5b"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a8d28107b126a8e8d8e151375d448ad5b">proteus::cppHsuSedStress::frFraction_</a></div><div class="ttdeci">double frFraction_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00930">SedClosure.h:930</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ab6df5e05ae6c7cb09bac5af8386f3e4d"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ab6df5e05ae6c7cb09bac5af8386f3e4d">proteus::cppHsuSedStress::jint2</a></div><div class="ttdeci">double jint2(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], double theta, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00536">SedClosure.h:536</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a4754259322d52af936e1648353e3e11c"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a4754259322d52af936e1648353e3e11c">proteus::cppHsuSedStress::xt_mIntgradC</a></div><div class="ttdeci">xt::pyarray&lt; double &gt; xt_mIntgradC(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_n, double nu, double nuT, const xt::pyarray&lt; double &gt; &amp;gradc)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00794">SedClosure.h:794</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a9621e2999678f1eecbcafec0e28e223a"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a9621e2999678f1eecbcafec0e28e223a">proteus::cppHsuSedStress::p_friction</a></div><div class="ttdeci">double p_friction(double sedF)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00594">SedClosure.h:594</a></div></div>
<div class="ttc" id="ajf_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="jf_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="jf_8h_source.html#l00071">jf.h:71</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ad89a75964bee316df977fed198b1ada0"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ad89a75964bee316df977fed198b1ada0">proteus::cppHsuSedStress::C4e_</a></div><div class="ttdeci">double C4e_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00934">SedClosure.h:934</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a2d93dc9105637b6fbdb62d1ff5e2b62b"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a2d93dc9105637b6fbdb62d1ff5e2b62b">proteus::cppHsuSedStress::maxFraction_</a></div><div class="ttdeci">double maxFraction_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00931">SedClosure.h:931</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a48798fabb45d37fe1ce7803983ccc7f3"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a48798fabb45d37fe1ce7803983ccc7f3">proteus::cppHsuSedStress::betaCoeff</a></div><div class="ttdeci">double betaCoeff(double sedF, double rhoFluid, const double uFluid[nSpace], const double uSolid[nSpace], double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00071">SedClosure.h:71</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_abba2fab312c239f49bd759d378c41bbb"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#abba2fab312c239f49bd759d378c41bbb">proteus::cppHsuSedStress::nContact_</a></div><div class="ttdeci">double nContact_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00938">SedClosure.h:938</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a48e42a47d37eb6e141f220f74403bf02"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a48e42a47d37eb6e141f220f74403bf02">proteus::cppHsuSedStress::mIntFluid</a></div><div class="ttdeci">void mIntFluid(double *mint2, double sedF, double rhoFluid, const double uFluid_n[nSpace], const double uSolid_n[nSpace], const double uFluid_np1[nSpace], double nu, double nuT, const double gradc[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00734">SedClosure.h:734</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_af00a36372c63b832620d79a3ea9fc352"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#af00a36372c63b832620d79a3ea9fc352">proteus::cppHsuSedStress::cppHsuSedStress</a></div><div class="ttdeci">cppHsuSedStress(double aDarcy, double betaForch, double grain, double packFraction, double packMargin, double maxFraction, double frFraction, double sigmaC, double C3e, double C4e, double eR, double fContact, double mContact, double nContact, double angFriction, double vos_limiter, double mu_fr_limiter)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00014">SedClosure.h:14</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a48746ecc00597a81504cb32612f430a1"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a48746ecc00597a81504cb32612f430a1">proteus::cppHsuSedStress::xt_dkappa_sed1_dk</a></div><div class="ttdeci">double xt_dkappa_sed1_dk(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, const xt::pyarray&lt; double &gt; &amp;gradC, double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00269">SedClosure.h:269</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_aa9f23dda0b78d962752e9e9b3cb7a7ec"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#aa9f23dda0b78d962752e9e9b3cb7a7ec">proteus::cppHsuSedStress::angFriction_</a></div><div class="ttdeci">double angFriction_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00939">SedClosure.h:939</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a146e5117ee20ce1121e83e122ab71ac9"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a146e5117ee20ce1121e83e122ab71ac9">proteus::cppHsuSedStress::psc_term</a></div><div class="ttdeci">double psc_term(double sedF, double rhoSolid, double theta_np1, double du_dx, double dv_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00336">SedClosure.h:336</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ae58bfea01138a784058b6f40925b8fec"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ae58bfea01138a784058b6f40925b8fec">proteus::cppHsuSedStress::gs0</a></div><div class="ttdeci">double gs0(double sedF)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00115">SedClosure.h:115</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_accfc23ce49b0b588fc1104786d8d2bb8"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#accfc23ce49b0b588fc1104786d8d2bb8">proteus::cppHsuSedStress::gradp_friction</a></div><div class="ttdeci">double gradp_friction(double sedF)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00609">SedClosure.h:609</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a47ebe9f796f264249cc782a0344e8de4"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a47ebe9f796f264249cc782a0344e8de4">proteus::cppHsuSedStress::xt_mIntFluid</a></div><div class="ttdeci">xt::pyarray&lt; double &gt; xt_mIntFluid(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_n, const xt::pyarray&lt; double &gt; &amp;uFluid_np1, double nu, double nuT, const xt::pyarray&lt; double &gt; &amp;gradc)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00711">SedClosure.h:711</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ae771a2f9ff8d1c9dcfdaebad1ef953c2"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ae771a2f9ff8d1c9dcfdaebad1ef953c2">proteus::cppHsuSedStress::aDarcy_</a></div><div class="ttdeci">double aDarcy_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00925">SedClosure.h:925</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_aeafe89f3c5beb814edd8bcc784000f7b"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#aeafe89f3c5beb814edd8bcc784000f7b">proteus::cppHsuSedStress::betaForch_</a></div><div class="ttdeci">double betaForch_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00926">SedClosure.h:926</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_aecad8a41536628999334b49323472e02"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#aecad8a41536628999334b49323472e02">proteus::cppHsuSedStress::mu_fr</a></div><div class="ttdeci">double mu_fr(double sedF, double du_dx, double du_dy, double du_dz, double dv_dx, double dv_dy, double dv_dz, double dw_dx, double dw_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00626">SedClosure.h:626</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a3a41b35384fb306672aefa5be2af3a93"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a3a41b35384fb306672aefa5be2af3a93">proteus::cppHsuSedStress::sigmaC_</a></div><div class="ttdeci">double sigmaC_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00932">SedClosure.h:932</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a70990b3eac11d82c3986246929dc52b8"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a70990b3eac11d82c3986246929dc52b8">proteus::cppHsuSedStress::vos_limiter_</a></div><div class="ttdeci">double vos_limiter_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00943">SedClosure.h:943</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ab8a4618211c3fe135e54f894611faf1a"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ab8a4618211c3fe135e54f894611faf1a">proteus::cppHsuSedStress::xt_mIntSolid</a></div><div class="ttdeci">xt::pyarray&lt; double &gt; xt_mIntSolid(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_np1, double nu, double nuT, const xt::pyarray&lt; double &gt; &amp;gradc)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00753">SedClosure.h:753</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a55f2ef0c3e5e276548ae6e013fb22dcf"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a55f2ef0c3e5e276548ae6e013fb22dcf">proteus::cppHsuSedStress::packFraction_</a></div><div class="ttdeci">double packFraction_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00928">SedClosure.h:928</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a857423e667d913e74074dae40c352dd6"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a857423e667d913e74074dae40c352dd6">proteus::cppHsuSedStress::eR_</a></div><div class="ttdeci">double eR_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00935">SedClosure.h:935</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a13aff994caf29c05dc734f1e39369115"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a13aff994caf29c05dc734f1e39369115">proteus::cppHsuSedStress::mContact_</a></div><div class="ttdeci">double mContact_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00937">SedClosure.h:937</a></div></div>
<div class="ttc" id="anamespaceproteus_html"><div class="ttname"><a href="namespaceproteus.html">proteus</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_d_r_8h_source.html#l00016">ADR.h:17</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ae03aca8f896454e17c794868b48d0582"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ae03aca8f896454e17c794868b48d0582">proteus::cppHsuSedStress::djint2_dtheta</a></div><div class="ttdeci">double djint2_dtheta(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00565">SedClosure.h:565</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_af99c4eedfd1e5e563ffc64068fad5f70"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#af99c4eedfd1e5e563ffc64068fad5f70">proteus::cppHsuSedStress::xt_kappa_sed1</a></div><div class="ttdeci">double xt_kappa_sed1(double sedF, double rhoFluid, double rhoSolid, const xt::pyarray&lt; double &gt; &amp;uFluid, const xt::pyarray&lt; double &gt; &amp;uSolid, const xt::pyarray&lt; double &gt; &amp;gradC, double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n, const xt::pyarray&lt; double &gt; &amp;g)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00202">SedClosure.h:202</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html">proteus::cppHsuSedStress</a></div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00011">SedClosure.h:12</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a2577a0f2359811ac8a9a2f2f303c2cbc"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a2577a0f2359811ac8a9a2f2f303c2cbc">proteus::cppHsuSedStress::k_diff</a></div><div class="ttdeci">double k_diff(double sedF, double rhoSolid, double theta)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00578">SedClosure.h:578</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a3120394f6f4021777b40bbd61e5861ae"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a3120394f6f4021777b40bbd61e5861ae">proteus::cppHsuSedStress::dmInt_duFluid</a></div><div class="ttdeci">double dmInt_duFluid(double sedF, double rhoFluid, const double uFluid_n[nSpace], const double uSolid_n[nSpace], double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00854">SedClosure.h:855</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a65f44247cea053d71c0a6ceecec87de7"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a65f44247cea053d71c0a6ceecec87de7">proteus::cppHsuSedStress::dkappa_sed1_dk</a></div><div class="ttdeci">double dkappa_sed1_dk(double sedF, double rhoFluid, double rhoSolid, const double uFluid[nSpace], const double uSolid[nSpace], const double gradC[nSpace], double nu, double theta_n, double kappa_n, double epsilon_n, double nuT_n)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00296">SedClosure.h:296</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_aeb06426a450fa4c85300c177828b3209"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#aeb06426a450fa4c85300c177828b3209">proteus::cppHsuSedStress::xt_dmInt_duFluid</a></div><div class="ttdeci">double xt_dmInt_duFluid(double sedF, double rhoFluid, const xt::pyarray&lt; double &gt; &amp;uFluid_n, const xt::pyarray&lt; double &gt; &amp;uSolid_n, double nu)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00838">SedClosure.h:839</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a931f52d3e76aeda6f10db10092ff2726"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a931f52d3e76aeda6f10db10092ff2726">proteus::cppHsuSedStress::packMargin_</a></div><div class="ttdeci">double packMargin_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00929">SedClosure.h:929</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_a61260d98f20e684c48a645d75057cf0a"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#a61260d98f20e684c48a645d75057cf0a">proteus::cppHsuSedStress::dpsc_term_dtheta</a></div><div class="ttdeci">double dpsc_term_dtheta(double sedF, double rhoSolid, double du_dx, double dv_dy, double dw_dz)</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00348">SedClosure.h:348</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_adc9e4f2c2aadfa1f8bae00c9413b5b67"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#adc9e4f2c2aadfa1f8bae00c9413b5b67">proteus::cppHsuSedStress::notSoLarge_</a></div><div class="ttdeci">double notSoLarge_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00941">SedClosure.h:941</a></div></div>
<div class="ttc" id="aclassproteus_1_1cpp_hsu_sed_stress_html_ac0a5922204ff6b4996d19507ddae00b6"><div class="ttname"><a href="classproteus_1_1cpp_hsu_sed_stress.html#ac0a5922204ff6b4996d19507ddae00b6">proteus::cppHsuSedStress::large_</a></div><div class="ttdeci">double large_</div><div class="ttdef"><b>Definition:</b> <a href="_sed_closure_8h_source.html#l00942">SedClosure.h:942</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 1 2022 11:17:40 for proteus by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
