<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="d7/d7c/FemTools_8py" kind="file" language="Python">
    <compoundname>FemTools.py</compoundname>
    <innerclass refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement" prot="public">proteus::FemTools::ReferenceElement</innerclass>
    <innerclass refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" prot="public">proteus::FemTools::ReferenceSimplex</innerclass>
    <innerclass refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" prot="public">proteus::FemTools::ReferenceCube</innerclass>
    <innerclass refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" prot="public">proteus::FemTools::LocalFunctionSpace</innerclass>
    <innerclass refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" prot="public">proteus::FemTools::LinearOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" prot="public">proteus::FemTools::LinearOnCubeWithNodalBasis</innerclass>
    <innerclass refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" prot="public">proteus::FemTools::LagrangeOnCubeWithNodalBasis</innerclass>
    <innerclass refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube" prot="public">proteus::FemTools::BernsteinOnCube</innerclass>
    <innerclass refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis" prot="public">proteus::FemTools::QuadraticOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex" prot="public">proteus::FemTools::BernsteinOnSimplex</innerclass>
    <innerclass refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis" prot="public">proteus::FemTools::CrouzeixRaviartWithNodalBasis</innerclass>
    <innerclass refid="d0/db3/classproteus_1_1FemTools_1_1p0" prot="public">proteus::FemTools::p0</innerclass>
    <innerclass refid="d5/d74/classproteus_1_1FemTools_1_1Monomials" prot="public">proteus::FemTools::Monomials</innerclass>
    <innerclass refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis" prot="public">proteus::FemTools::P1BubblesWithNodalBasis</innerclass>
    <innerclass refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis" prot="public">proteus::FemTools::P1P0BubblesWithNodalBasis</innerclass>
    <innerclass refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" prot="public">proteus::FemTools::InterpolationConditions</innerclass>
    <innerclass refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" prot="public">proteus::FemTools::NodalInterpolationConditions</innerclass>
    <innerclass refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions" prot="public">proteus::FemTools::CubeNodalInterpolationConditions</innerclass>
    <innerclass refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" prot="public">proteus::FemTools::QuadraticLagrangeNodalInterpolationConditions</innerclass>
    <innerclass refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" prot="public">proteus::FemTools::QuadraticLagrangeCubeNodalInterpolationConditions</innerclass>
    <innerclass refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions" prot="public">proteus::FemTools::FaceBarycenterInterpolationConditions</innerclass>
    <innerclass refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions" prot="public">proteus::FemTools::p0InterpolationConditions</innerclass>
    <innerclass refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions" prot="public">proteus::FemTools::MonomialInterpolationConditions</innerclass>
    <innerclass refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions" prot="public">proteus::FemTools::P1BubbleInterpolationConditions</innerclass>
    <innerclass refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions" prot="public">proteus::FemTools::P1P0BubbleInterpolationConditions</innerclass>
    <innerclass refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" prot="public">proteus::FemTools::ReferenceFiniteElement</innerclass>
    <innerclass refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" prot="public">proteus::FemTools::DOFMap</innerclass>
    <innerclass refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" prot="public">proteus::FemTools::NodalDOFMap</innerclass>
    <innerclass refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" prot="public">proteus::FemTools::DiscontinuousGalerkinDOFMap</innerclass>
    <innerclass refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap" prot="public">proteus::FemTools::ElementBoundaryDOFMap</innerclass>
    <innerclass refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" prot="public">proteus::FemTools::QuadraticLagrangeCubeDOFMap</innerclass>
    <innerclass refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" prot="public">proteus::FemTools::QuadraticLagrangeDOFMap</innerclass>
    <innerclass refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap" prot="public">proteus::FemTools::p0DOFMap</innerclass>
    <innerclass refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap" prot="public">proteus::FemTools::P1BubbleDOFMap</innerclass>
    <innerclass refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps" prot="public">proteus::FemTools::ElementMaps</innerclass>
    <innerclass refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" prot="public">proteus::FemTools::ParametricMaps</innerclass>
    <innerclass refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" prot="public">proteus::FemTools::AffineMaps</innerclass>
    <innerclass refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" prot="public">proteus::FemTools::ParametricFiniteElementSpace</innerclass>
    <innerclass refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" prot="public">proteus::FemTools::C0_AffineLinearOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="de/d65/classproteus_1_1FemTools_1_1C0__LinearOnCubeWithNodalBasis" prot="public">proteus::FemTools::C0_LinearOnCubeWithNodalBasis</innerclass>
    <innerclass refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis" prot="public">proteus::FemTools::C0_AffineLinearOnCubeWithNodalBasis</innerclass>
    <innerclass refid="dd/dd7/classproteus_1_1FemTools_1_1C0__LagrangeOnCubeWithNodalBasis" prot="public">proteus::FemTools::C0_LagrangeOnCubeWithNodalBasis</innerclass>
    <innerclass refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis" prot="public">proteus::FemTools::C0_AffineLagrangeOnCubeWithNodalBasis</innerclass>
    <innerclass refid="da/d6a/classproteus_1_1FemTools_1_1C0__BernsteinOnCube" prot="public">proteus::FemTools::C0_BernsteinOnCube</innerclass>
    <innerclass refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube" prot="public">proteus::FemTools::C0_AffineBernsteinOnCube</innerclass>
    <innerclass refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffinePolynomialsOnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP0_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="df/dd4/classproteus_1_1FemTools_1_1DG__AffineP1__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP1_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="da/d86/classproteus_1_1FemTools_1_1DG__AffineP2__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP2_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="d2/d78/classproteus_1_1FemTools_1_1DG__AffineP3__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP3_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="de/de8/classproteus_1_1FemTools_1_1DG__AffineP4__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP4_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="d4/d79/classproteus_1_1FemTools_1_1DG__AffineP5__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP5_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="dd/d09/classproteus_1_1FemTools_1_1DG__AffineP6__OnSimplexWithMonomialBasis" prot="public">proteus::FemTools::DG_AffineP6_OnSimplexWithMonomialBasis</innerclass>
    <innerclass refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis" prot="public">proteus::FemTools::DG_AffineLinearOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis" prot="public">proteus::FemTools::C0_AffineQuadraticOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="da/dc1/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnSimplex" prot="public">proteus::FemTools::C0_AffineBernsteinOnSimplex</innerclass>
    <innerclass refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis" prot="public">proteus::FemTools::DG_AffineQuadraticOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis" prot="public">proteus::FemTools::NC_AffineLinearOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants" prot="public">proteus::FemTools::DG_Constants</innerclass>
    <innerclass refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis" prot="public">proteus::FemTools::C0_AffineP1BubbleOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis" prot="public">proteus::FemTools::C0_AffineP1P0BubbleOnSimplexWithNodalBasis</innerclass>
    <innerclass refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" prot="public">proteus::FemTools::FiniteElementFunction</innerclass>
    <innerclass refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions" prot="public">proteus::FemTools::DOFBoundaryConditions</innerclass>
    <innerclass refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt" prot="public">proteus::FemTools::DOFBoundaryConditions_alt</innerclass>
    <innerclass refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions" prot="public">proteus::FemTools::FluxBoundaryConditions</innerclass>
    <innerclass refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries" prot="public">proteus::FemTools::FluxBoundaryConditionsGlobalElementBoundaries</innerclass>
    <innerclass refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions" prot="public">proteus::FemTools::StressBoundaryConditions</innerclass>
    <innerclass refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" prot="public">proteus::FemTools::MultilevelProjectionOperators</innerclass>
    <innernamespace refid="da/dd2/namespaceproteus_1_1FemTools">proteus::FemTools</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="da/dd2/namespaceproteus_1_1FemTools" refkind="compound"><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2"><highlight class="stringliteral">Class<sp/>hierarchies<sp/>for<sp/>constructing<sp/>and<sp/>working<sp/>with<sp/>finite<sp/>element<sp/>spaces</highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral">..<sp/>inheritance-diagram::<sp/>proteus.FemTools</highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral"><sp/><sp/><sp/>:parts:<sp/>1</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_function</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>absolute_import</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>division</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>zip</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>str</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>range</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>past.utils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>old_div</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>object</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.EGeometry<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.MeshTools<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.LinearAlgebraTools<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.Quadrature<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>cfemIntegrals</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>cpartitioning</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.Profiling<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logEvent</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement" kindref="compound">ReferenceElement</ref>(object):</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>base<sp/>class<sp/>for<sp/>simple<sp/>domains<sp/>on<sp/>which</highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>local<sp/>function<sp/>spaces<sp/>will<sp/>be<sp/>built</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a0741e35a193d9525cd9a5af0eeecd822" kindref="member">__init__</ref>(self,dim=0,nNodes=0,nElementBoundaries=0):</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a87ca2da9d2585fbbb1ad54664e3bf098" kindref="member">dim</ref>=dim</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a47845dbc4bcdb42baa50e9cb95c3c5e7" kindref="member">range_dim</ref><sp/>=<sp/>list(range(dim))</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a585e71b7ed17015857e435f6a64d53fd" kindref="member">nNodes</ref><sp/>=<sp/>nNodes</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a69f83efb0cf4adcb5e926f2f1ec4a2a0" kindref="member">range_nNodes</ref><sp/>=<sp/>list(range(nNodes))</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac7ae3370a0da99ad910ce5ce2e343935" kindref="member">nElementBoundaries</ref><sp/>=<sp/>nElementBoundaries</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a5fb03e8a2f19676e3044e3dfda367acc" kindref="member">range_nElementBoundaries</ref><sp/>=<sp/>list(range(nElementBoundaries))</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[]</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>=[]</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>=[]</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>=[]</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>=[]</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a11cf02fcc411561bbf330aeda271489b" kindref="member">onElement</ref>(self,xi):</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement" kindref="compound">ReferenceElement</ref>):</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="47"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>unit<sp/>simplex<sp/>in<sp/>:math:`R^n,<sp/>n&lt;=3`</highlight></codeline>
<codeline lineno="48"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex_1a7bfeedb556a68b47360768d4d725ffe0" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReferenceElement.__init__(self,nd,nd+1,nd+1)</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([0.0]),</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([1.0])]</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#build<sp/>mapping<sp/>from<sp/>reference<sp/>simplex<sp/>of<sp/>lower<sp/>dimension<sp/>to<sp/>the<sp/>boundaries<sp/>of<sp/>the<sp/>simplex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>1D<sp/>the<sp/>0D<sp/>space<sp/>only<sp/>contains<sp/>0<sp/>so<sp/>the<sp/>map<sp/>is<sp/>really<sp/>just<sp/>translation<sp/>of<sp/>0<sp/>to<sp/>the<sp/>endpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#The<sp/>boundaries<sp/>are<sp/>numbered<sp/>according<sp/>to<sp/>the<sp/>node<sp/>opposite<sp/>the<sp/>boundary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0]<sp/>+<sp/>1.0]))</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]<sp/>-<sp/>1.0]))</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0]<sp/>+<sp/>0.0]))</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]]))</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0]))</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([0.0,0.0]),</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([1.0,0.0]),</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([0.0,1.0])]</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([<sp/><sp/><sp/><sp/>xBar[0],</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0-xBar[0]]))</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]]))</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[<sp/>1.0],</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[-1.0]]))</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([old_div(1.0,<ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(2.0)),</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_div(1.0,<ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(2.0))]))</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([0.0,</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[0]]))</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[1]]))</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0],</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1.0]]))</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]]))</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0],</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0]]))</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0]))</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([0.0,</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]),</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([1.0,</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]),</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([0.0,</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]),</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([0.0,</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0])]</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1],</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0-xBar[0]<sp/>-<sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[1],</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0<sp/>,<sp/>0.0],</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0<sp/>,<sp/>1.0],</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[-1.0,-1.0]]))</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([old_div(1.0,<ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(3.0)),</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_div(1.0,<ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(3.0)),</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_div(1.0,<ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(3.0))]))</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([0.0,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1],</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[0]]))</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[2],</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[1],</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0,0.0],</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0],</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1.0,0.0]]))</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[2],</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,0.0],</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,0.0],</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0]]))</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1],</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[1],</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,0.0],</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0],</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,0.0]]))</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0]))</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex_1a8469ead04763532695baef600fb72ebb" kindref="member">onElement</ref>(self,xi):</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(xi<sp/>&gt;=<sp/>0).all()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>(xi)<sp/>&lt;=<sp/>1</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" kindref="compound">ReferenceCube</ref>(<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement" kindref="compound">ReferenceElement</ref>):</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="165"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>unit<sp/>cube<sp/>in<sp/>:math:`R^n,<sp/>n&lt;=3`</highlight></codeline>
<codeline lineno="166"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube_1a139c8f77a0d5bb7f4204b68a031e6b05" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReferenceElement.__init__(self,nd,2**nd,2*nd)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([0.0]),</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([1.0])]</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#build<sp/>mapping<sp/>from<sp/>reference<sp/>simplex<sp/>of<sp/>lower<sp/>dimension<sp/>to<sp/>the<sp/>boundaries<sp/>of<sp/>the<sp/>simplex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>1D<sp/>the<sp/>0D<sp/>space<sp/>only<sp/>contains<sp/>0<sp/>so<sp/>the<sp/>map<sp/>is<sp/>really<sp/>just<sp/>translation<sp/>of<sp/>0<sp/>to<sp/>the<sp/>endpoint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#The<sp/>boundaries<sp/>are<sp/>numbered<sp/>according<sp/>to<sp/>the<sp/>node<sp/>opposite<sp/>the<sp/>boundary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0]<sp/>+<sp/>1.0]))</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]<sp/>-<sp/>1.0]))</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0]<sp/>-<sp/>1.0]))</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]]))</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0]))</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([-1.0,-1.0]),</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,-1.0]),</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,<sp/>1.0]),</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([-1.0,<sp/>1.0])]</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#remember<sp/><sp/>boundary<sp/>reference<sp/>geometry<sp/>is<sp/><sp/>[0,1],<sp/>not<sp/>[-1,1].</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0:<sp/>0-1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],-1.0]))</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0]]))</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[<sp/>1.0],[0.0]]))</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,-1.0]))</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1:<sp/><sp/>1-2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([1.0,xBar[0]]))</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[1]]))</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0],[1.0]]))</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0,0.0]))</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2:<sp/>2-3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([-xBar[0],1.0]))</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([-x[0]]))</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[-1.0],[0.0]]))</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,1.0]))</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3:<sp/>3-0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([-1.0,-xBar[0]]))</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([-x[1]]))</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0],[-1.0]]))</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,0.0]))</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ac3b72211b142a70738e2eb40eadffa87" kindref="member">nodeList</ref>=[numpy.array([-1.0,-1.0,-1.0]),</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,-1.0,-1.0]),</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,<sp/>1.0,-1.0]),</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([-1.0,<sp/>1.0,-1.0]),</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([-1.0,-1.0,<sp/>1.0]),</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,-1.0,<sp/>1.0]),</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([<sp/>1.0,<sp/>1.0,<sp/>1.0]),</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([-1.0,<sp/>1.0,<sp/>1.0])]</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0:<sp/>0-1-2-3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1],</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0]))</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],x[1]]))</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,<sp/>0.0],</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,<sp/>1.0],</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,<sp/>0.0]]))</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,0.0,-1.0]))</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1:<sp/>0-1-5-4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],x[2]]))</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,0.0],</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,0.0],</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0]]))</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,-1.0,0.0]))</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2:<sp/>1-2-6-5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([1.0,</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[0],</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[1],x[2]]))</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0,0.0],</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1.0,0.0],</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0]]))</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0,0.0,0.0]))</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3:<sp/>2-3-7-6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0,</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],x[2]]))</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,0.0],</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,0.0],</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0]]))</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,1.0,0.0]))</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#4:<sp/>3-0-4-7</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([-1.0,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[0],</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1]]))</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[1],x[2]]))</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[0.0,0.0],</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1.0,0.0],</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0]]))</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,0.0,0.0]))</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#5:<sp/>4-5-6-7</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a2ffa1e910990390d019603799b8d388a" kindref="member">boundaryMapList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>numpy.array([xBar[0],</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xBar[1],</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0]))</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a848f27258875e0d00a0486a8a212fd1f" kindref="member">boundaryMapInverseList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>numpy.array([x[0],x[1]]))</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1a7468203eab47c279d278d2e363bad924" kindref="member">boundaryJacobianList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([[1.0,0.0],</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,1.0],</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0.0,0.0]]))</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d6f/classproteus_1_1FemTools_1_1ReferenceElement_1ab59c37fedee36d37b0547b5fb5077915" kindref="member">boundaryUnitNormalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,0.0,1.0]))</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube_1a2bb9d6577ff51ffc158f2abb7814cb17" kindref="member">onElement</ref>(self,xi):</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(xi<sp/>&gt;=<sp/>-1.0).all()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>(xi<sp/>&lt;=<sp/>1.0).all()</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285" refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>(object):</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="287"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Base<sp/>class<sp/>for<sp/>low-dimensional<sp/>spaces<sp/>of<sp/>functions</highlight></codeline>
<codeline lineno="288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>on<sp/>a<sp/>reference<sp/>element.</highlight></codeline>
<codeline lineno="289"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="290"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>example,<sp/>linear<sp/>functions<sp/>on<sp/>a<sp/>reference<sp/>triangle</highlight></codeline>
<codeline lineno="291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ac27bb5062e2e476ffa6648d70b1c33d9" kindref="member">__init__</ref>(self,dim=0,referenceElement=None):</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>=dim</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ae0ed819288739c9fa9858f4cac83ebaf" kindref="member">range_dim</ref><sp/>=<sp/>list(range(dim))</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/>referenceElement</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>following<sp/>are<sp/>lists<sp/>of<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>=[]</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>=[]</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>=[(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>numpy.zeros((self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.dim,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(dim)]</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a41556592cdd609fe301eeacf0298aabf" kindref="member">nonzeroHessians</ref>=</highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>=[]</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>=[]</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1adf96041ee3576eeb7a2018426bb1046a" kindref="member">defineTraceFunctions</ref>(self):</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fi<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>si<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><sp/>range(self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>):</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[fi].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,fiIn=fi,siIn=si:</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[siIn](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[fiIn](xBar)))</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[fi].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,fiIn=fi,siIn=si:</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>[siIn](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[fiIn](xBar)))</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315" refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="317"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>order<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-simplex<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="318"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="319"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Nodal<sp/>basis<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>nd-simplex<sp/><sp/>(nd<sp/>&lt;=<sp/>3)<sp/>with</highlight></codeline>
<codeline lineno="320"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="321"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>nodes.</highlight></codeline>
<codeline lineno="322"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1ab5bd0689452da8857187d9c694f87b13" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,nd+1,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.<sp/>-<sp/>xi[0])</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0]))</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[0])</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:1<sp/>-<sp/>xi[0]<sp/>-<sp/>xi[1])</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,-1.0]))</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[0])</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0,0.0]))</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[1])</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,1.0]))</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:1<sp/>-<sp/>xi[0]<sp/>-<sp/>xi[1]<sp/>-<sp/>xi[2])</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0,</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-1.0]))</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[0])</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0,</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[1])</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>xi[2])</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0]))</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis_1acbf57105e6ab2e51ef76d5324a603a4e" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437" refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="439"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>order<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-cube<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="440"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="441"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Nodal<sp/>basis<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>nd-cube<sp/><sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="442"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="443"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>nodes.</highlight></codeline>
<codeline lineno="444"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a962d269b9526da3c691653de8869e00c" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" kindref="compound">ReferenceCube</ref>(nd)</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,2**nd,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a9d2b40a1e1c19c272868308f3911c7d1" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>0.5*(1.0<sp/>-<sp/>xi[0]))</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a9d2b40a1e1c19c272868308f3911c7d1" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-0.5]))</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a9d2b40a1e1c19c272868308f3911c7d1" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>0.5*(1.0<sp/>+<sp/>xi[0]))</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a9d2b40a1e1c19c272868308f3911c7d1" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.5]))</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis_1a9d2b40a1e1c19c272868308f3911c7d1" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.nodeList:</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>n0=node[0],n1=node[1]:0.25*(1.0+n0*xi[0])*(1.0+n1*xi[1]))</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>n0=node[0],n1=node[1]:<sp/>numpy.array([0.25*<sp/><sp/><sp/><sp/><sp/>n0<sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(1.0+n1*xi[1]),</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.25*(1.0+n0*xi[0])*<sp/><sp/><sp/><sp/><sp/>n1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>]))</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.nodeList:</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.append<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>n0=node[0],n1=node[1],n2=node[2]:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.125*(1.0+n0*xi[0])*(1.0+n1*xi[1])*(1.0+n2*xi[2]))</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>n0=node[0],n1=node[1],n2=node[2]:<sp/>numpy.array([0.125*<sp/><sp/><sp/><sp/><sp/>n0<sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(1.0+n1*xi[1])*(1.0+n2*xi[2]),</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.125*(1.0+n0*xi[0])*<sp/><sp/><sp/><sp/><sp/>n1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(1.0+n2*xi[2]),</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.125*(1.0+n0*xi[0])*(1.0+n1*xi[1])*<sp/><sp/><sp/><sp/><sp/>n2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>]))</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1adf96041ee3576eeb7a2018426bb1046a" kindref="member">defineTraceFunctions</ref>()</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473" refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" kindref="compound">LagrangeOnCubeWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="475"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Lagrange<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-cube<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="476"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="477"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Nodal<sp/>basis<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>nd-cube<sp/><sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="478"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="479"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>nodes.</highlight></codeline>
<codeline lineno="480"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae21574b63ea5822d528a253b87ae9380" kindref="member">__init__</ref>(self,nd=3,<sp/>order=2):</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" kindref="compound">ReferenceCube</ref>(nd)</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,(order+1)**nd,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae1fe17f5635b44e4fcce5b615c86a4d8" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6942bcf9067170a5acd13dfba0aaac11" kindref="member">order</ref><sp/>=<sp/>order</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Generate<sp/>equi<sp/>distance<sp/>nodes<sp/>for<sp/>generation<sp/>of<sp/>lagrange<sp/>basis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Should<sp/>use<sp/>Gauss<sp/>Labatto<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>=[]</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ab2a2c750f9ae66cb62e81c1af4b67916" kindref="member">quadrature</ref><sp/>=<sp/><ref refid="df/d5f/classproteus_1_1Quadrature_1_1LobattoEdgeAlt" kindref="compound">LobattoEdgeAlt</ref>(order=order)</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ab2a2c750f9ae66cb62e81c1af4b67916" kindref="member">quadrature</ref>.points[i][0]<sp/>)</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Define<sp/>1D<sp/>functions<sp/>using<sp/>recursion<sp/>formulas</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>=[]</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>=[]</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fun<sp/><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun2=<sp/>[]</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc=-1</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc2=-1</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>a<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fun<sp/>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>0.0)</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc=fc+1</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>den<sp/><sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>b<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>a!=b:</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun2.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc2=fc2+1</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><sp/>a!=c<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>b!=c:</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun2.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>xb=self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>[c],fc2=fc2:<sp/>dfun2[fc2](xi)*(xi<sp/>-<sp/>xb))</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc2=fc2+1</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dfun.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,fc=fc,fc2=fc2:<sp/>dfun[fc](xi)<sp/>+<sp/>dfun2[fc2](xi))</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fun.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>xb=self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>[b],fc=fc:<sp/><sp/>fun[fc](xi)*(xi<sp/>-<sp/>xb))</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>den<sp/><sp/><sp/>=<sp/>den*(self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>[a]-self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1a6e2718bc74fe1d5a201fd6cc622c51a8" kindref="member">nodes</ref>[b])</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fc=fc+1</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,fc=fc,<sp/>den=den:<sp/><sp/><sp/>old_div(fun[fc](xi),den))</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,fc=fc,<sp/>den=den:<sp/><sp/>old_div(dfun[fc](xi),den))</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Define<sp/>multi-dimensional<sp/>stuff</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis=<sp/>[]</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis<sp/>=<sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients<sp/>=<sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap=[0,2,1]</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j:self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>[i](xi[0])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>[j](xi[1]))</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j:numpy.array([self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>[i](xi[0])*self.<sp/>fun[j](xi[1]),</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>[j](xi[1])]))</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap=[0,7,3,<sp/><sp/>4,8,6,<sp/><sp/><sp/>1,5,2]</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j,k=k:<sp/>self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>[i](xi[0])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>[j](xi[1])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1aaa0335782618db2eafdb2a1eeef4a7aa" kindref="member">fun</ref>[k](xi[2]))</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j,k=k:<sp/>numpy.array([self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>[i](xi[0])*self.<sp/>fun[j](xi[1])*self.<sp/>fun[k](xi[2]),</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>[j](xi[1])*self.<sp/>fun[k](xi[2]),</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<sp/>fun[j](xi[1])*self.<ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis_1ae6968163d4d735fd2c7613ed31b98aeb" kindref="member">dfun</ref>[k](xi[2])]))</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#funMap=numpy.array([0,3,6,8,18,19,24,26])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap<sp/>=<sp/>[<sp/>0,<sp/>8,<sp/>1,</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>11,20,<sp/>9,</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3,10,<sp/>2,</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>12,21,13,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>24,26,22,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>15,23,14,</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4,16,<sp/>5,</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>19,25,17,</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>7,18,<sp/>6]</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Reorder<sp/>local<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invMap=numpy.zeros((self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>):</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invMap[funMap[i]]<sp/>=<sp/>i</highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>):</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(basis[invMap[i]])</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(basisGradients[invMap[i]])</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Get<sp/>boundary<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1adf96041ee3576eeb7a2018426bb1046a" kindref="member">defineTraceFunctions</ref>()</highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573" refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube" kindref="compound">BernsteinOnCube</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="575"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Bernstein<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-cube</highlight></codeline>
<codeline lineno="576"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="577"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Bernstein<sp/>basis<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>nd-cube<sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="578"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/></highlight></codeline>
<codeline lineno="579"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>as<sp/>follows:<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="580"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>##############</highlight></codeline>
<codeline lineno="581"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>#<sp/>***<sp/>2D<sp/>***<sp/>#</highlight></codeline>
<codeline lineno="582"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>##############</highlight></codeline>
<codeline lineno="583"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="584"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>#<sp/>Order=1<sp/>#</highlight></codeline>
<codeline lineno="585"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="586"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3--2</highlight></codeline>
<codeline lineno="587"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="588"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>0--1</highlight></codeline>
<codeline lineno="589"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="590"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>#<sp/>Order=2<sp/>#</highlight></codeline>
<codeline lineno="591"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="592"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3-6-2</highlight></codeline>
<codeline lineno="593"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/>|<sp/>|</highlight></codeline>
<codeline lineno="594"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>7-8-5</highlight></codeline>
<codeline lineno="595"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/>|<sp/>|</highlight></codeline>
<codeline lineno="596"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>0-4-1</highlight></codeline>
<codeline lineno="597"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="598"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>#<sp/>Order=3<sp/>#</highlight></codeline>
<codeline lineno="599"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="600"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3--9--8--2</highlight></codeline>
<codeline lineno="601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="602"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>10-14-15-7</highlight></codeline>
<codeline lineno="603"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="604"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>11-12-13-6</highlight></codeline>
<codeline lineno="605"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="606"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>0--4--5--1</highlight></codeline>
<codeline lineno="607"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="608"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>#<sp/>Order=4<sp/>#</highlight></codeline>
<codeline lineno="609"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>###########</highlight></codeline>
<codeline lineno="610"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3--12-11-10-2</highlight></codeline>
<codeline lineno="611"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="612"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>13-22-23-24-9</highlight></codeline>
<codeline lineno="613"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="614"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>14-19-20-21-8</highlight></codeline>
<codeline lineno="615"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="616"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>15-16-17-18-7</highlight></codeline>
<codeline lineno="617"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|<sp/><sp/>|</highlight></codeline>
<codeline lineno="618"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>0--4--5--6--1</highlight></codeline>
<codeline lineno="619"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="620"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>NOTE<sp/>(mql):<sp/>***<sp/>The<sp/>polynomials<sp/>are<sp/>defined<sp/>for<sp/>arbitrary<sp/>order<sp/>in<sp/>1D.<sp/></highlight></codeline>
<codeline lineno="621"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>definition<sp/>is<sp/>carried<sp/>to<sp/>multi-D<sp/>via<sp/>tensor<sp/>products.<sp/></highlight></codeline>
<codeline lineno="622"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>***<sp/>The<sp/>numbering<sp/>is<sp/>defined<sp/>for<sp/>arbitrary<sp/>order<sp/>(via<sp/>funMap)<sp/>in<sp/>2D.</highlight></codeline>
<codeline lineno="623"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>***<sp/>TODO:<sp/>Generalize<sp/>numbering<sp/>for<sp/>1D<sp/>and<sp/>3D.<sp/></highlight></codeline>
<codeline lineno="624"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>***<sp/>TODO:<sp/>The<sp/>quad<sp/>rule<sp/>Lobatto<sp/>edge<sp/>alt<sp/>must<sp/>be<sp/>generalized.<sp/></highlight></codeline>
<codeline lineno="625"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>***<sp/>TODO:<sp/>define<sp/>hessians<sp/>and<sp/>higher<sp/>order<sp/>deriavtives<sp/></highlight></codeline>
<codeline lineno="626"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>math<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>factorial<sp/></highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a2ce5b4f5d9809feb10388acb8db0cf10" kindref="member">nChooseK</ref>(self,n,k):</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>factorial(n)/factorial(k)/factorial(n-k)</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1adce5a3fe9bcb820dd730d86ee034a1ef" kindref="member">__init__</ref>(self,nd=3,<sp/>order=2):</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="d8/d5b/classproteus_1_1FemTools_1_1ReferenceCube" kindref="compound">ReferenceCube</ref>(nd)</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,(order+1)**nd,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a68a7aefedf79817b8d299004d96779c2" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a94eebe15d13ab6561a920d1b6eab949e" kindref="member">order</ref><sp/>=<sp/>order</highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Generate<sp/>equi<sp/>distance<sp/>nodes<sp/>for<sp/>generation<sp/>of<sp/>basis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Should<sp/>use<sp/>Gauss<sp/>Labatto<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1abc8f8eab8ab64702839e72536b51e66b" kindref="member">nodes</ref>=[]</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1aabc88614e00b0b1ec052b3f93b901a64" kindref="member">quadrature</ref><sp/>=<sp/><ref refid="df/d5f/classproteus_1_1Quadrature_1_1LobattoEdgeAlt" kindref="compound">LobattoEdgeAlt</ref>(order=order)</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1abc8f8eab8ab64702839e72536b51e66b" kindref="member">nodes</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1aabc88614e00b0b1ec052b3f93b901a64" kindref="member">quadrature</ref>.points[i][0])</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Define<sp/>1D<sp/>functions<sp/>using<sp/>definition<sp/>via<sp/>binomial<sp/>coefficients</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>=[]</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>=[]</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.dfun2=[]<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x,n=order,k=k:</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a2ce5b4f5d9809feb10388acb8db0cf10" kindref="member">nChooseK</ref>(n,k)*(old_div((x+1),2.))**k*(old_div((1-x),2.))**(n-k))</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x,n=order,k=k:</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#-2.**(-n)*(1-x)**(-1-k+n)*(1+x)**(k-1)*(-2*k+n+n*x)*self.nChooseK(n,k))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Rule<sp/>out<sp/>the<sp/>cases<sp/>when<sp/>1-x<sp/>or<sp/>1+x<sp/>=<sp/>0.<sp/>This<sp/>is<sp/>to<sp/>avoid<sp/>warnings<sp/>due<sp/>to<sp/>division<sp/>by<sp/>zero</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>1-x<sp/>==<sp/>0.<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>1+x<sp/>==<sp/>0.<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>-2.**(-n)*(1-x)**(-1-k+n)*(1+x)**(k-1)*(-2*k+n+n*x)*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a2ce5b4f5d9809feb10388acb8db0cf10" kindref="member">nChooseK</ref>(n,k))</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.dfun2.append(lambda<sp/>x,n=order,k=k:<sp/>...)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Define<sp/>multi-dimensional<sp/>stuff</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis=<sp/>[]</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis<sp/>=<sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients<sp/>=<sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap=[0,2,1]</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Define<sp/>the<sp/>basis<sp/>and<sp/>its<sp/>gradient<sp/>via<sp/>tensor<sp/>products</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j:self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>[i](xi[0])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>[j](xi[1]))</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j:</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>[i](xi[0])*self.<sp/>fun[j](xi[1]),</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>[j](xi[1])]))</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Define<sp/>numbering<sp/>for<sp/>arbitrary<sp/>order<sp/>(see<sp/>above)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap=np.zeros((order+1)**2,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#auxiliary<sp/>vector<sp/>to<sp/>construct<sp/>ith<sp/>column<sp/>of<sp/>funMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec=np.zeros(order+1)</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>COMPUTE<sp/>BOTTOM<sp/>AND<sp/>UPPER<sp/>ROW<sp/>OF<sp/>funMap<sp/>#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i==0):<sp/></highlight><highlight class="comment">#left<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[0]=0</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[order]=3</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>(i==order):<sp/></highlight><highlight class="comment">#right<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[0]=1</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[order]=2</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#middle<sp/>columns<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[0]=nd+1+i<sp/></highlight><highlight class="comment">#bottom<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[order]=nd+2*order+(order-1)-i<sp/></highlight><highlight class="comment">#upper<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>COMPUTE<sp/>MIDDLE<sp/>ROWS<sp/>OF<sp/>funMap<sp/>#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1,order):</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i==0):<sp/></highlight><highlight class="comment">#left<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[order-k]<sp/>=<sp/>nd+3*order-2+k</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>(i==order):<sp/></highlight><highlight class="comment">#right<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[k]<sp/>=<sp/>nd+order+k</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#middle<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec[k]<sp/>=<sp/>(2*nd)*(order-1)+2*nd-1+i+(k-1)*(order-1)</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>vec</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap[i*(order+1):(i+1)*(order+1)]=vec[:]</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>funMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(order+1):</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j,k=k:</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>[i](xi[0])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>[j](xi[1])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a3e28633e67633dd25e105aa78eadad2c" kindref="member">fun</ref>[k](xi[2]))</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,i=i,j=j,k=k:</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>[i](xi[0])*self.<sp/>fun[j](xi[1])*self.<sp/>fun[k](xi[2]),</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>[j](xi[1])*self.<sp/>fun[k](xi[2]),</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<sp/>fun[i](xi[0])*self.<sp/>fun[j](xi[1])*self.<ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube_1a33d3c648d7d3c57960c271ebdde05c05" kindref="member">dfun</ref>[k](xi[2])]))</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funMap<sp/>=<sp/>[<sp/>0,<sp/>8,<sp/>1,</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>11,20,<sp/>9,</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3,10,<sp/>2,</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>12,21,13,</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>24,26,22,</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>15,23,14,</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4,16,<sp/>5,</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>19,25,17,</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>7,18,<sp/>6]</highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Reorder<sp/>local<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invMap=numpy.zeros((self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>):</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invMap[funMap[i]]<sp/>=<sp/>i</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a9a0c22553fef7255f58e70a3b3c489cd" kindref="member">dim</ref>):</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(basis[invMap[i]])</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(basisGradients[invMap[i]])</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Get<sp/>boundary<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1adf96041ee3576eeb7a2018426bb1046a" kindref="member">defineTraceFunctions</ref>()</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="732" refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis" kindref="compound">QuadraticOnSimplexWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="734"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Quadratic<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-simplex<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="735"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="736"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Nodal<sp/>basis<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>nd-simplex<sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="737"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are</highlight></codeline>
<codeline lineno="738"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="739"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="740"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="741"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="742"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi<sp/>&amp;=<sp/>\lambda_i(2\lambda_i-1)<sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>d</highlight></codeline>
<codeline lineno="743"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi<sp/>&amp;=<sp/>4\lambda_j\lambda_k<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0&lt;=<sp/>j<sp/>&lt;<sp/>k<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="744"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="745"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>where<sp/>:math:`\lambda_i`<sp/>is<sp/>the<sp/>barycentric<sp/>coordinate<sp/>associated</highlight></codeline>
<codeline lineno="746"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>node<sp/>i<sp/>(i.e.,<sp/>it&apos;s<sp/>1<sp/>at<sp/>node<sp/>i<sp/>and<sp/>zero<sp/>elsewhere)</highlight></codeline>
<codeline lineno="747"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="748"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Gradients<sp/>of<sp/>shape<sp/>functions<sp/>are</highlight></codeline>
<codeline lineno="749"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="750"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="751"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="752"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>\nabla<sp/>\psi_i<sp/>&amp;=<sp/>(4\lambda_i-1)\nabla\lambda_i<sp/><sp/><sp/>0&lt;=<sp/>i<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="753"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>\nabla<sp/>\psi_i<sp/>&amp;=<sp/>4\lambda_k\nabla\lambda_j<sp/>+<sp/>4\lambda_j\nabla\lambda_k<sp/>\mbox{for}<sp/>0<sp/>&lt;=<sp/>j<sp/>&lt;<sp/>k<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="754"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="755"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>In<sp/>2d<sp/>we<sp/>have</highlight></codeline>
<codeline lineno="756"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="757"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="758"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="759"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_i<sp/>&amp;=<sp/>\lambda_i(2\lambda_i-1)<sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>2</highlight></codeline>
<codeline lineno="760"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_3<sp/>&amp;=<sp/>4\lambda_0\lambda_1</highlight></codeline>
<codeline lineno="761"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_4<sp/>&amp;=<sp/>4\lambda_1\lambda_2</highlight></codeline>
<codeline lineno="762"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_5<sp/>&amp;=<sp/>4\lambda_0\lambda_2</highlight></codeline>
<codeline lineno="763"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="764"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="765"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>2d<sp/>numberings<sp/>for<sp/>:math:`\psi`</highlight></codeline>
<codeline lineno="766"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="767"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="768"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|\</highlight></codeline>
<codeline lineno="769"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>\</highlight></codeline>
<codeline lineno="770"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/>\</highlight></codeline>
<codeline lineno="771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>5<sp/><sp/><sp/>4</highlight></codeline>
<codeline lineno="772"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/>\</highlight></codeline>
<codeline lineno="773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>\</highlight></codeline>
<codeline lineno="774"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>0---3--1</highlight></codeline>
<codeline lineno="775"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="776"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>mesh<sp/>numbers<sp/>edges<sp/>according<sp/>to<sp/>the<sp/>node<sp/>they<sp/>are<sp/>across</highlight></codeline>
<codeline lineno="777"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>from,<sp/>so<sp/>that<sp/>local<sp/>dof<sp/>3<sp/>corresponds<sp/>to<sp/>edge<sp/>2,<sp/>local<sp/>dof<sp/>4</highlight></codeline>
<codeline lineno="778"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>corresponds<sp/>to<sp/>edge<sp/>0,<sp/>local<sp/>dof<sp/>5<sp/>corresponds<sp/>to<sp/>edge<sp/>1,</highlight></codeline>
<codeline lineno="779"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="780"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3d<sp/>should<sp/>be</highlight></codeline>
<codeline lineno="781"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="782"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="783"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="784"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_i<sp/>&amp;=<sp/>\lambda_i(2\lambda_i-1)<sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>3</highlight></codeline>
<codeline lineno="785"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_4<sp/>&amp;=<sp/>4\lambda_0\lambda_1</highlight></codeline>
<codeline lineno="786"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_5<sp/>&amp;=<sp/>4\lambda_1\lambda_2</highlight></codeline>
<codeline lineno="787"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_6<sp/>&amp;=<sp/>4\lambda_2\lambda_3</highlight></codeline>
<codeline lineno="788"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_7<sp/>&amp;=<sp/>4\lambda_0\lambda_2</highlight></codeline>
<codeline lineno="789"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_8<sp/>&amp;=<sp/>4\lambda_1\lambda_3</highlight></codeline>
<codeline lineno="790"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_9<sp/>&amp;=<sp/>4\lambda_0\lambda_3</highlight></codeline>
<codeline lineno="791"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a3ae124a2e5cdad3c029f4814f4ec233b" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryCoords</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fact</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryGrads</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>p2refNodes</highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,old_div(<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(nd+2),(2*<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(nd))),</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>=[]</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a41556592cdd609fe301eeacf0298aabf" kindref="member">nonzeroHessians</ref>=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi)*(2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi)-1.0))</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi)-1.0)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi))</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0]+</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[2](xi))</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])+</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0])))</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)*(2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)-1.0))</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)-1.0)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="854"><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>on<sp/>0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar=nd+1</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#increment<sp/>size<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r=1</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(2):<sp/></highlight><highlight class="comment">#(0,1)<sp/>and<sp/>(1,2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>r=r:</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r](xi))</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]+</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])</highlight></codeline>
<codeline lineno="881"><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](xi))</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="893"><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>increment<sp/>size<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>2</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#increment<sp/>size<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r=2</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1):<sp/></highlight><highlight class="comment">#(0,2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r](xi))</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]+</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])</highlight></codeline>
<codeline lineno="910"><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](xi))</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[i+nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="922"><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>increment<sp/>size<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar+=1</highlight></codeline>
<codeline lineno="925"><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>TODO<sp/>check<sp/>hessian<sp/>formulas!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar=0</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*(2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)-1.0))</highlight></codeline>
<codeline lineno="932"><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)-1.0)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="943"><highlight class="normal"></highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#no<sp/>go<sp/>through<sp/>increments<sp/>of<sp/>size<sp/>1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#number<sp/>of<sp/>combos<sp/>per<sp/>increment<sp/>are<sp/>dim-incr+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>r<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1,nd+1):<sp/></highlight><highlight class="comment">#1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd-r+1):</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>r=r:</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r](xi))</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>r=r:</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]+</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r])</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis_1a513c9f441b6307dd1c9879febe7cf17b" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>j<sp/>in<sp/>range(1,nd+1):<sp/>#1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>i<sp/>in<sp/>range(j):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis.append(lambda<sp/>xi,<sp/>i=i,<sp/>j=j:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[&apos;3d&apos;][i](xi)*baryCoords[&apos;3d&apos;][j](xi))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisTrace[0].append(lambda<sp/>xBar,<sp/>nsofar=nsofar:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis[nsofar](self.referenceElement.boundaryMapList[0](xBar)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisTrace[1].append(lambda<sp/>xBar,<sp/>nsofar=nsofar:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis[nsofar](self.referenceElement.boundaryMapList[1](xBar)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisTrace[2].append(lambda<sp/>xBar,<sp/>nsofar=nsofar:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis[nsofar](self.referenceElement.boundaryMapList[2](xBar)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="994"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisTrace[3].append(lambda<sp/>xBar,<sp/>nsofar=nsofar:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis[nsofar](self.referenceElement.boundaryMapList[3](xBar)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList.append(lambda<sp/>xi,<sp/>i=i,<sp/>j=j:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="997"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[&apos;3d&apos;][j](xi)*baryGrads[&apos;3d&apos;][i]+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[&apos;3d&apos;][i](xi)*baryGrads[&apos;3d&apos;][j])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="999"><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(lambda<sp/>xi,<sp/>nsofar=nsofar:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1001"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList[nsofar](xi))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ib<sp/>in<sp/>range(nd+1):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradientsTrace[ib].append(lambda<sp/>xBar,<sp/>nsofar=nsofar,<sp/>ib=ib:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList[nsofar](self.referenceElement.boundaryMapList[ib](xBar)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisHessians.append(lambda<sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>j=j:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[&apos;3d&apos;][i],baryGrads[&apos;3d&apos;][j])+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[&apos;3d&apos;][j],baryGrads[&apos;3d&apos;][i]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>r</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>QuadraticOnSimplex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"></highlight></codeline>
<codeline lineno="1016" refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex" kindref="compound">BernsteinOnSimplex</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1018"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Quadratic<sp/>Bernstein<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-simplex.</highlight></codeline>
<codeline lineno="1019"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1020"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="1021"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1022"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1023"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1024"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi<sp/>&amp;=<sp/>\lambda_i^2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>d</highlight></codeline>
<codeline lineno="1025"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi<sp/>&amp;=<sp/>2\lambda_j\lambda_k<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0&lt;=<sp/>j<sp/>&lt;<sp/>k<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="1026"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1027"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>where<sp/>:math:`\lambda_i`<sp/>is<sp/>the<sp/>barycentric<sp/>coordinate<sp/>associated</highlight></codeline>
<codeline lineno="1028"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>node<sp/>i<sp/>(i.e.,<sp/>it&apos;s<sp/>1<sp/>at<sp/>node<sp/>i<sp/>and<sp/>zero<sp/>elsewhere).<sp/></highlight></codeline>
<codeline lineno="1029"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>These<sp/>can<sp/>be<sp/>generalized<sp/>to:</highlight></codeline>
<codeline lineno="1030"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1031"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi<sp/>&amp;=<sp/>p!/(i!j!k!)\lambda_0^i\lambda_1^j\lambda_2^k,<sp/>0&lt;=i,j,k&lt;=order,<sp/>i+j+k=order</highlight></codeline>
<codeline lineno="1032"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1033"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Gradients<sp/>of<sp/>shape<sp/>functions<sp/>are</highlight></codeline>
<codeline lineno="1034"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1035"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1036"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1037"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>\nabla<sp/>\psi_i<sp/>&amp;=<sp/>2\lambda_i\nabla\lambda_i<sp/><sp/><sp/>0&lt;=<sp/>i<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="1038"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>\nabla<sp/>\psi_i<sp/>&amp;=<sp/>2\lambda_k\nabla\lambda_j<sp/>+<sp/>2\lambda_j\nabla\lambda_k<sp/>\mbox{for}<sp/>0<sp/>&lt;=<sp/>j<sp/>&lt;<sp/>k<sp/>&lt;=<sp/>d</highlight></codeline>
<codeline lineno="1039"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1040"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>which<sp/>again<sp/>can<sp/>be<sp/>generalized<sp/>via<sp/>the<sp/>general<sp/>formula<sp/>above.</highlight></codeline>
<codeline lineno="1041"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1042"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>In<sp/>2d<sp/>we<sp/>have</highlight></codeline>
<codeline lineno="1043"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1044"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1045"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1046"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_i<sp/>&amp;=<sp/>\lambda_i^2<sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>2</highlight></codeline>
<codeline lineno="1047"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_3<sp/>&amp;=<sp/>2\lambda_0\lambda_1</highlight></codeline>
<codeline lineno="1048"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_4<sp/>&amp;=<sp/>2\lambda_1\lambda_2</highlight></codeline>
<codeline lineno="1049"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_5<sp/>&amp;=<sp/>2\lambda_0\lambda_2</highlight></codeline>
<codeline lineno="1050"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1051"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>2d<sp/>numberings<sp/>for<sp/>:math:`\psi`</highlight></codeline>
<codeline lineno="1052"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1053"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="1054"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|\</highlight></codeline>
<codeline lineno="1055"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>\</highlight></codeline>
<codeline lineno="1056"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/>\</highlight></codeline>
<codeline lineno="1057"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>5<sp/><sp/><sp/>4</highlight></codeline>
<codeline lineno="1058"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/>\</highlight></codeline>
<codeline lineno="1059"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>\</highlight></codeline>
<codeline lineno="1060"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>0---3--1</highlight></codeline>
<codeline lineno="1061"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1062"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>mesh<sp/>numbers<sp/>edges<sp/>according<sp/>to<sp/>the<sp/>node<sp/>they<sp/>are<sp/>across</highlight></codeline>
<codeline lineno="1063"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>from,<sp/>so<sp/>that<sp/>local<sp/>dof<sp/>3<sp/>corresponds<sp/>to<sp/>edge<sp/>2,<sp/>local<sp/>dof<sp/>4</highlight></codeline>
<codeline lineno="1064"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>corresponds<sp/>to<sp/>edge<sp/>0,<sp/>local<sp/>dof<sp/>5<sp/>corresponds<sp/>to<sp/>edge<sp/>1,</highlight></codeline>
<codeline lineno="1065"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1066"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3d<sp/>should<sp/>be</highlight></codeline>
<codeline lineno="1067"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1068"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1069"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1070"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_i<sp/>&amp;=<sp/>\lambda_i^2<sp/><sp/>0&lt;=<sp/>i&lt;=<sp/>3</highlight></codeline>
<codeline lineno="1071"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_4<sp/>&amp;=<sp/>2\lambda_0\lambda_1</highlight></codeline>
<codeline lineno="1072"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_5<sp/>&amp;=<sp/>2\lambda_1\lambda_2</highlight></codeline>
<codeline lineno="1073"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_6<sp/>&amp;=<sp/>2\lambda_2\lambda_3</highlight></codeline>
<codeline lineno="1074"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_7<sp/>&amp;=<sp/>2\lambda_0\lambda_2</highlight></codeline>
<codeline lineno="1075"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_8<sp/>&amp;=<sp/>2\lambda_1\lambda_3</highlight></codeline>
<codeline lineno="1076"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>\psi_9<sp/>&amp;=<sp/>2\lambda_0\lambda_3</highlight></codeline>
<codeline lineno="1077"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a4e43a703b5b3c4981ab28ebc5ab43a18" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryCoords</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fact</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryGrads</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>p2refNodes</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"></highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,old_div(<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(nd+2),(2*<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(nd))),</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>=[]</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a41556592cdd609fe301eeacf0298aabf" kindref="member">nonzeroHessians</ref>=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi)**2.0)</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi))</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0]+</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[2](xi))</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])+</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0])))</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#NOTE<sp/>(mql):<sp/>the<sp/>formulas<sp/>for<sp/>the<sp/>basis<sp/>functions<sp/>and<sp/>its<sp/>first<sp/>derivatives<sp/>are<sp/>grl</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>with<sp/>respect<sp/>to<sp/>the<sp/>polynomial<sp/>order.<sp/>The<sp/>Hessian<sp/>is<sp/>computed<sp/>assuming<sp/>order=2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ijk<sp/>=<sp/>np.array([[2,0,0],<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0,2,0],</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0,0,2],</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1,1,0],</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0,1,1],</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[1,0,1]])<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(ijk)):</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>math.factorial(2)/math.factorial(ijk[i][0])/math.factorial(ijk[i][1])/math.factorial(ijk[i][2])*</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(1.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ijk[i][0]==0<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)**ijk[i][0])*</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(1.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ijk[i][1]==0<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)**ijk[i][1])*</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(1.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ijk[i][2]==0<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)**ijk[i][2]))</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>math.factorial(2)/math.factorial(ijk[i][0])/math.factorial(ijk[i][1])/math.factorial(ijk[i][2])*</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)**ijk[i][0]*</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)**ijk[i][1]*</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)<sp/>==<sp/>0.<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>ijk[i][2]*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)**(ijk[i][2]-1))</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2]+</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)**ijk[i][0]*</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)<sp/>==<sp/>0.<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>ijk[i][1]*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)**(ijk[i][1]-1))*</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)**ijk[i][2]</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1]+</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0.<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)<sp/>==<sp/>0.<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>ijk[i][0]*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)**(ijk[i][0]-1))*</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)**ijk[i][1]*</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)**ijk[i][2]</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0]))</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>COMPUTE<sp/>HESSIANS.<sp/>These<sp/>formulas<sp/>assume<sp/>that<sp/>order=2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,<sp/>1,<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r=1</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar=nd+1</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(2):<sp/></highlight><highlight class="comment">#(0,1)<sp/>and<sp/>(1,2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar+=2</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r=2</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1):<sp/></highlight><highlight class="comment">#(0,2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NOTE<sp/>(mql):<sp/>the<sp/>formulas<sp/>are<sp/>not<sp/>general;<sp/>i.e.,<sp/>I<sp/>assume<sp/>order=2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar=0</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)**2.0)</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#no<sp/>go<sp/>through<sp/>increments<sp/>of<sp/>size<sp/>1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#number<sp/>of<sp/>combos<sp/>per<sp/>increment<sp/>are<sp/>dim-incr+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>r<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1,nd+1):<sp/></highlight><highlight class="comment">#1,2,3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd-r+1):</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>r=r:</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r](xi))</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>r=r:</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]+</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r])</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>nsofar=nsofar:</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>nsofar=nsofar,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex_1a392cdaaaa045247ab0eb0525401d4a83" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i,<sp/>nsofar=nsofar,<sp/>r=r:</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r])+</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i+r],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i]))</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"></highlight></codeline>
<codeline lineno="1245"><highlight class="normal"></highlight><highlight class="comment">#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1246"><highlight class="normal"></highlight><highlight class="comment">#finite<sp/>element<sp/>spaces<sp/>for<sp/>P^1<sp/>non-conforming<sp/>approximation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1247"><highlight class="normal"></highlight><highlight class="comment">#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#<sp/>#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1248"><highlight class="normal"></highlight></codeline>
<codeline lineno="1249" refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis" kindref="compound">CrouzeixRaviartWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1251"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Crouzeix-Raviart<sp/>element<sp/>implemented<sp/>as<sp/>a<sp/>Lagrange<sp/>type<sp/>element.<sp/>That<sp/>is,<sp/>the</highlight></codeline>
<codeline lineno="1252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>degrees<sp/>of<sp/>freedom<sp/>are<sp/>the<sp/>values<sp/>at<sp/>barycenters<sp/>of<sp/>faces.<sp/>Defined<sp/>for</highlight></codeline>
<codeline lineno="1253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>reference<sp/>nd-simplex<sp/><sp/>(nd<sp/>&lt;=3)</highlight></codeline>
<codeline lineno="1254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal"></highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>In<sp/>1d,<sp/>it&apos;s<sp/>identical<sp/>to<sp/>the<sp/>standard<sp/>P^1<sp/>Lagrange<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1257"><highlight class="normal"></highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to<sp/>the<sp/>faces,<sp/>which<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>in<sp/>turn<sp/>numbered<sp/>according<sp/>to<sp/>the<sp/>node<sp/>that<sp/>they<sp/>are<sp/>opposite.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>:math:`\lambda_i`<sp/>is<sp/>the<sp/>barycentric<sp/>coordinate<sp/>that&apos;s<sp/>1<sp/>at<sp/>node<sp/>p_i,<sp/>then</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>CrR<sp/>shape<sp/>functions<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>\psi_i(<sp/>x)<sp/>=<sp/>d(1/d<sp/>-<sp/>\lambda_i)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>and<sp/>is<sp/>one<sp/>along<sp/>:math:`E_i`,<sp/>the<sp/>face<sp/>opposite<sp/>:math:`p_i`.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>These<sp/>relationships<sp/>hold<sp/>in<sp/>physical<sp/>space<sp/>or<sp/>reference<sp/>space<sp/>as<sp/>long<sp/>as<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>barycentric<sp/>coordinates<sp/>are<sp/>defined<sp/>appropriately.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"></highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>In<sp/>physical<sp/>space,<sp/>the<sp/>barycentric<sp/>coordinates<sp/>are<sp/>defined<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>\lambda_i<sp/>=<sp/>1<sp/>-<sp/>\frac{(<sp/>x<sp/>-<sp/><sp/>p_i)\cdot<sp/><sp/>n_i}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{(<sp/>p_j<sp/>-<sp/><sp/>p_i)\cdot<sp/><sp/>n_i}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1279"><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>for<sp/>:math:`j<sp/>\neq<sp/>i,<sp/><sp/>p_j`<sp/>is<sp/>a<sp/>vertex<sp/>in<sp/>:math:`E_i`</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1281"><highlight class="normal"></highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/>t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>On<sp/>the<sp/>reference<sp/>element,<sp/>in<sp/>2d<sp/>we<sp/>have<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u|<sp/>/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|/___</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1286"><highlight class="normal"></highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>\lambda_0<sp/>=<sp/>1-s-t,<sp/>\lambda_1<sp/>=<sp/>s,<sp/>\lambda_2<sp/>=<sp/>t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1288"><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>For<sp/>3d<sp/>the<sp/>reference<sp/>coordinates<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1290"><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal"></highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>\lambda_0<sp/>=<sp/>1-s-t-u,<sp/>\lambda_1<sp/>=<sp/>s,<sp/>\lambda_2<sp/>=<sp/>t,<sp/>\lambda_3<sp/>=<sp/>u</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"></highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>In<sp/>2d,<sp/>the<sp/>CrR<sp/>shape<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>element<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1297"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1299"><highlight class="normal"></highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>\hat{\psi}_0<sp/>=<sp/><sp/>2(s+t)-1,<sp/>\hat{\psi}_1<sp/>=<sp/>1-2s,<sp/>\hat{\psi}_2<sp/>=<sp/>1-2t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="normal"></highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>In<sp/>3d,<sp/>the<sp/>CrR<sp/>shape<sp/>functions<sp/>on<sp/>the<sp/>reference<sp/>element<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1303"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>\hat{\psi}_0<sp/>=<sp/><sp/>3(s+t+u)-2,<sp/>\hat{\psi}_1<sp/>=<sp/>1-3s,<sp/>\hat{\psi}_2<sp/>=<sp/>1-3t,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>\hat{\psi}_3<sp/>=<sp/>1-3u</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>gradients<sp/>are<sp/>obviously<sp/>constant<sp/>on<sp/>an<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a8eff48449ac1da9ab4833ea49099c6f3" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,nd+1,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#note<sp/>these<sp/>are<sp/>the<sp/>reverse<sp/>ordering<sp/>for<sp/>standard<sp/>C0<sp/>basis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:xi[0])</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([1.0]))</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:1<sp/>-<sp/>xi[0])</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-1.0]))</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:2.*(xi[0]<sp/>+<sp/>xi[1])-1.)</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([2.0,2.0]))</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0-2.0*xi[0])</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-2.0,0.0]))</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0-2*xi[1])</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([0.0,-2.0]))</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:3.0*(xi[0]<sp/>+<sp/>xi[1]<sp/>+<sp/>xi[2])-2.0)</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[0](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([3.0,</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3.0,</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3.0]))</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[0])</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0-3.0*xi[0])</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[1](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([-3.0,</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[1])</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0-3.0*xi[1])</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([<sp/>0.0,</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-3.0,</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0]))</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[2])</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:1.0-3.0*xi[2])</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[3](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(numpy.array([<sp/>0.0,</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.0,</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-3.0]))</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:<sp/>self.<ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis_1a98969fe4fe85cf3463e6e50271d43d19" kindref="member">gradientList</ref>[3])</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"></highlight></codeline>
<codeline lineno="1424" refid="d0/db3/classproteus_1_1FemTools_1_1p0" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d0/db3/classproteus_1_1FemTools_1_1p0" kindref="compound">p0</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d0/db3/classproteus_1_1FemTools_1_1p0_1a83edc97ac3504d9069b49623458eee6f" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,1,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,nd=nd:<sp/>numpy.zeros((nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"></highlight></codeline>
<codeline lineno="1431" refid="d5/d74/classproteus_1_1FemTools_1_1Monomials" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d5/d74/classproteus_1_1FemTools_1_1Monomials" kindref="compound">Monomials</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/d74/classproteus_1_1FemTools_1_1Monomials_1ae7e415210ebe0bc618b3dd349a444050" kindref="member">__init__</ref>(self,nd=3,k=0):</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/d74/classproteus_1_1FemTools_1_1Monomials_1a04c6ae27316fd86316322c881fcefab1" kindref="member">kOrder</ref><sp/>=<sp/>k</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis=[]</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients=[]</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>a<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1+k):</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alpha<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(0.0,a-1.0)</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>b<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1+k-a):</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beta<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(0.0,b-1.0)</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1+k-a-b):</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gamma<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(0.0,c-1.0)</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a,b=b,c=c:<sp/>xi[0]**a<sp/>*<sp/>xi[1]**b<sp/>*<sp/>xi[2]**c)</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a,b=b,c=c,alpha=alpha,beta=beta,gamma=gamma:</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([a*xi[0]**alpha*<sp/>xi[1]**b<sp/>*<sp/>xi[2]**c,</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi[0]**a<sp/>*<sp/>b*xi[1]**beta<sp/>*<sp/>xi[2]**c,</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi[0]**a<sp/>*<sp/>xi[1]**b<sp/>*<sp/>c*xi[2]**gamma]))</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a,b=b:<sp/>xi[0]**a<sp/>*<sp/>xi[1]**b)</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a,b=b,alpha=alpha,beta=beta:</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.array([a*xi[0]**alpha*<sp/>xi[1]**b,</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi[0]**a<sp/>*<sp/>b*xi[1]**beta]))</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basis.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a:<sp/>xi[0]**a)</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisGradients.append(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,a=a,alpha=alpha:<sp/>numpy.array([a*xi[0]**alpha]))</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,len(basis),self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>=basis</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>=basisGradients</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"></highlight></codeline>
<codeline lineno="1462"><highlight class="normal"></highlight></codeline>
<codeline lineno="1463" refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis" kindref="compound">P1BubblesWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1465"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>order<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-simplex<sp/>with<sp/>the<sp/>nodal<sp/>basis<sp/>+<sp/>bubble</highlight></codeline>
<codeline lineno="1466"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1467"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1468"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1469"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>b<sp/>=<sp/>(n_d+1)^{n_d+1}<sp/>\Pi_{i=0}^{n_d}<sp/>\lambda_i</highlight></codeline>
<codeline lineno="1470"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1471"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>nd+1<sp/>basis<sp/>functions<sp/>are<sp/>nodal<sp/>ones<sp/>on<sp/>the<sp/>reference<sp/>nd-simplex<sp/><sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="1472"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="1473"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>nodes.<sp/>The<sp/>last<sp/>shape<sp/>function<sp/>is<sp/>the<sp/>bubble,<sp/>b</highlight></codeline>
<codeline lineno="1474"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a411765b6353e9581b23f747edb7d7950" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryCoords</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryGrads</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,nd+2,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi))</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0]+</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[2](xi))</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1])+</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][0])))</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"></highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"></highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>on<sp/>0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>9.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi))</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0]+</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1]+</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2])</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"></highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)+</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi)+</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1](xi)+</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>9.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][2],baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][1])*baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][0](xi))</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>TODO<sp/>check<sp/>hessian<sp/>formulas!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi))</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0]+</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1]+</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2]+</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3])</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis_1a53322b06b1aebd4d0276d638a968bc57" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3](xi)+</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)+</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2](xi)+</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>256.0*numpy.outer(baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][3],baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][2])*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][0](xi)*baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][1](xi))</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"></highlight></codeline>
<codeline lineno="1634" refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis" kindref="compound">P1P0BubblesWithNodalBasis</ref>(<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace" kindref="compound">LocalFunctionSpace</ref>):</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1636"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>order<sp/>polynomials<sp/>on<sp/>the<sp/>unit<sp/>nd-simplex<sp/>with<sp/>the<sp/>nodal<sp/>basis<sp/>+<sp/>dg<sp/>bubble</highlight></codeline>
<codeline lineno="1637"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1638"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="1639"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1640"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>b_e<sp/>=<sp/>1<sp/>for<sp/>x<sp/>in<sp/>\Omega_e</highlight></codeline>
<codeline lineno="1641"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1642"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>First<sp/>nd+1<sp/>basis<sp/>functions<sp/>are<sp/>nodal<sp/>ones<sp/>on<sp/>the<sp/>reference<sp/>nd-simplex<sp/><sp/>(nd<sp/>&lt;=3)<sp/>with</highlight></codeline>
<codeline lineno="1643"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>coordinates<sp/>xi[0],xi[1],and<sp/>xi[2].<sp/>The<sp/>basis<sp/>functions<sp/>are<sp/>numbered<sp/>according<sp/>to</highlight></codeline>
<codeline lineno="1644"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>nodes.<sp/>The<sp/>last<sp/>shape<sp/>function<sp/>is<sp/>the<sp/>bubble,<sp/>b</highlight></codeline>
<codeline lineno="1645"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1a13d071d534b2f3603990a1110579a8d0" kindref="member">__init__</ref>(self,nd=3):</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryCoords</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>baryGrads</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref><sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self,nd+2,self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>)</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>=[]</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>([])</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;1d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>0,1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>0.0)</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[2](xi))</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[2](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>0.0)</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):<sp/></highlight><highlight class="comment">#0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;2d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"></highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"></highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>on<sp/>0,1,2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:numpy.array([0.0,0.0]))</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"></highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"></highlight></codeline>
<codeline lineno="1727"><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>TODO<sp/>check<sp/>hessian<sp/>formulas!!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryCoords[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i](xi))</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i:</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:<sp/>baryGrads[</highlight><highlight class="stringliteral">&apos;3d&apos;</highlight><highlight class="normal">][i])</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi,<sp/>i=i:</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](xi))</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nd+1):</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[ib].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar,<sp/>i=i,<sp/>ib=ib:</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[i](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[ib](xBar)))</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>ib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for<sp/>nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsofar<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>1.0)</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a313fd8ea74e4685c4f19c5b9581ebb38" kindref="member">basisTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1af19beeb708dd758eb6890b199d0b1d38" kindref="member">basis</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>numpy.array([0.0,0.0,0.0]))</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1ab74c47f0b65719f4fa279f601c4d6512" kindref="member">basisGradients</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](xi))</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[0].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[0](xBar)))</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[1].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[1](xBar)))</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[2].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[2](xBar)))</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1aab3043f959c1a0aca1d651c550fb60b2" kindref="member">basisGradientsTrace</ref>[3].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xBar:</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis_1aa1d291f2266c89680310c088c32d0fac" kindref="member">gradientList</ref>[nsofar](self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a34e3866f9a8e3ada73eab91375c8d50a" kindref="member">referenceElement</ref>.boundaryMapList[3](xBar)))</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d0/d9b/classproteus_1_1FemTools_1_1LocalFunctionSpace_1a51043a8b5c8efe57d6201870426bd806" kindref="member">basisHessians</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>xi:<sp/>numpy.zeros((nd,nd),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"></highlight></codeline>
<codeline lineno="1773"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1774"><highlight class="stringliteral">Interpolation<sp/>conditions.</highlight></codeline>
<codeline lineno="1775"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1776"><highlight class="normal"></highlight></codeline>
<codeline lineno="1777" refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>(object):</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1779"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Base<sp/>class<sp/>for<sp/>generalized<sp/>interpolation<sp/>conditions</highlight></codeline>
<codeline lineno="1780"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>for<sp/>function<sp/>spaces.</highlight></codeline>
<codeline lineno="1781"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1782"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>example,<sp/>a<sp/>function&apos;s<sp/>values<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points</highlight></codeline>
<codeline lineno="1783"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>that<sp/>is<sp/>large<sp/>enough<sp/>to<sp/>uniquely<sp/>specify<sp/>an<sp/>element</highlight></codeline>
<codeline lineno="1784"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>the<sp/>local<sp/>function<sp/>space<sp/>that<sp/>will<sp/>be<sp/>paired<sp/>with</highlight></codeline>
<codeline lineno="1785"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>interpolation<sp/>conditions.</highlight></codeline>
<codeline lineno="1786"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a431a89f2e81efeea07008ad29a004167" kindref="member">__init__</ref>(self,dim=0,referenceElement=None):</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a38780ba43a8e78718aafca88c2bce6e2" kindref="member">dim</ref>=dim</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a99bfb30d7e2396e6335a640141bc1f0f" kindref="member">range_dim</ref><sp/>=<sp/>list(range(dim))</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>=referenceElement</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>=[]</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>=[]</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>=[]</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>=0</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1aa453a7a9ddf8c726d52b0d6a794714fe" kindref="member">quadrature2DOF_element</ref>(self,k):</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>find<sp/>out<sp/>if<sp/>local<sp/>element<sp/>boundary<sp/>interpolation<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#is<sp/>&quot;on&quot;<sp/>local<sp/>face<sp/>ebN_local,<sp/>if<sp/>this<sp/>idea<sp/>makes<sp/>sense</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#None<sp/>means<sp/>not<sp/>defined</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac635cc9e65c61c15c4cff4ce4acefb45" kindref="member">definedOnlocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">#doesn&apos;t<sp/>have<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>map<sp/>interpolation<sp/>conditions<sp/>to<sp/>local<sp/>enumeration<sp/>of<sp/>mesh<sp/>nodes<sp/>(vertices)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#returns<sp/>None<sp/>if<sp/>no<sp/>correspondence</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a433a3b39349bb9eb31722dc103105774" kindref="member">quadrature2Node_element</ref>(self,k):</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#optimized<sp/>projection<sp/>routine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/>projectFiniteElementFunctionFromInterpolationConditions_opt<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1808" refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1810"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>the<sp/>nodes</highlight></codeline>
<codeline lineno="1811"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1a247252d96639145df3b07e023a41443a" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,referenceElement.nNodes,referenceElement)</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((len(referenceElement.nodeList),3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(referenceElement.nodeList):</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=n[I]</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.functionals.append(lambda<sp/>f:<sp/>f(referenceElement.nodeList[0]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.functionalsQuadrature.append(lambda<sp/>fList:<sp/>fList[0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#assert<sp/>referenceElement.nNodes<sp/>&lt;<sp/>6,&quot;Haven&apos;t<sp/>implemented<sp/>%d<sp/>nodes<sp/>for<sp/>nodal<sp/>interpolation<sp/>conditions&quot;<sp/>%<sp/>(referenceElement.nNodes,)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ni<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>referenceElement.range_nNodes:</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f,n=ni:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[n]))</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList,n=ni:<sp/>fList[n])</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>c<sp/>based<sp/>projection<sp/>from<sp/>interpolation<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1abf3375da03066ba64c71bc6bc27d1f8a" kindref="member">functionals_quadrature_map</ref><sp/>=<sp/>numpy.arange(len(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"></highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1aae2a3d01c7038d0bf10ab780a61a60f4" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolation<sp/>points<sp/>indexed<sp/>like<sp/>nodeList<sp/>so<sp/>nodes<sp/>are<sp/>not<sp/>on</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>local<sp/>element<sp/>across<sp/>from<sp/>them</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>&lt;<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>k<sp/>!=<sp/>ebN_local</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1a0bfb589e7f3870db38fc39bc2c4f13ef" kindref="member">quadrature2Node_element</ref>(self,k):</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"></highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1a5bd757afe40e987775fa2e8b131f2fc8" kindref="member">projectFiniteElementFunctionFromInterpolationConditions_opt</ref>(self,finiteElementFunction,interpolationValues):</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1837"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Allow<sp/>the<sp/>interpolation<sp/>conditions<sp/>to<sp/>control<sp/>projection<sp/>of<sp/>a<sp/>(global)<sp/>finite<sp/>element<sp/>function<sp/>from</highlight></codeline>
<codeline lineno="1838"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>an<sp/>array<sp/>of<sp/>interpolation<sp/>values<sp/>in<sp/>order<sp/>to<sp/>take<sp/>advantage<sp/>of<sp/>specific<sp/>structure,<sp/>otherwise</highlight></codeline>
<codeline lineno="1839"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>just<sp/>use<sp/>functionals<sp/>interface</highlight></codeline>
<codeline lineno="1840"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.projectFromNodalInterpolationConditions(finiteElementFunction.dim_dof,</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions_1abf3375da03066ba64c71bc6bc27d1f8a" kindref="member">functionals_quadrature_map</ref>,</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValues,</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.dof)</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"></highlight></codeline>
<codeline lineno="1847" refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions" kindref="compound">CubeNodalInterpolationConditions</ref>(<ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>quadrilateralLocalBoundaryLookup</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>hexahedronLocalBoundaryLookup</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions_1a9dd773950a934c5e0b023563c752a432" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NodalInterpolationConditions.__init__(self,referenceElement)</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions_1a4d8c825c4b2c64f02c1b4dcdb9531637" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#overide<sp/>this<sp/><sp/>one<sp/>function<sp/>from<sp/>nodal<sp/>interpolation<sp/>conditions,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#which<sp/>only<sp/>holds<sp/>for<sp/>simplex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#return<sp/>k<sp/>&lt;<sp/>self.nQuadraturePoints<sp/>and<sp/>k<sp/>!=<sp/>ebN_local</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>!=<sp/>ebN_local</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ebN_local<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.quadrilateralLocalBoundaryLookup[k]</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ebN_local<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.hexahedronLocalBoundaryLookup[k]</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"></highlight></codeline>
<codeline lineno="1863" refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeNodalInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1865"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>vertices<sp/>and</highlight></codeline>
<codeline lineno="1866"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>midpoints<sp/>of<sp/>edges<sp/>(whole<sp/>element<sp/>is<sp/>considered<sp/>an<sp/>edge<sp/>in<sp/>1d)</highlight></codeline>
<codeline lineno="1867"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>p2tetrahedronLocalBoundaryLookup</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>math<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fmod</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1aa929bd9fb274da85ef2acd944d6b19cb" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fact</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>p2refNodes</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdim<sp/><sp/>=<sp/>referenceElement.dim</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a7dd5088afed6dba2d9e58ea76a67b3fa" kindref="member">nInterpNodes</ref>=<sp/>old_div(<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(2+sdim),(2*<ref refid="d5/dea/namespaceproteus_1_1RefUtils_1a3f1d0455f5abc9172544a2adc639ee97" kindref="member">fact</ref>(sdim)))</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a7dd5088afed6dba2d9e58ea76a67b3fa" kindref="member">nInterpNodes</ref>,referenceElement)</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a7dd5088afed6dba2d9e58ea76a67b3fa" kindref="member">nInterpNodes</ref>,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a7dd5088afed6dba2d9e58ea76a67b3fa" kindref="member">nInterpNodes</ref>):</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(sdim):</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]<sp/>=<sp/>p2refNodes[sdim-1][k,I]</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.nQuadraturePoints<sp/>=<sp/>len(self.quadraturePointArray)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>):</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f,i=i:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[i,:]))</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList,<sp/>i=i:<sp/>fList[i])</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>c<sp/>based<sp/>projection<sp/>from<sp/>interpolation<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a02637a15a8deefe71c775cdc91c6d2fb" kindref="member">functionals_quadrature_map</ref><sp/>=<sp/>numpy.arange(len(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a2c1920094ad3c629b1efa8b9a651eaa8" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/>&lt;=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim:</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>!=<sp/>ebN_local</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>int(fmod(k-3<sp/>+<sp/>2,3))</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>i<sp/>==<sp/>ebN_local</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ebN_local<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.p2tetrahedronLocalBoundaryLookup[k]</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1ac7aaae0ab6ecfeabdab5820fa136fd48" kindref="member">quadrature2Node_element</ref>(self,k):</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/>&lt;=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim:</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1af0190262712569aa3ec09419a4f308bc" kindref="member">projectFiniteElementFunctionFromInterpolationConditions_opt</ref>(self,finiteElementFunction,interpolationValues):</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1905"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Allow<sp/>the<sp/>interpolation<sp/>conditions<sp/>to<sp/>control<sp/>projection<sp/>of<sp/>a<sp/>(global)<sp/>finite<sp/>element<sp/>function<sp/>from</highlight></codeline>
<codeline lineno="1906"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>an<sp/>array<sp/>of<sp/>interpolation<sp/>values<sp/>in<sp/>order<sp/>to<sp/>take<sp/>advantage<sp/>of<sp/>specific<sp/>structure,<sp/>otherwise</highlight></codeline>
<codeline lineno="1907"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>just<sp/>use<sp/>functionals<sp/>interface</highlight></codeline>
<codeline lineno="1908"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.projectFromNodalInterpolationConditions(finiteElementFunction.dim_dof,</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions_1a02637a15a8deefe71c775cdc91c6d2fb" kindref="member">functionals_quadrature_map</ref>,</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValues,</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.dof)</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"></highlight></codeline>
<codeline lineno="1915" refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeCubeNodalInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1917"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>vertices<sp/>and</highlight></codeline>
<codeline lineno="1918"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>midpoints<sp/>of<sp/>edges<sp/>(whole<sp/>element<sp/>is<sp/>considered<sp/>an<sp/>edge<sp/>in<sp/>1d)</highlight></codeline>
<codeline lineno="1919"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>q2quadrilateralLocalBoundaryLookup</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>q2hexahedronLocalBoundaryLookup</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>math<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fmod</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a466955144d16060233fdd3c0a5b37939" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fact</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.RefUtils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>q2refNodes</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdim<sp/><sp/>=<sp/>referenceElement.dim</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sdim==2:</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref><sp/>=<sp/>9</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>sdim==3:</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref><sp/>=<sp/>27</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref>,referenceElement)</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref>,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.nQuadraturePoints<sp/>=<sp/>len(self.quadraturePointArray)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sdim==2:</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref>):</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(sdim):</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]<sp/>=<sp/>q2refNodes[1][k,I]</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>sdim==3:</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a483fce0b8dda68e5dd8f70f6282ff45e" kindref="member">nInterpNodes</ref>):</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(sdim):</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]<sp/>=<sp/>q2refNodes[2][k,I]</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>len(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>)</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>):</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f,i=i:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[i,:]))</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList,<sp/>i=i:<sp/>fList[i])</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>c<sp/>based<sp/>projection<sp/>from<sp/>interpolation<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a06ecb9904680647e7c22eb14bb672026" kindref="member">functionals_quadrature_map</ref><sp/>=<sp/>numpy.arange(len(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1aa0d719b8a796406783cbc373817f1b29" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/>&lt;=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim:</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>!=<sp/>ebN_local</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ebN_local<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.q2quadrilateralLocalBoundaryLookup[k]</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ebN_local<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.q2hexahedronLocalBoundaryLookup[k]</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a5ebc398a5efb858db096ca66eec9264a" kindref="member">quadrature2Node_element</ref>(self,k):</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/>&lt;=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.dim**2:</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a44938863e75fde3fe0b16d591841377a" kindref="member">projectFiniteElementFunctionFromInterpolationConditions_opt</ref>(self,finiteElementFunction,interpolationValues):</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1968"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Allow<sp/>the<sp/>interpolation<sp/>conditions<sp/>to<sp/>control<sp/>projection<sp/>of<sp/>a<sp/>(global)<sp/>finite<sp/>element<sp/>function<sp/>from</highlight></codeline>
<codeline lineno="1969"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>an<sp/>array<sp/>of<sp/>interpolation<sp/>values<sp/>in<sp/>order<sp/>to<sp/>take<sp/>advantage<sp/>of<sp/>specific<sp/>structure,<sp/>otherwise</highlight></codeline>
<codeline lineno="1970"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>just<sp/>use<sp/>functionals<sp/>interface</highlight></codeline>
<codeline lineno="1971"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.projectFromNodalInterpolationConditions(finiteElementFunction.dim_dof,</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions_1a06ecb9904680647e7c22eb14bb672026" kindref="member">functionals_quadrature_map</ref>,</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValues,</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.dof)</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValues<sp/>=<sp/>finiteElementFunction.dof</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"></highlight></codeline>
<codeline lineno="1979"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>interp<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1980"><highlight class="normal"></highlight></codeline>
<codeline lineno="1981" refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions" kindref="compound">FaceBarycenterInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1983"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>the<sp/>barycenter<sp/>of<sp/>faces</highlight></codeline>
<codeline lineno="1984"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1af8081e864c8b346bbe387e71d3a44160" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,referenceElement.nElementBoundaries,referenceElement)</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((referenceElement.nElementBoundaries,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#put<sp/>in<sp/>crude<sp/>switch<sp/>on<sp/>number<sp/>of<sp/>dimensions<sp/>for<sp/>now?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebary<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a6762966a464f30fa7b9e9235b4d3373b" kindref="member">EVec</ref>(0.0,0.0,0.0)</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.dim<sp/>==<sp/>2:<sp/></highlight><highlight class="comment">#2d,<sp/>interpolation<sp/>points<sp/>are<sp/>edge<sp/>barycenters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebary<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a6762966a464f30fa7b9e9235b4d3373b" kindref="member">EVec</ref>(0.5,0.0,0.0)</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>referenceElement.dim<sp/>==<sp/>3:<sp/></highlight><highlight class="comment">#3d,<sp/>interpolation<sp/>points<sp/>are<sp/>face<sp/>barycenters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebary<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a6762966a464f30fa7b9e9235b4d3373b" kindref="member">EVec</ref>(old_div(1.,3.),old_div(1.,3.),0.0)</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=referenceElement.boundaryMapList[k](ebary)[I]</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ntmp<sp/><sp/><sp/>=<sp/><ref refid="d2/ddd/classproteus_1_1MeshTools_1_1Node" kindref="compound">Node</ref>()</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ntmp.p<sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,:]</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(ntmp)</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>k<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>loop<sp/>through<sp/>boundary<sp/>maps</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>[0]))</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[0])</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>referenceElement.nElementBoundaries<sp/>&lt;<sp/>6,</highlight><highlight class="stringliteral">&quot;Haven&apos;t<sp/>implemented<sp/>%d<sp/>faces<sp/>with<sp/>nodal<sp/>interpolation<sp/>conditions&quot;</highlight><highlight class="normal"><sp/>%<sp/>(referenceElement.nElementBoundaries,)</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nElementBoundaries<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>[1]))</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[1])</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nElementBoundaries<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>[2]))</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[2])</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nElementBoundaries<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>[3]))</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[3])</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nElementBoundaries<sp/>&gt;<sp/>4:</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a7e081e93a87ad85767dbfd5b10d6e206" kindref="member">ebaryList</ref>[4]))</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[4])</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>c<sp/>based<sp/>projection<sp/>from<sp/>interpolation<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a903a2ed0321315fc302e6a595aaef557" kindref="member">functionals_quadrature_map</ref><sp/>=<sp/>numpy.arange(len(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"></highlight></codeline>
<codeline lineno="2023"><highlight class="normal"></highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a8e629842ff572b769dfa1af20d0b7382" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolation<sp/>conditions<sp/>indexed<sp/>like<sp/>locak<sp/>boundaries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>==<sp/>ebN_local</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a716d351ae1fe6c890ba762b5f2bde4da" kindref="member">projectFiniteElementFunctionFromInterpolationConditions_opt</ref>(self,finiteElementFunction,interpolationValues):</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2030"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Allow<sp/>the<sp/>interpolation<sp/>conditions<sp/>to<sp/>control<sp/>projection<sp/>of<sp/>a<sp/>(global)<sp/>finite<sp/>element<sp/>function<sp/>from</highlight></codeline>
<codeline lineno="2031"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>an<sp/>array<sp/>of<sp/>interpolation<sp/>values<sp/>in<sp/>order<sp/>to<sp/>take<sp/>advantage<sp/>of<sp/>specific<sp/>structure,<sp/>otherwise</highlight></codeline>
<codeline lineno="2032"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>just<sp/>use<sp/>functionals<sp/>interface</highlight></codeline>
<codeline lineno="2033"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.projectFromNodalInterpolationConditions(finiteElementFunction.dim_dof,</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions_1a903a2ed0321315fc302e6a595aaef557" kindref="member">functionals_quadrature_map</ref>,</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValues,</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finiteElementFunction.dof)</highlight></codeline>
<codeline lineno="2039"><highlight class="normal"></highlight></codeline>
<codeline lineno="2040"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>interp<sp/>conditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"></highlight></codeline>
<codeline lineno="2042" refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions" kindref="compound">p0InterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Quadrature</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2045"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>the<sp/>nodes</highlight></codeline>
<codeline lineno="2046"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a463aed990b43fea5347b1bd6e223a966" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>=self.Quadrature.<ref refid="de/d6b/classproteus_1_1Quadrature_1_1SimplexLobattoQuadrature" kindref="compound">SimplexLobattoQuadrature</ref>(referenceElement.dim,1)</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,1,referenceElement)</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((len(self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.weights),3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.points):</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=p[I]</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a8e7e203bec9977b832484a7bf9a0ce3c" kindref="member">vol</ref>=<ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([w<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><sp/>self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.weights])</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/>old_div(<ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([w*<ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(p)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>w,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.weights,self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.points)]),self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a8e7e203bec9977b832484a7bf9a0ce3c" kindref="member">vol</ref>))</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>old_div(<ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([w*f<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>w,f<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a3c028dc83cfabda41e08fca81e875c86" kindref="member">quadrature</ref>.weights,fList)]),self.<ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a8e7e203bec9977b832484a7bf9a0ce3c" kindref="member">vol</ref>))</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a396f6317947e394ecebba0ba7b00580c" kindref="member">quadrature2DOF_element</ref>(self,k):</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions_1a8ba40183c344049cfe039c976abd5e01" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#have<sp/>choice<sp/>are<sp/>interior<sp/>nodal<sp/>conditions<sp/>for<sp/>dg<sp/>on<sp/>all<sp/>boundaries<sp/>or<sp/>none?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">#if<sp/>matching<sp/>quadrature2DOF_element<sp/>behavior,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"></highlight></codeline>
<codeline lineno="2064" refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions" kindref="compound">MonomialInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Quadrature</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2067"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>the<sp/>nodes</highlight></codeline>
<codeline lineno="2068"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a51dd5e3f260166c5aadad35126628bff" kindref="member">__init__</ref>(self,referenceElement,monomialSpace):</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>LinearSolvers</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>=self.Quadrature.<ref refid="dc/d35/classproteus_1_1Quadrature_1_1SimplexGaussQuadrature" kindref="compound">SimplexGaussQuadrature</ref>(referenceElement.dim,<ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(monomialSpace.kOrder*2,1))</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,monomialSpace.dim,referenceElement)</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((len(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.weights),3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.points):</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=p[I]</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a56f84f645a31ecc5077f7c4d11615947" kindref="member">vol</ref>=<ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([w<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.weights])</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vk<sp/>=<sp/>[[<ref refid="de/d5b/Headers_8h_1abb6e996fea4e5f276fdcec0c7d809274" kindref="member">v</ref>(p)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.points]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>monomialSpace.basis]</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1aa2b3209504d629222d286a432b2422a6" kindref="member">V</ref><sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a5d6af2f602552724ddbcea24b486ba59" kindref="member">Mat</ref>(monomialSpace.dim,monomialSpace.dim)</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,vi<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(vk):</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j,vj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(vk):</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>vik,vjk,w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(vi,vj,self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.weights):</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1aa2b3209504d629222d286a432b2422a6" kindref="member">V</ref>[i,j]<sp/>+=<sp/>vjk*vik*w</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a0432636b304f29a8c16eaf38264626da" kindref="member">LUV</ref><sp/>=<sp/><ref refid="d7/d3a/classproteus_1_1LinearSolvers_1_1LU" kindref="compound">LinearSolvers.LU</ref>(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1aa2b3209504d629222d286a432b2422a6" kindref="member">V</ref>)</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#set<sp/>for<sp/>local<sp/>(on<sp/>processor)<sp/>solves</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a0432636b304f29a8c16eaf38264626da" kindref="member">LUV</ref>.norm<sp/>=<sp/>l2Norm_local</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a0432636b304f29a8c16eaf38264626da" kindref="member">LUV</ref>.prepare()</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1ab9d991a30e1a90d50092c75aa4f9d431" kindref="member">w</ref>=numpy.zeros((monomialSpace.dim,self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.weights):</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vjk<sp/>=<sp/>numpy.zeros((monomialSpace.dim,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wk<sp/>=<sp/>numpy.zeros((monomialSpace.dim,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim):</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vjk[j]<sp/>=<sp/>vk[j][k]</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a0432636b304f29a8c16eaf38264626da" kindref="member">LUV</ref>.solve(wk,b=vjk)</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim):</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1ab9d991a30e1a90d50092c75aa4f9d431" kindref="member">w</ref>[i,k]<sp/>+=<sp/>wk[i]*w</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref><sp/>=<sp/>[(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([<ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(p)*wik<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>wik,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1ab9d991a30e1a90d50092c75aa4f9d431" kindref="member">w</ref>[i,:],self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a2929d4b6dd89aca05117e1ba39f57738" kindref="member">quadrature</ref>.points)]))</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim)]</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref><sp/>=<sp/>[(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList,<sp/>i=i:<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([f*wik<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>wik,f<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1ab9d991a30e1a90d50092c75aa4f9d431" kindref="member">w</ref>[i,:],fList)]))</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim)]</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"></highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1addfb3137f5a29143a4357426976cfa7b" kindref="member">quadrature2DOF_element</ref>(self,k):</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions_1a0592f7fc4124d9ef4e2844401b73c208" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#have<sp/>choice<sp/>are<sp/>interior<sp/>nodal<sp/>conditions<sp/>for<sp/>dg<sp/>on<sp/>all<sp/>boundaries<sp/>or<sp/>none?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">#if<sp/>matching<sp/>quadrature2DOF_element<sp/>behavior,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2108"><highlight class="normal"></highlight></codeline>
<codeline lineno="2109"><highlight class="normal"></highlight></codeline>
<codeline lineno="2110" refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions" kindref="compound">P1BubbleInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2112"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Interpolation<sp/>conditions<sp/>for<sp/>space<sp/>P1<sp/>enriched<sp/>with<sp/>bubbles</highlight></codeline>
<codeline lineno="2113"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2115"><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>P^1(\hat{\Omega_e})<sp/>\oplus<sp/>\mbox{span}{\hat{b}}<sp/>b<sp/>=<sp/>(n_d+1)^{n_d+1}<sp/>\Pi_{i=0}^{n_d}<sp/>\lambda_i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2117"><highlight class="normal"></highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Note<sp/>:math:`b(\bar{x_{e}})<sp/>=<sp/>1`</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2119"><highlight class="normal"></highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Interpolation<sp/>conditions<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>..<sp/>math::</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2122"><highlight class="normal"></highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>v(x_j),<sp/>j<sp/>=<sp/>0,<sp/>n_d<sp/>\mbox{for<sp/>vertices}<sp/>x_j<sp/>\mbox{and}<sp/>v(\bar{x}_{e})<sp/>-<sp/>\frac{1}{d+1}\sum_{j=0}^{n_d}(v(<sp/>x_j))<sp/>\mbox{for}<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions_1aa057214a6bdc2dbdf7112a1a0bd93f66" kindref="member">__init__</ref>(self,referenceElement):</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,referenceElement.nNodes+1,referenceElement)</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((len(referenceElement.nodeList)+1,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(referenceElement.nodeList):</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=n[I]</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(referenceElement.nodeList):</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes,I]<sp/>+=<sp/>n[I]</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes,:]<sp/>/=<sp/>float(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes)</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"></highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[0]))</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[0])</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nNodes<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[1]))</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[1])</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nNodes<sp/>&gt;<sp/>2:</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[2]))</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[2])</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nNodes<sp/>&gt;<sp/>3:</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[3]))</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[3])</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nNodes<sp/>&gt;<sp/>4:</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(referenceElement.nodeList[4]))</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[4])</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.nNodes<sp/>&gt;<sp/>5:</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;Haven&apos;t<sp/>implemented<sp/>this<sp/>many<sp/>nodes<sp/>for<sp/>nodal<sp/>interpolation<sp/>conditions&quot;</highlight><highlight class="normal">,level=1)</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#bubble</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp1inv<sp/>=<sp/>old_div(1.0,float(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes))</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[-1,:])<sp/>-<sp/>\</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp1inv<sp/>*<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref>[i](self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[-1,:])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes)]))</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList:<sp/>fList[self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes]<sp/>-<sp/>\</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dp1inv<sp/>*<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>(fList[:self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a6566a9864a60975b5e3f48d731fd93a7" kindref="member">referenceElement</ref>.nNodes]))</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"></highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>debug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#import<sp/>pdb</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#pdb.set_trace()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions_1a3b98d9369339204ecc39795ec7189f38" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolation<sp/>points<sp/>indexed<sp/>like<sp/>nodeList<sp/>so<sp/>nodes<sp/>are<sp/>not<sp/>on</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>local<sp/>element<sp/>across<sp/>from<sp/>them</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k<sp/>&lt;<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>-1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>k<sp/>!=<sp/>ebN_local</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions_1aee958ce330c533c86fa21721c312fc0a" kindref="member">quadrature2Node_element</ref>(self,k):</highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/>&lt;<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>-1:</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>k</highlight></codeline>
<codeline lineno="2172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2173"><highlight class="normal"></highlight></codeline>
<codeline lineno="2174"><highlight class="normal"></highlight></codeline>
<codeline lineno="2175" refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions" kindref="compound">P1P0BubbleInterpolationConditions</ref>(<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions" kindref="compound">InterpolationConditions</ref>):</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Quadrature</highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2178"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Obtains<sp/>the<sp/>DOF<sp/>from<sp/>the<sp/>function<sp/>values<sp/>at<sp/>the<sp/>nodes</highlight></codeline>
<codeline lineno="2179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a9de9b95eca31f9230cc102e3471ada60" kindref="member">__init__</ref>(self,referenceElement,monomialSpace):</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>LinearSolvers</highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>=self.Quadrature.<ref refid="dc/d35/classproteus_1_1Quadrature_1_1SimplexGaussQuadrature" kindref="compound">SimplexGaussQuadrature</ref>(referenceElement.dim,2)</highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterpolationConditions.__init__(self,monomialSpace.dim,referenceElement)</highlight></codeline>
<codeline lineno="2184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref><sp/>=<sp/>numpy.zeros((len(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.weights),3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.points):</highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(referenceElement.dim):</highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>[k,I]=p[I]</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref><sp/>=<sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ae3175ca01069c0314e078999425454ac" kindref="member">quadraturePointArray</ref>.shape[0]</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1ad39913f0e3307a1318ff5a508431c395" kindref="member">vol</ref>=<ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([w<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.weights])</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vk<sp/>=<sp/>[[<ref refid="de/d5b/Headers_8h_1abb6e996fea4e5f276fdcec0c7d809274" kindref="member">v</ref>(p)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.points]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>monomialSpace.basis]</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1ab864320512077f66b46bb7983eb346e0" kindref="member">V</ref><sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a5d6af2f602552724ddbcea24b486ba59" kindref="member">Mat</ref>(monomialSpace.dim,monomialSpace.dim)</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,vi<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(vk):</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j,vj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(vk):</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>vik,vjk,w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(vi,vj,self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.weights):</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1ab864320512077f66b46bb7983eb346e0" kindref="member">V</ref>[i,j]<sp/>+=<sp/>vjk*vik*w</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a15b51ad6f26d2a0c1d513801026c0c25" kindref="member">LUV</ref><sp/>=<sp/><ref refid="d7/d3a/classproteus_1_1LinearSolvers_1_1LU" kindref="compound">LinearSolvers.LU</ref>(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1ab864320512077f66b46bb7983eb346e0" kindref="member">V</ref>)</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#set<sp/>for<sp/>local<sp/>(on<sp/>processor)<sp/>solves</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a15b51ad6f26d2a0c1d513801026c0c25" kindref="member">LUV</ref>.norm<sp/>=<sp/>l2Norm_local</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a15b51ad6f26d2a0c1d513801026c0c25" kindref="member">LUV</ref>.prepare()</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a30236b3eefc1ea54ee70372b3dac2e37" kindref="member">w</ref>=numpy.zeros((monomialSpace.dim,self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1ac9df54e4fb69d617a6f416967490fae4" kindref="member">nQuadraturePoints</ref>),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,w<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.weights):</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vjk<sp/>=<sp/>numpy.zeros((monomialSpace.dim,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wk<sp/>=<sp/>numpy.zeros((monomialSpace.dim,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim):</highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vjk[j]<sp/>=<sp/>vk[j][k]</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a15b51ad6f26d2a0c1d513801026c0c25" kindref="member">LUV</ref>.solve(wk,b=vjk)</highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim):</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a30236b3eefc1ea54ee70372b3dac2e37" kindref="member">w</ref>[i,k]<sp/>+=<sp/>wk[i]*w</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a4c6f74dfd515b6cec06ec9a3b3149536" kindref="member">functionals</ref><sp/>=<sp/>[(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>f:<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([<ref refid="d8/dd9/namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(p)*wik<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/><sp/>wik,p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a30236b3eefc1ea54ee70372b3dac2e37" kindref="member">w</ref>[i,:],self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1acd5e49769c6982ceae46f37f4c6beeb7" kindref="member">quadrature</ref>.points)]))</highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim)]</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/da7/classproteus_1_1FemTools_1_1InterpolationConditions_1a652d704b2260f55d760b23131388b043" kindref="member">functionalsQuadrature</ref><sp/>=<sp/>[(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>fList,<sp/>i=i:<sp/><ref refid="de/d5b/Headers_8h_1a4236a05d5d04839f0af91439cb8820b8" kindref="member">sum</ref>([f*wik<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>wik,f<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(self.<ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a30236b3eefc1ea54ee70372b3dac2e37" kindref="member">w</ref>[i,:],fList)]))</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(monomialSpace.dim)]</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"></highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1a1c341373f7896c256f2af32093d4e173" kindref="member">quadrature2DOF_element</ref>(self,k):</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions_1abe81f6d5c7f183e26ceb3018abde39c1" kindref="member">definedOnLocalElementBoundary</ref>(self,k,ebN_local):</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#have<sp/>choice<sp/>are<sp/>interior<sp/>nodal<sp/>conditions<sp/>for<sp/>dg<sp/>on<sp/>all<sp/>boundaries<sp/>or<sp/>none?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">#if<sp/>matching<sp/>quadrature2DOF_element<sp/>behavior,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"></highlight></codeline>
<codeline lineno="2220"><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2222"><highlight class="stringliteral">Finite<sp/>Elements</highlight></codeline>
<codeline lineno="2223"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2224"><highlight class="normal"></highlight></codeline>
<codeline lineno="2225" refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(object):</highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>geometric<sp/>element,<sp/>local<sp/>function<sp/>space,<sp/>and<sp/>interpolation</highlight></codeline>
<codeline lineno="2228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>conditions.</highlight></codeline>
<codeline lineno="2229"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>I<sp/>distinguish<sp/>between<sp/>the<sp/>&quot;elements&quot;<sp/>(patches)<sp/>of<sp/>the<sp/>mesh<sp/>and</highlight></codeline>
<codeline lineno="2231"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>&quot;finite<sp/>elements&quot;<sp/>which<sp/>also<sp/>include<sp/>information<sp/>about<sp/>the</highlight></codeline>
<codeline lineno="2232"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>function<sp/>space.<sp/>This<sp/>is<sp/>sort<sp/>of<sp/>consistent<sp/>with<sp/>the<sp/>mathematical</highlight></codeline>
<codeline lineno="2233"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>theory<sp/>where<sp/>a<sp/>finite<sp/>element<sp/>is<sp/>a<sp/>triple:<sp/>(T,PI,SIGMA)</highlight></codeline>
<codeline lineno="2234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement_1a0a900e080f73c48b21b067e021766f20" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace,</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions):</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement_1a15667027bf953d5986db3aa3d5c9aa4b" kindref="member">referenceElement</ref><sp/>=<sp/>localFunctionSpace.referenceElement</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement_1a5ee6c9dbcd35689380ea8847bec573e8" kindref="member">localFunctionSpace</ref><sp/>=<sp/>localFunctionSpace</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement_1a7ece6e4fc70e9c99c1e5359ea25c17f4" kindref="member">interpolationConditions</ref><sp/>=<sp/>interpolationConditions</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"></highlight></codeline>
<codeline lineno="2242"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2243"><highlight class="stringliteral">Degrees<sp/>of<sp/>freedom<sp/>mappings</highlight></codeline>
<codeline lineno="2244"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2245"><highlight class="normal"></highlight></codeline>
<codeline lineno="2246" refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>(object):</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Base<sp/>class<sp/>for<sp/>integer<sp/>mappings<sp/>between<sp/>local<sp/>degrees<sp/>of<sp/>freedom</highlight></codeline>
<codeline lineno="2249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>global<sp/>degrees<sp/>of<sp/>freedom.</highlight></codeline>
<codeline lineno="2250"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a90666dd071b0d659be241c0459d0246b" kindref="member">__init__</ref>(self,nDOF=0):</highlight></codeline>
<codeline lineno="2252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref><sp/>=<sp/>nDOF</highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1aaa2642f823ba4b932f9646f030c09a8a" kindref="member">range_nDOF</ref><sp/>=<sp/>range(nDOF)</highlight></codeline>
<codeline lineno="2254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>in<sp/>whole<sp/>domain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>including<sp/>ghosts<sp/>on<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mapping<sp/>of<sp/>dof<sp/>numbers<sp/>from<sp/>processor<sp/>to<sp/>global<sp/>numbering</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#maximum<sp/>number<sp/>of<sp/>neighbors<sp/>for<sp/>connectivity<sp/>of<sp/>dofs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2268" refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">NodalDOFMap(DOFMap):</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>mapping<sp/>that<sp/>associates<sp/>a<sp/>local<sp/>degree<sp/>of<sp/>freedom<sp/>number</highlight></codeline>
<codeline lineno="2271"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>the<sp/>global<sp/>node<sp/>numbers<sp/>of<sp/>the<sp/>element.</highlight></codeline>
<codeline lineno="2272"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap_1af1fc01dba262293da7bd7b68123add3e" kindref="member">__init__</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,mesh.nNodes_global)</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.l2g=mesh.elementNodesArray</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#save<sp/>for<sp/>parallel<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mesh<sp/>==<sp/>mesh.subdomainMesh:</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.updateAfterParallelPartitioning(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dof_offsets_subdomain_owned<sp/>=<sp/>mesh.nodeOffsets_subdomain_owned</highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nDOF_all_processes<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nDOF_subdomain<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.subdomain2global<sp/>=<sp/>mesh.nodeNumbering_subdomain2global</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.max_dof_neighbors<sp/>=<sp/>mesh.max_nNodeNeighbors_node</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap_1ac9dbc45ca38f9e0c24613fa65c67f6ca" kindref="member">updateAfterParallelPartitioning</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#array<sp/>of<sp/>&apos;offsets&apos;<sp/>where<sp/>owned<sp/>dof<sp/>numbers<sp/>start<sp/>on<sp/>each<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dof_offsets_subdomain_owned<sp/>=<sp/>mesh.nodeOffsets_subdomain_owned</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>in<sp/>whole<sp/>domain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nDOF_all_processes<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>including<sp/>ghosts<sp/>on<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nDOF_subdomain<sp/>=<sp/>mesh.subdomainMesh.nNodes_global</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mapping<sp/>of<sp/>dof<sp/>numbers<sp/>from<sp/>processor<sp/>to<sp/>global<sp/>numbering</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.subdomain2global<sp/>=<sp/>mesh.nodeNumbering_subdomain2global</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#maximum<sp/>number<sp/>of<sp/>neighbors<sp/>for<sp/>connectivity<sp/>of<sp/>dofs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.max_dof_neighbors<sp/>=<sp/>mesh.max_nNodeNeighbors_node</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"></highlight></codeline>
<codeline lineno="2297" refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" kindref="compound">DiscontinuousGalerkinDOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2299"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>DOF<sp/>map<sp/>to<sp/>use<sp/>with<sp/>discontinuous<sp/>Galerkin<sp/>spaces,<sp/>which<sp/>have</highlight></codeline>
<codeline lineno="2300"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>unique<sp/>degrees<sp/>of<sp/>freedom<sp/>on<sp/>each<sp/>element.</highlight></codeline>
<codeline lineno="2301"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap_1a1039715d0f0a0056f5aa44dd4bf6481c" kindref="member">__init__</ref>(self,mesh,localFunctionSpace):</highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,mesh.nElements_global*localFunctionSpace.dim)</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref><sp/>=<sp/>numpy.zeros((mesh.nElements_global,</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap_1ac661a112f70717f5ee14837b88d78e0f" kindref="member">local_dim</ref><sp/>=<sp/>localFunctionSpace.dim</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>for<sp/>i<sp/>in<sp/>localFunctionSpace.range_dim:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.l2g[eN,i]<sp/>=<sp/>eN*localFunctionSpace.dim<sp/>+<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>#end<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>eN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap_1a1d449bbf78b14a5d3ba0795212e3d22f" kindref="member">updateAfterParallelPartitioning</ref>(self,globalMesh):</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2317"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fix<sp/>nDOF_all_processes,<sp/>nDOF_subdomain,<sp/>and<sp/>max_dof_neighbors</highlight></codeline>
<codeline lineno="2318"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Comm</highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpi_comm<sp/>=<sp/>Comm.get().comm.tompi4py()</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>numpy.zeros(globalMesh.nodeOffsets_subdomain_owned.shape,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref>,</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref>,</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref>)<sp/>=<sp/>cpartitioning.buildDiscontinuousGalerkinLocal2GlobalMappings(mpi_comm,</highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap_1ac661a112f70717f5ee14837b88d78e0f" kindref="member">local_dim</ref>,</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.cmesh,</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.subdomainMesh.cmesh,</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref>,</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>,</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref>)</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>disc.map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2336" refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap" kindref="compound">ElementBoundaryDOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2338"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>mapping<sp/>that<sp/>associates<sp/>a<sp/>local<sp/>degree<sp/>of<sp/>freedom<sp/>number</highlight></codeline>
<codeline lineno="2339"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>the<sp/>global<sp/>edge<sp/>numbers<sp/>of<sp/>the<sp/>element.</highlight></codeline>
<codeline lineno="2340"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap_1a068f7a04c8ab59b093e6b1babd0b5104" kindref="member">__init__</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,mesh.nElementBoundaries_global)</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref><sp/>=<sp/>mesh.elementBoundariesArray</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#save<sp/>for<sp/>parallel<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap_1a2580701f2be022f3f9db8403060f3d7c" kindref="member">updateAfterParallelPartitioning</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#array<sp/>of<sp/>&apos;offsets&apos;<sp/>where<sp/>owned<sp/>dof<sp/>numbers<sp/>start<sp/>on<sp/>each<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>mesh.elementBoundaryOffsets_subdomain_owned</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>in<sp/>whole<sp/>domain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>mesh.nElementBoundaries_global</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#total<sp/>number<sp/>of<sp/>dofs<sp/>including<sp/>ghosts<sp/>on<sp/>subdomain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>mesh.subdomainMesh.nElementBoundaries_global</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mapping<sp/>of<sp/>dof<sp/>numbers<sp/>from<sp/>processor<sp/>to<sp/>global<sp/>numbering</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>mesh.elementBoundaryNumbering_subdomain2global</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#maximum<sp/>number<sp/>of<sp/>neighbors<sp/>for<sp/>connectivity<sp/>of<sp/>dofs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>2*(mesh.nElementBoundaries_element-1)+1</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2358"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>ElementBoundaryDOFMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2359" refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" kindref="compound">QuadraticLagrangeCubeDOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2361"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOF<sp/>mapping<sp/>for<sp/>quadratic<sp/>lagrange<sp/>finite<sp/>element<sp/>functions<sp/>on</highlight></codeline>
<codeline lineno="2362"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>unit<sp/>cubes</highlight></codeline>
<codeline lineno="2363"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2364"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>mapping<sp/>associates<sp/>local<sp/>degree<sp/>of<sp/>freedom<sp/>with<sp/>global<sp/>vertex</highlight></codeline>
<codeline lineno="2365"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>number<sp/>for<sp/>iloc<sp/>0&lt;=<sp/>iloc&lt;=<sp/>space<sp/>dim<sp/>global<sp/>edge<sp/>number<sp/>for</highlight></codeline>
<codeline lineno="2366"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>spacedim<sp/>&lt;<sp/>iloc</highlight></codeline>
<codeline lineno="2367"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2368"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>total<sp/>dimension<sp/>is<sp/>number<sp/>of<sp/>vertices<sp/>+<sp/>number<sp/>of<sp/>edges</highlight></codeline>
<codeline lineno="2369"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO<sp/>fix</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>lagrangeNodesArray<sp/>to<sp/>hold<sp/>all<sp/>the<sp/>nodes<sp/>for<sp/>parallel<sp/>in<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>determine<sp/>if<sp/>really<sp/>need<sp/>to<sp/>call<sp/>updateAfterParallelPartitioning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>after<sp/>__init__<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a9bca1c46989e27676477bbd25ebb8b19" kindref="member">__init__</ref>(self,mesh,localFunctionSpace,nd):</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;QuadraticLagrangeCubeDOFMap<sp/>not<sp/>supported<sp/>for<sp/>nd<sp/>=<sp/>1&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#ndof<sp/>+=<sp/>mesh.nElements_global</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElementBoundaries_global</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElements_global</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nEdges_global</highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElementBoundaries_global</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElements_global</highlight></codeline>
<codeline lineno="2387"><highlight class="normal"></highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,ndof)</highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#holds<sp/>lagrange<sp/>nodes<sp/>for<sp/>all<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a2b55961f53e5aa839b568343691f63ab" kindref="member">nd</ref><sp/>=<sp/>nd</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a8ecb689a4068169005096d83d56f28a6" kindref="member">lagrangeNodesArray</ref><sp/>=<sp/>numpy.zeros((ndof,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref><sp/>=<sp/>numpy.zeros((mesh.nElements_global,</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a2b55961f53e5aa839b568343691f63ab" kindref="member">nd</ref><sp/>=<sp/>nd</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#do<sp/>simplest<sp/>numbering<sp/>first,<sp/>which<sp/>is<sp/>to<sp/>assign<sp/>first<sp/>d+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#unknowns<sp/>the<sp/>corresponding<sp/>global<sp/>node<sp/>number.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>1d,<sp/>extra<sp/>unknown<sp/>can<sp/>be<sp/>associated<sp/>with<sp/>global<sp/>element<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>2d,<sp/>extra<sp/>unknowns<sp/>can<sp/>be<sp/>associated<sp/>with<sp/>element<sp/>boundaries<sp/>array<sp/>(edges)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>3d,<sp/>extra<sp/>unknowns<sp/>have<sp/>to<sp/>be<sp/>associated<sp/>with<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"></highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxSeen<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>.flat)</highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>maxSeen<sp/>&lt;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>,(</highlight><highlight class="stringliteral">&apos;QuadDOF<sp/>max(l2g)=<sp/>%d<sp/>ndof=<sp/>%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(maxSeen,self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>))</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#save<sp/>for<sp/>parallel<sp/>mappings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a45f9aab4410f5d34475fbef56576c166" kindref="member">updateAfterParallelPartitioning</ref>(self,globalMesh):</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2410"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fix<sp/>self.nDOF_all_processes,self.nDOF_subdomain,<sp/>self.max_dof_neighbors</highlight></codeline>
<codeline lineno="2411"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Comm</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpi_comm<sp/>=<sp/>Comm.get().comm.tompi4py()</highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a2b55961f53e5aa839b568343691f63ab" kindref="member">nd</ref>==2:</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>with<sp/>the<sp/>vertex<sp/>DoFs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,node<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(globalMesh.nodeArray):</highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a8ecb689a4068169005096d83d56f28a6" kindref="member">lagrangeNodesArray</ref>[i]<sp/>=<sp/>node</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>next<sp/>fill<sp/>up<sp/>the<sp/>edge<sp/>DoF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edge_indicator<sp/>=<sp/>numpy.zeros(globalMesh.nElementBoundaries_global,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,edge_list<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(globalMesh.elementBoundariesArray):</highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j,edge<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(edge_list):</highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>edge_indicator[edge]==0:</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edge_indicator[edge]==1</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node1<sp/>=<sp/>globalMesh.elementNodesArray[i][j]</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node2<sp/>=<sp/>globalMesh.elementNodesArray[i][(j+1)%4]</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edge_coordinate<sp/>=<sp/>[0.,0.,0.]</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edge_coordinate[0]<sp/>=<sp/>0.5*(globalMesh.nodeArray[node1][0]+globalMesh.nodeArray[node2][0])</highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edge_coordinate[1]<sp/>=<sp/>0.5*(globalMesh.nodeArray[node1][1]+globalMesh.nodeArray[node2][1])</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a8ecb689a4068169005096d83d56f28a6" kindref="member">lagrangeNodesArray</ref>[len(globalMesh.nodeArray)+edge]<sp/>=<sp/>edge_coordinate</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>fill<sp/>up<sp/>the<sp/>DoF<sp/>for<sp/>the<sp/>center<sp/>of<sp/>the<sp/>elements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(globalMesh.elementNodesArray):</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element_coordinate<sp/>=<sp/>[0.,0.,0.]</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element_coordinate[0]<sp/>=<sp/>0.5*(globalMesh.nodeArray[element[0]][0]<sp/>+<sp/>globalMesh.nodeArray[element[-1]][0])</highlight></codeline>
<codeline lineno="2436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element_coordinate[1]<sp/>=<sp/>0.5*(globalMesh.nodeArray[element[0]][1]<sp/>+<sp/>globalMesh.nodeArray[element[1]][1])</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a8ecb689a4068169005096d83d56f28a6" kindref="member">lagrangeNodesArray</ref>[globalMesh.nNodes_global<sp/>+<sp/>globalMesh.nElementBoundaries_global<sp/>+<sp/>i]<sp/>=<sp/>element_coordinate</highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>populate<sp/>the<sp/>l2g<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(globalMesh.nElements_global):</highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>by<sp/>looping<sp/>over<sp/>element&apos;s<sp/>vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][0]<sp/>=<sp/>globalMesh.elementNodesArray[i][0]</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][1]<sp/>=<sp/>globalMesh.elementNodesArray[i][3]</highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][2]<sp/>=<sp/>globalMesh.elementNodesArray[i][2]</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][3]<sp/>=<sp/>globalMesh.elementNodesArray[i][1]</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"></highlight></codeline>
<codeline lineno="2446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][4]<sp/>=<sp/>globalMesh.elementBoundariesArray[i][3]+globalMesh.nNodes_global</highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][5]<sp/>=<sp/>globalMesh.elementBoundariesArray[i][2]+globalMesh.nNodes_global</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][6]<sp/>=<sp/>globalMesh.elementBoundariesArray[i][1]+globalMesh.nNodes_global</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][7]<sp/>=<sp/>globalMesh.elementBoundariesArray[i][0]+globalMesh.nNodes_global</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[i][len(globalMesh.elementNodesArray[i])<sp/>+<sp/>len(globalMesh.elementBoundariesArray[0])<sp/>]<sp/>=<sp/>globalMesh.nNodes_global<sp/>+<sp/>globalMesh.nElementBoundaries_global<sp/>+<sp/>i</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>subdomain2global<sp/>is<sp/>just<sp/>the<sp/>identity<sp/>mapping<sp/>in<sp/>the<sp/>serial<sp/>case</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>np.arange(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>dof_offsets_subdomain_owned</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ARB<sp/>-<sp/>the<sp/>next<sp/>argument<sp/>should<sp/>use<sp/>shape<sp/>not<sp/>len...something<sp/>is<sp/>being<sp/>fed<sp/>in<sp/>wrong<sp/>for<sp/>2D-Quads...Fix<sp/>before</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>final<sp/>merge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>numpy.zeros(len(globalMesh.nodeOffsets_subdomain_owned),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref>[1]<sp/>=<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref></highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref></highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>4</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a2b55961f53e5aa839b568343691f63ab" kindref="member">nd</ref>==3:</highlight></codeline>
<codeline lineno="2462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>numpy.zeros(globalMesh.nodeOffsets_subdomain_owned.shape,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref>,</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref>,</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref>)<sp/>=<sp/>cpartitioning.buildQuadraticCubeLocal2GlobalMappings(mpi_comm,</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a2b55961f53e5aa839b568343691f63ab" kindref="member">nd</ref>,</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.cmesh,</highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.subdomainMesh.cmesh,</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementBoundaryOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.edgeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.nodeNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementBoundaryNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.edgeNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref>,</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>,</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref>,</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap_1a8ecb689a4068169005096d83d56f28a6" kindref="member">lagrangeNodesArray</ref>)</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref><sp/>==<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref></highlight></codeline>
<codeline lineno="2484"><highlight class="normal"></highlight><highlight class="comment">#QuadraticDOFMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2485"><highlight class="normal"></highlight></codeline>
<codeline lineno="2486" refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" kindref="compound">QuadraticLagrangeDOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2488"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOF<sp/>mapping<sp/>for<sp/>quadratic<sp/>lagrange<sp/>finite<sp/>element<sp/>functions<sp/>on</highlight></codeline>
<codeline lineno="2489"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>unit<sp/>simplexes</highlight></codeline>
<codeline lineno="2490"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2491"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>mapping<sp/>associates<sp/>local<sp/>degree<sp/>of<sp/>freedom<sp/>with<sp/>global<sp/>vertex</highlight></codeline>
<codeline lineno="2492"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>number<sp/>for<sp/>iloc<sp/>0&lt;=<sp/>iloc&lt;=<sp/>space<sp/>dim<sp/>global<sp/>edge<sp/>number<sp/>for</highlight></codeline>
<codeline lineno="2493"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>spacedim<sp/>&lt;<sp/>iloc</highlight></codeline>
<codeline lineno="2494"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2495"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>total<sp/>dimension<sp/>is<sp/>number<sp/>of<sp/>vertices<sp/>+<sp/>number<sp/>of<sp/>edges</highlight></codeline>
<codeline lineno="2496"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>TODO<sp/>fix<sp/>lagrangeNodesArray<sp/>to<sp/>hold<sp/>all<sp/>the<sp/>nodes<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>parallel<sp/>in<sp/>3d<sp/>determine<sp/>if<sp/>really<sp/>need<sp/>to<sp/>call</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>updateAfterParallelPartitioning<sp/>after<sp/>__init__<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1a1d19f8bc81581b4c5397aea6963d2f52" kindref="member">__init__</ref>(self,mesh,localFunctionSpace,nd):</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>=<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElements_global</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>nd<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nElementBoundaries_global</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>+=<sp/>mesh.nEdges_global</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"></highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,ndof)</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#holds<sp/>lagrange<sp/>nodes<sp/>for<sp/>all<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1a5c65a09452dc7ae93bd4dcb450d2c918" kindref="member">lagrangeNodesArray</ref><sp/>=<sp/>numpy.zeros((ndof,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref><sp/>=<sp/>numpy.zeros((mesh.nElements_global,</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1aa98d2e62cd976a54f7a3a76daf283d10" kindref="member">nd</ref><sp/>=<sp/>nd</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#do<sp/>simplest<sp/>numbering<sp/>first,<sp/>which<sp/>is<sp/>to<sp/>assign<sp/>first<sp/>d+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#unknowns<sp/>the<sp/>corresponding<sp/>global<sp/>node<sp/>number.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>1d,<sp/>extra<sp/>unknown<sp/>can<sp/>be<sp/>associated<sp/>with<sp/>global<sp/>element<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>2d,<sp/>extra<sp/>unknowns<sp/>can<sp/>be<sp/>associated<sp/>with<sp/>element<sp/>boundaries<sp/>array<sp/>(edges)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#In<sp/>3d,<sp/>extra<sp/>unknowns<sp/>have<sp/>to<sp/>be<sp/>associated<sp/>with<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"></highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxSeen<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>.flat)</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>maxSeen<sp/>&lt;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>,(</highlight><highlight class="stringliteral">&apos;QuadDOF<sp/>max(l2g)=<sp/>%d<sp/>ndof=<sp/>%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(maxSeen,self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>))</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#save<sp/>for<sp/>parallel<sp/>mappings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1aa98d2e62cd976a54f7a3a76daf283d10" kindref="member">nd</ref><sp/>=<sp/>nd</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1af0e5e86feeafd178c621862d9caf333d" kindref="member">updateAfterParallelPartitioning</ref>(self,globalMesh):</highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2531"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fix<sp/>self.nDOF_all_processes,self.nDOF_subdomain,<sp/>self.max_dof_neighbors</highlight></codeline>
<codeline lineno="2532"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Comm</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpi_comm<sp/>=<sp/>Comm.get().comm.tompi4py()</highlight></codeline>
<codeline lineno="2535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>numpy.zeros(globalMesh.nodeOffsets_subdomain_owned.shape,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref>,self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref>,</highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref>)<sp/>=<sp/>cpartitioning.buildQuadraticLocal2GlobalMappings(mpi_comm,</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1aa98d2e62cd976a54f7a3a76daf283d10" kindref="member">nd</ref>,</highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.cmesh,</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.subdomainMesh.cmesh,</highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementBoundaryOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.edgeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.nodeNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementBoundaryNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.edgeNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref>,</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>,</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref>,</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap_1a5c65a09452dc7ae93bd4dcb450d2c918" kindref="member">lagrangeNodesArray</ref>)</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref><sp/>==<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref></highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/></highlight><highlight class="comment">#QuadraticDOFMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2557"><highlight class="normal"></highlight></codeline>
<codeline lineno="2558" refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap" kindref="compound">p0DOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap_1a49369885cd1b2a59529a9df114e7d094" kindref="member">__init__</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,mesh.nElements_global)</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>=numpy.zeros((mesh.nElements_global,1),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d326b73a702f6d859b66d60d549d6ac" kindref="member">updateAfterParallelPartitioning</ref>(mesh.globalMesh)</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>i<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>self.l2g[i,0]=i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap_1a4130f43ca5c27091c9e0d50e36401755" kindref="member">updateAfterParallelPartitioning</ref>(self,globalMesh):</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2567"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fix<sp/>self.nDOF_all_processes,self.nDOF_subdomain,<sp/>self.max_dof_neighbors</highlight></codeline>
<codeline lineno="2568"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Comm</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mpi_comm<sp/>=<sp/>Comm.get().comm.tompi4py()</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_dim<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref><sp/>=<sp/>numpy.zeros(globalMesh.nodeOffsets_subdomain_owned.shape,</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref><sp/>=<sp/>0;<sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a3489902b17b077946ed28dfb69d5e1ba" kindref="member">nDOF</ref>),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a26d5835315af3e3ba4bc05704ef09939" kindref="member">nDOF_all_processes</ref>,self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1acbf363a262f8d06082d197e502c3273e" kindref="member">nDOF_subdomain</ref>,</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a5d9aac8676bfcc12f4d0190d900896e1" kindref="member">max_dof_neighbors</ref>)<sp/>=<sp/>cpartitioning.buildDiscontinuousGalerkinLocal2GlobalMappings(mpi_comm,</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_dim,</highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.cmesh,</highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.subdomainMesh.cmesh,</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>globalMesh.elementNumbering_subdomain2global,</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a987c3bc72eba4f0dd453e69f52bf3f71" kindref="member">dof_offsets_subdomain_owned</ref>,</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>,</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1ae04d92a64afe74c974193a78b07d84b6" kindref="member">subdomain2global</ref>)</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"></highlight></codeline>
<codeline lineno="2586" refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap" kindref="compound">P1BubbleDOFMap</ref>(<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap" kindref="compound">DOFMap</ref>):</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2588"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOF<sp/>mapping<sp/>for<sp/>Lagrange<sp/>P1<sp/>+<sp/>bubble<sp/>finite<sp/>element<sp/>functions<sp/>on</highlight></codeline>
<codeline lineno="2589"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>unit<sp/>simplexes</highlight></codeline>
<codeline lineno="2590"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2591"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>mapping<sp/>associates<sp/>local<sp/>degree<sp/>of<sp/>freedom<sp/>with</highlight></codeline>
<codeline lineno="2592"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>global<sp/>vertex<sp/>number<sp/>for<sp/>iloc<sp/>0&lt;=<sp/>iloc&lt;=<sp/>space<sp/>dim</highlight></codeline>
<codeline lineno="2593"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>global<sp/>element<sp/>number<sp/>for<sp/><sp/>iloc<sp/>=<sp/>space<sp/>dim<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="2594"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2595"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>total<sp/>dimension<sp/>is<sp/>number<sp/>of<sp/>vertices<sp/>+<sp/>number<sp/>of<sp/>elements</highlight></codeline>
<codeline lineno="2596"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>TODO:<sp/>implement<sp/>for<sp/>parallel</highlight></codeline>
<codeline lineno="2597"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap_1a6ae0d6dadd05f620f54fd7c6f8d8234c" kindref="member">__init__</ref>(self,mesh,localFunctionSpace,nd):</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndof<sp/>=<sp/>mesh.nNodes_global<sp/>+<sp/>mesh.nElements_global</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>localFunctionSpace.dim<sp/>==<sp/>nd+2,<sp/></highlight><highlight class="stringliteral">&quot;P1<sp/>Bubble<sp/>space<sp/>only&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DOFMap.__init__(self,ndof)</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"></highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>adding<sp/>array<sp/>for<sp/>lagrange<sp/>nodes<sp/>of<sp/>quadratics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap_1abccb9603ac49b515f3f7d3aeecc717e4" kindref="member">lagrangeNodesArray</ref><sp/>=<sp/>numpy.zeros((ndof-mesh.nNodes_global,3),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref><sp/>=<sp/>numpy.zeros((mesh.nElements_global,</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#do<sp/>simplest<sp/>numbering<sp/>first,<sp/>which<sp/>is<sp/>to<sp/>assign<sp/>first<sp/>d+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#unknowns<sp/>the<sp/>corresponding<sp/>global<sp/>node<sp/>number.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#rest<sp/>of<sp/>unknowns<sp/>associated<sp/>with<sp/>global<sp/>element<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2611"><highlight class="normal"></highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[eN,:-1]<sp/>=<sp/>mesh.elementNodesArray[eN,:]</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[eN,-1]<sp/><sp/>=<sp/>mesh.nNodes_global<sp/>+<sp/>eN</highlight></codeline>
<codeline lineno="2615"><highlight class="normal"></highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap_1abccb9603ac49b515f3f7d3aeecc717e4" kindref="member">lagrangeNodesArray</ref>[self.<ref refid="d2/dd1/classproteus_1_1FemTools_1_1DOFMap_1a961adac21211c10778bc4e90205737ae" kindref="member">l2g</ref>[eN,-1]-mesh.nNodes_global,:]=mesh.elementBarycentersArray[eN]</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2618"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>P1<sp/>bubble<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2619"><highlight class="normal"></highlight></codeline>
<codeline lineno="2620"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2621"><highlight class="stringliteral">Mappings.</highlight></codeline>
<codeline lineno="2622"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2623"><highlight class="normal"></highlight></codeline>
<codeline lineno="2624" refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps" kindref="compound">ElementMaps</ref>(object):</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2626"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Base<sp/>class<sp/>for<sp/>a<sp/>set<sp/>of<sp/>real<sp/>number<sp/>vector<sp/>fields<sp/>that<sp/>map<sp/>a<sp/>reference</highlight></codeline>
<codeline lineno="2627"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>element<sp/>into<sp/>the<sp/>physical<sp/>domain.</highlight></codeline>
<codeline lineno="2628"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1aec6d51f7d08a300a212a038a3e982264" kindref="member">__init__</ref>(self,mesh):</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref><sp/>=<sp/>mesh</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a9755457df9e336596cbee2edaa544871" kindref="member">getBasisValuesRef</ref>(self,</highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2635"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>basis<sp/>of<sp/>the<sp/>map<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray,</highlight></codeline>
<codeline lineno="2636"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>given<sp/>on<sp/>the<sp/>reference<sp/>element.<sp/>Store<sp/>in<sp/>member<sp/>array<sp/>self.psi</highlight></codeline>
<codeline lineno="2637"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1aaf879c6002d3ef7f3e5a12a3ede73250" kindref="member">getValues</ref>(self,</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2643"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>set<sp/>of<sp/>nElements<sp/>maps<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray,</highlight></codeline>
<codeline lineno="2644"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>given<sp/>on<sp/>the<sp/>reference<sp/>element.</highlight></codeline>
<codeline lineno="2645"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a8892d65a33a2e019404f39e5fd5655fb" kindref="member">getBasisGradientValuesRef</ref>(self,</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2650"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>basis<sp/>gradients<sp/>of<sp/>the<sp/>map<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray.</highlight></codeline>
<codeline lineno="2651"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Store<sp/>in<sp/>member<sp/>self.grad_psi</highlight></codeline>
<codeline lineno="2652"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a80fc81d914261cc44342c906fbd65baf" kindref="member">getJacobianValues</ref>(self,</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray,</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray,</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray):</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2660"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>jacobian,<sp/>jacobian<sp/>determinant,<sp/>and<sp/>inverse<sp/>jacobian</highlight></codeline>
<codeline lineno="2661"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>the<sp/>set<sp/>of<sp/>nElements<sp/>maps<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray.</highlight></codeline>
<codeline lineno="2662"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a532ed65fc9cd92f882c7b775cd2877a8" kindref="member">getInverseValues</ref>(self,</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray,</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2669"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>set<sp/>of<sp/>nElements<sp/>inverse<sp/>maps<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xArray,</highlight></codeline>
<codeline lineno="2670"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>given<sp/>on<sp/>the<sp/>physical<sp/>elements.<sp/>Return<sp/>the<sp/>value<sp/>of<sp/>the<sp/>inverse<sp/>map.</highlight></codeline>
<codeline lineno="2671"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a5bff169d8c1881951f04a9f562554951" kindref="member">getInverseValue</ref>(self,</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN,</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x):</highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2677"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>element<sp/>inverse<sp/>map<sp/>at<sp/>a<sp/>point,<sp/>x,</highlight></codeline>
<codeline lineno="2678"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>given<sp/>in<sp/>physical<sp/>coorindates.<sp/>Return<sp/>the<sp/>value<sp/>of<sp/>the<sp/>inverse<sp/>map,<sp/>xi,<sp/>in<sp/>reference<sp/>coordinates.</highlight></codeline>
<codeline lineno="2679"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2680"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note:<sp/>The<sp/>mapped<sp/>point<sp/>may<sp/>not<sp/>lie<sp/>on<sp/>the<sp/>reference<sp/><sp/>element</highlight></codeline>
<codeline lineno="2681"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a94a2bf58c4de6183a69248a5bafa2c4b" kindref="member">getBasisValuesTraceRef</ref>(self,</highlight></codeline>
<codeline lineno="2684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2686"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>basis<sp/>of<sp/>the<sp/>maps<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray,<sp/>on</highlight></codeline>
<codeline lineno="2687"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>boundaries<sp/>of<sp/>the<sp/>reference<sp/>element.<sp/>Store<sp/>in<sp/>member</highlight></codeline>
<codeline lineno="2688"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi_trace</highlight></codeline>
<codeline lineno="2689"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a1157f4f291996c16613a334360c4ff21" kindref="member">getValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2695"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>nElements<sp/>x<sp/>nElementBoundaries_element<sp/>maps</highlight></codeline>
<codeline lineno="2696"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray,<sp/>on<sp/>the<sp/>element<sp/>boundary</highlight></codeline>
<codeline lineno="2697"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reference<sp/>element.</highlight></codeline>
<codeline lineno="2698"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1affd551e098f61ac8b4883d24ba216468" kindref="member">getJacobianValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2707"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>metric<sp/>tensor,<sp/>square<sp/>root<sp/>of<sp/>the<sp/>determinant<sp/>of</highlight></codeline>
<codeline lineno="2708"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>metric<sp/>tensor,<sp/>and<sp/>the<sp/>unit<sp/>normal<sp/>at<sp/>the</highlight></codeline>
<codeline lineno="2709"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nElements<sp/>x<sp/>nElementBoundaries_element<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="2710"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a227de325eab5bd3758dc77cfde96be34" kindref="member">getBasisGradientValuesTraceRef</ref>(self,</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2715"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>basis<sp/>gradients<sp/>of<sp/>the<sp/>map<sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,</highlight></codeline>
<codeline lineno="2716"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,<sp/>on<sp/>the<sp/>reference<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="2717"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2719"><highlight class="normal"></highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a5e7bcb2532f6154873325742df3fd874" kindref="member">getJacobianValuesTrace_movingDomain</ref>(self,</highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xt,</highlight></codeline>
<codeline lineno="2723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2728"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>metric<sp/>tensor,<sp/>square<sp/>root<sp/>of<sp/>the<sp/>determinant<sp/>of</highlight></codeline>
<codeline lineno="2729"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>metric<sp/>tensor,<sp/>and<sp/>the<sp/>unit<sp/>normal<sp/>at<sp/>the</highlight></codeline>
<codeline lineno="2730"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nElements<sp/>x<sp/>nElementBoundaries_element<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="2731"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2733"><highlight class="normal"></highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a64993400447efce280f71b3ef890f2d4" kindref="member">getValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2738"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>nExteriorElementBoundaries_global<sp/>maps</highlight></codeline>
<codeline lineno="2739"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>at<sp/>a<sp/>set<sp/>of<sp/>points,<sp/>xiArray,<sp/>on<sp/>the<sp/>element<sp/>boundary</highlight></codeline>
<codeline lineno="2740"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reference<sp/>element.</highlight></codeline>
<codeline lineno="2741"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2743"><highlight class="normal"></highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a6ca2577ef5d7815ebef18da76077e449" kindref="member">getJacobianValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2751"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>metric<sp/>tensor,<sp/>square<sp/>root<sp/>of<sp/>the<sp/>determinant<sp/>of</highlight></codeline>
<codeline lineno="2752"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>metric<sp/>tensor,<sp/>and<sp/>the<sp/>unit<sp/>normal<sp/>at<sp/>the</highlight></codeline>
<codeline lineno="2753"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nExteriorElementBoundaries_global<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="2754"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a77539185049c64450ce395aa65954c0f" kindref="member">getJacobianValuesGlobalExteriorTrace_movingDomain</ref>(self,</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xt,</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2764"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluate<sp/>the<sp/>metric<sp/>tensor,<sp/>square<sp/>root<sp/>of<sp/>the<sp/>determinant<sp/>of</highlight></codeline>
<codeline lineno="2765"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>metric<sp/>tensor,<sp/>and<sp/>the<sp/>unit<sp/>normal<sp/>at<sp/>the</highlight></codeline>
<codeline lineno="2766"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nExteriorElementBoundaries_global<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="2767"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2769" refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">ParametricMaps(ElementMaps):</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>that<sp/>calculates<sp/>the<sp/>element<sp/>maps<sp/>using<sp/>the</highlight></codeline>
<codeline lineno="2772"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>nodes<sp/>of<sp/>a<sp/>mesh<sp/>as<sp/>the<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>a<sp/>local<sp/>function<sp/>space</highlight></codeline>
<codeline lineno="2773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>for<sp/>which<sp/>the<sp/>nodes<sp/>are<sp/>the<sp/>local<sp/>DOF.</highlight></codeline>
<codeline lineno="2774"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ac92f2a7de1dd7173b386fd5cb7af22f7" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh,</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement,</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace):</highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ElementMaps.__init__(self,mesh)</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh<sp/>=<sp/>mesh</highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement<sp/>=<sp/>referenceElement</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace<sp/>=<sp/>localFunctionSpace</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap=NodalDOFMap(mesh)</highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.useC=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a3c3097fde0e3b7289400337f423cd118" kindref="member">getBasisValuesIP</ref>(self,<sp/>interpolationPoints):</highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>interpolationPoints.shape[0]</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi_ip<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi_ip[k,j]<sp/>=<sp/>self.localFunctionSpace.basis[j](interpolationPoints[k])</highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.psi_ip</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a1bc4f7606767a031f62f3c1bdab7b61a" kindref="member">getBasisValuesRef</ref>(self,xiArray):</highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi[k,j]<sp/>=<sp/>self.localFunctionSpace.basis[j](xiArray[k])</highlight></codeline>
<codeline lineno="2804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.psi</highlight></codeline>
<codeline lineno="2805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ada84bb50d130f03da596b6ce5805ed93" kindref="member">getValues</ref>(self,xiArray,</highlight></codeline>
<codeline lineno="2806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="2807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="2811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[k,j]<sp/>=<sp/>self.localFunctionSpace.basis[j](xiArray[k])</highlight></codeline>
<codeline lineno="2816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getValues(psi,</highlight></codeline>
<codeline lineno="2818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="2819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="2820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray)</highlight></codeline>
<codeline lineno="2821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nElements_global):</highlight></codeline>
<codeline lineno="2823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="2826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray[eN,k,m]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*psi[k,j]</highlight></codeline>
<codeline lineno="2828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a95a3cfe16228702ec6ce0ba9cca00941" kindref="member">getBasisGradientValuesRef</ref>(self,xiArray):</highlight></codeline>
<codeline lineno="2829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.grad_psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.grad_psi[k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiArray[k])</highlight></codeline>
<codeline lineno="2838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.grad_psi</highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad45673fd800f869b8004d47daf3ad6ac" kindref="member">getJacobianValues</ref>(self,xiArray,</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray,</highlight></codeline>
<codeline lineno="2841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray):</highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="2847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="2848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiArray[k])</highlight></codeline>
<codeline lineno="2853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getJacobianValues(grad_psi,</highlight></codeline>
<codeline lineno="2855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="2856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="2857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray,</highlight></codeline>
<codeline lineno="2858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray,</highlight></codeline>
<codeline lineno="2859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray)</highlight></codeline>
<codeline lineno="2860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nElements_global):</highlight></codeline>
<codeline lineno="2862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray[eN,k,m,n]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*grad_psi[k,j,n]</highlight></codeline>
<codeline lineno="2868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray[eN,k]<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a68664b4ba44a1030f75c7df580559e88" kindref="member">det</ref>(jacobianArray[eN,k])</highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray[eN,k,:,:]<sp/>=<sp/>old_div(<ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a4ac8e63c3d63243fd312f3f888520389" kindref="member">adj</ref>(jacobianArray[eN,k]),jacobianDeterminantArray[eN,k])</highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad9ad3a653e3c4732023d12e61d292820" kindref="member">getBasisValuesTraceRef</ref>(self,</highlight></codeline>
<codeline lineno="2871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi_trace<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#psi[ebN,k,j]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>self.localFunctionSpace.basisTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.psi_trace[ebN,k,j]<sp/>=<sp/>self.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="2886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.psi_trace</highlight></codeline>
<codeline lineno="2887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a050cc213204a1be2e2587ffc1d7ab91f" kindref="member">getValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="2888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="2890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="2896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#psi[ebN,k,j]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>self.localFunctionSpace.basisTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="2904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[ebN,k,j]<sp/>=<sp/>self.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="2905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getValuesTrace(psi,self.meshDOFMap.l2g,self.mesh.nodeArray,xArray)</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nElements_global):</highlight></codeline>
<codeline lineno="2909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="2913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray[eN,ebN,k,m]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*psi[ebN,k,j]</highlight></codeline>
<codeline lineno="2915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ab14ce8482b72caaf88ab0966500ae089" kindref="member">getBasisGradientValuesTraceRef</ref>(self,</highlight></codeline>
<codeline lineno="2916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.grad_psi_trace<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.boundaryNormals<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.boundaryJacobians<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim,</highlight></codeline>
<codeline lineno="2931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.grad_psi_trace[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.boundaryNormals[ebN,k,:]<sp/>=<sp/>self.referenceElement.boundaryUnitNormalList[ebN]</highlight><highlight class="comment">#planar<sp/>faces<sp/>in<sp/>physical<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.boundaryJacobians[ebN,k,:,:]<sp/>=<sp/>self.referenceElement.boundaryJacobianList[ebN]</highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.grad_psi_trace</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1afd98021853c8a43690f6cc8fb7f0ba91" kindref="member">getJacobianValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="2945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="2962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals<sp/>=<sp/>numpy.array(self.referenceElement.boundaryUnitNormalList)</highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians<sp/>=<sp/>numpy.array(self.referenceElement.boundaryJacobianList)</highlight></codeline>
<codeline lineno="2968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getJacobianValuesTrace(grad_psi,</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals,</highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians,</highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="2982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="2983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray)</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nElements_global):</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="2991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[:]=0.0</highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian[m,n]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*grad_psi[ebN,k,j,n]</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray[eN,ebN,k,:,:]<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(elementMappingJacobian)</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[eN,ebN,k,:]<sp/>=<sp/>self.referenceElement.boundaryUnitNormalList[ebN]</highlight></codeline>
<codeline lineno="3000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray[eN,ebN,k,0,0]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray[eN,ebN,k]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="3002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[:]=0.0</highlight></codeline>
<codeline lineno="3008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian[m,n]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*grad_psi[ebN,k,j,n]</highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray[eN,ebN,k,:,:]<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(elementMappingJacobian)</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#unit<sp/>normal<sp/>=<sp/>J^{-t}<sp/>\hat{n}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[eN,ebN,k,m]<sp/>+=<sp/>jacobianInverseArray[eN,ebN,k,n,m]*self.referenceElement.boundaryUnitNormalList[ebN][n]</highlight></codeline>
<codeline lineno="3018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[eN,ebN,k]/=<ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a344fe259680891d4a7b7e5ba89ed10e4" kindref="member">norm</ref>(unitNormalArray[eN,ebN,k])</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#metric<sp/>tensor<sp/>and<sp/>determinant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[m,p]<sp/>+=<sp/>elementMappingJacobian[m,n]*self.referenceElement.boundaryJacobianList[ebN][n,p]</highlight></codeline>
<codeline lineno="3024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>q<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray[eN,ebN,k,p,q]<sp/>+=<sp/>elementBoundaryMappingJacobian[m,p]*elementBoundaryMappingJacobian[m,q]</highlight></codeline>
<codeline lineno="3028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray[eN,ebN,k]<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(<ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a68664b4ba44a1030f75c7df580559e88" kindref="member">det</ref>(metricTensorArray[eN,ebN,k]))</highlight></codeline>
<codeline lineno="3029"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a8936d23762925db284e2b8d3afa80fde" kindref="member">getJacobianValuesTrace_movingDomain</ref>(self,</highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xt,</highlight></codeline>
<codeline lineno="3032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="3036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals<sp/>=<sp/>numpy.array(self.referenceElement.boundaryUnitNormalList)</highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians<sp/>=<sp/>numpy.array(self.referenceElement.boundaryJacobianList)</highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getJacobianValuesTrace_movingDomain(xt,</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi,</highlight></codeline>
<codeline lineno="3064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals,</highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians,</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="3067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="3068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray)</highlight></codeline>
<codeline lineno="3072"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1af9827a6b67264c63303ff509231788de" kindref="member">getPermutations</ref>(self,xiArray):</highlight></codeline>
<codeline lineno="3073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>todo,<sp/>figure<sp/>out<sp/>how<sp/>to<sp/>get<sp/>the<sp/>permutations<sp/>without<sp/>staring<sp/>any<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.permutations<sp/>=<sp/>numpy.zeros(xiArray.shape[:-1],</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getPermutations(xiArray,self.permutations)</highlight></codeline>
<codeline lineno="3076"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1abf5922781ec9701bdab406990a9a2c60" kindref="member">getValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="3077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray):</highlight></codeline>
<codeline lineno="3079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3080"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>treat<sp/>this<sp/>like<sp/>element<sp/>boundary<sp/>version<sp/>but<sp/>only<sp/>store<sp/>values<sp/>on<sp/>exterior<sp/>elements</highlight></codeline>
<codeline lineno="3081"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#psi[ebN,k,j]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>self.localFunctionSpace.basisTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[ebN,k,j]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>self.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getValuesGlobalExteriorTrace(self.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi,</highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray)</highlight></codeline>
<codeline lineno="3104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray[ebNE,k,m]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*psi[ebN_local,k,j]</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a2ab2e84f21c002402fc392f1e01c6138" kindref="member">getJacobianValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3121"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>treat<sp/>this<sp/>like<sp/>element<sp/>boundary<sp/>version<sp/>but<sp/>only<sp/>store<sp/>values<sp/>on<sp/>exterior<sp/>elements</highlight></codeline>
<codeline lineno="3122"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3123"><highlight class="normal"></highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="3139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals<sp/>=<sp/>numpy.array(self.referenceElement.boundaryUnitNormalList)</highlight></codeline>
<codeline lineno="3141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians<sp/>=<sp/>numpy.array(self.referenceElement.boundaryJacobianList)</highlight></codeline>
<codeline lineno="3142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.useC<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getJacobianValuesGlobalExteriorTrace(self.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi,</highlight></codeline>
<codeline lineno="3155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals,</highlight></codeline>
<codeline lineno="3156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians,</highlight></codeline>
<codeline lineno="3157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="3159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray)</highlight></codeline>
<codeline lineno="3163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="3165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[:]=0.0</highlight></codeline>
<codeline lineno="3172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="3174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian[m,n]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*grad_psi[ebN_local,k,j,n]</highlight></codeline>
<codeline lineno="3177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray[ebNE,k,:,:]<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(elementMappingJacobian)</highlight></codeline>
<codeline lineno="3178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[ebNE,k,:]<sp/>=<sp/>self.referenceElement.boundaryUnitNormalList[ebN_local]</highlight></codeline>
<codeline lineno="3179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray[ebNE,k,0,0]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="3180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray[ebN,k]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="3181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[:]=0.0</highlight></codeline>
<codeline lineno="3189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.meshDOFMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="3191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian[m,n]<sp/>+=<sp/>self.mesh.nodeArray[J,m]*grad_psi[ebN_local,k,j,n]</highlight></codeline>
<codeline lineno="3194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray[ebNE,k,:,:]<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(elementMappingJacobian)</highlight></codeline>
<codeline lineno="3195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#unit<sp/>normal<sp/>=<sp/>J^{-t}<sp/>\hat{n}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[ebNE,k,m]<sp/>+=<sp/>jacobianInverseArray[ebN,k,n,m]*self.referenceElement.boundaryUnitNormalList[ebN_local][n]</highlight></codeline>
<codeline lineno="3199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray[ebNE,k]/=<ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a344fe259680891d4a7b7e5ba89ed10e4" kindref="member">norm</ref>(unitNormalArray[ebN,k])</highlight></codeline>
<codeline lineno="3200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#metric<sp/>tensor<sp/>and<sp/>determinant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian[m,p]<sp/>+=<sp/>elementMappingJacobian[m,n]*self.referenceElement.boundaryJacobianList[ebN_local][n,p]</highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>q<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.referenceElement.dim-1):</highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray[ebNE,k,p,q]<sp/>+=<sp/>elementBoundaryMappingJacobian[m,p]*elementBoundaryMappingJacobian[m,q]</highlight></codeline>
<codeline lineno="3209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray[ebNE,k]<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(<ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a68664b4ba44a1030f75c7df580559e88" kindref="member">det</ref>(metricTensorArray[ebNE,k]))</highlight></codeline>
<codeline lineno="3210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#ebNE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#else<sp/>dim</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#else<sp/>C</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a541b262b8fd9f3c94bfb8953e2f3ff90" kindref="member">getJacobianValuesGlobalExteriorTrace_movingDomain</ref>(self,</highlight></codeline>
<codeline lineno="3216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xt,</highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray):</highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>treat<sp/>this<sp/>like<sp/>element<sp/>boundary<sp/>version<sp/>but<sp/>only<sp/>store<sp/>values<sp/>on<sp/>exterior<sp/>elements</highlight></codeline>
<codeline lineno="3224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3225"><highlight class="normal"></highlight></codeline>
<codeline lineno="3226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim),</highlight></codeline>
<codeline lineno="3238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryMappingJacobian<sp/>=<sp/>numpy.zeros((self.referenceElement.dim,</highlight></codeline>
<codeline lineno="3240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="3241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals<sp/>=<sp/>numpy.array(self.referenceElement.boundaryUnitNormalList)</highlight></codeline>
<codeline lineno="3243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians<sp/>=<sp/>numpy.array(self.referenceElement.boundaryJacobianList)</highlight></codeline>
<codeline lineno="3244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN,k,j,:]<sp/>=<sp/>self.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getJacobianValuesGlobalExteriorTrace_movingDomain(self.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xt,</highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi,</highlight></codeline>
<codeline lineno="3257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryNormals,</highlight></codeline>
<codeline lineno="3258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundaryJacobians,</highlight></codeline>
<codeline lineno="3259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meshDOFMap.l2g,</highlight></codeline>
<codeline lineno="3260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.mesh.nodeArray,</highlight></codeline>
<codeline lineno="3261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray,</highlight></codeline>
<codeline lineno="3262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray,</highlight></codeline>
<codeline lineno="3263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray,</highlight></codeline>
<codeline lineno="3264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray)</highlight></codeline>
<codeline lineno="3265" refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" kindref="compound">ParametricMaps</ref>):</highlight></codeline>
<codeline lineno="3266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps_1af996bff37a65726891b4b92083c7dda3" kindref="member">__init__</ref>(self,mesh,referenceElement,localFunctionSpace):</highlight></codeline>
<codeline lineno="3267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricMaps.__init__(self,mesh,referenceElement,localFunctionSpace)</highlight></codeline>
<codeline lineno="3268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad30685629abda2a7ff21a57eeed13742" kindref="member">useC</ref>=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps_1a9f7bd40afdf41431fdcaf49300ec6d2f" kindref="member">getInverseValues</ref>(self,</highlight></codeline>
<codeline lineno="3270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian,</highlight></codeline>
<codeline lineno="3271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray,</highlight></codeline>
<codeline lineno="3272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad30685629abda2a7ff21a57eeed13742" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getInverseValues(inverseJacobian,self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g,self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray,xArray,xiArray)</highlight></codeline>
<codeline lineno="3275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>I<sp/>don&apos;t<sp/>think<sp/>this<sp/>code<sp/>works<sp/>correctly<sp/>when<sp/>self.useC<sp/>==<sp/>False...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_x<sp/>=<sp/>xArray.shape[1]</highlight></codeline>
<codeline lineno="3279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_nx<sp/>=<sp/>list(range(n_x))</highlight></codeline>
<codeline lineno="3280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.dim,</highlight></codeline>
<codeline lineno="3281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[j,:]<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.basisGradients[j](xiArray[0])</highlight></codeline>
<codeline lineno="3293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nElements_global):</highlight></codeline>
<codeline lineno="3294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="3298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian[m,n]<sp/>+=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]*grad_psi[j,n]</highlight></codeline>
<codeline lineno="3301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,0]</highlight></codeline>
<codeline lineno="3302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(jacobian)</highlight></codeline>
<codeline lineno="3303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_nx:</highlight></codeline>
<codeline lineno="3304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[:]=xArray[eN,k]</highlight></codeline>
<codeline lineno="3305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[m]-=self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]</highlight></codeline>
<codeline lineno="3307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray[eN,k,m]<sp/>+=<sp/>inverseJacobian[m,n]*dx[n]</highlight></codeline>
<codeline lineno="3310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps_1adc723941be75c314889aa6da21abf419" kindref="member">getInverseValue</ref>(self,</highlight></codeline>
<codeline lineno="3311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN,</highlight></codeline>
<codeline lineno="3312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x):</highlight></codeline>
<codeline lineno="3313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi=numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.dim,</highlight></codeline>
<codeline lineno="3315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[j,:]<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.basisGradients[j](xi)</highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian[m,n]<sp/>+=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]*grad_psi[j,n]</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,0]</highlight></codeline>
<codeline lineno="3335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(jacobian)</highlight></codeline>
<codeline lineno="3336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[m]=x[m]</highlight></codeline>
<codeline lineno="3338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[m]-=self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]</highlight></codeline>
<codeline lineno="3340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi[m]<sp/>+=<sp/>inverseJacobian[m,n]*dx[n]</highlight></codeline>
<codeline lineno="3343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>xi</highlight></codeline>
<codeline lineno="3344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps_1ad83eae2b09792e025bf1b5fabdbeef6d" kindref="member">getInverseValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="3345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian,</highlight></codeline>
<codeline lineno="3346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray,</highlight></codeline>
<codeline lineno="3347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad30685629abda2a7ff21a57eeed13742" kindref="member">useC</ref>:</highlight></codeline>
<codeline lineno="3349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getInverseValuesTrace(inverseJacobian,self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g,self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray,xArray,xiArray)</highlight></codeline>
<codeline lineno="3350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_x<sp/>=<sp/>xArray.shape[2]</highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_nx<sp/>=<sp/>list(range(n_x))</highlight></codeline>
<codeline lineno="3354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.dim,</highlight></codeline>
<codeline lineno="3355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[j,:]<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.basisGradients[j](xiArray[0])</highlight></codeline>
<codeline lineno="3367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nElements_global):</highlight></codeline>
<codeline lineno="3368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="3372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian[m,n]<sp/>+=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]*grad_psi[j,n]</highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,0]</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(jacobian)</highlight></codeline>
<codeline lineno="3377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nElementBoundaries_element):</highlight></codeline>
<codeline lineno="3378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_nx:</highlight></codeline>
<codeline lineno="3379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[:]=xArray[eN,ebN,k,:self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim]</highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[m]-=self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]</highlight></codeline>
<codeline lineno="3382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray[eN,ebN,k,m]<sp/>+=<sp/>inverseJacobian[m,n]*dx[n]</highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps_1a7a233ff32271ceb7a47776e7685149cb" kindref="member">getInverseValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="3386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian,</highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray,</highlight></codeline>
<codeline lineno="3388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1ad30685629abda2a7ff21a57eeed13742" kindref="member">useC</ref>:</highlight></codeline>
<codeline lineno="3390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricMaps_getInverseValuesGlobalExteriorTrace(self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian,self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g,</highlight></codeline>
<codeline lineno="3394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray,xArray,xiArray)</highlight></codeline>
<codeline lineno="3395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_x<sp/>=<sp/>xArray.shape[1]</highlight></codeline>
<codeline lineno="3398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_nx<sp/>=<sp/>list(range(n_x))</highlight></codeline>
<codeline lineno="3399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.dim,</highlight></codeline>
<codeline lineno="3400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/>numpy.zeros((self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim,</highlight></codeline>
<codeline lineno="3408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim),</highlight></codeline>
<codeline lineno="3409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[j,:]<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.basisGradients[j](xiArray[0])</highlight></codeline>
<codeline lineno="3412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nExteriorElements_global):</highlight></codeline>
<codeline lineno="3413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian.flat[:]=0.0</highlight></codeline>
<codeline lineno="3418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a952e708a7650eaeb7d73091f1ea7f5a4" kindref="member">localFunctionSpace</ref>.range_dim:</highlight></codeline>
<codeline lineno="3419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="3420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobian[m,n]<sp/>+=<sp/>self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]*grad_psi[j,n]</highlight></codeline>
<codeline lineno="3423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a021d2cf3d55e51943063f247eaf4ae22" kindref="member">meshDOFMap</ref>.l2g[eN,0]</highlight></codeline>
<codeline lineno="3424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobian<sp/>=<sp/><ref refid="d8/dd9/namespaceproteus_1_1EGeometry_1a0dd8c1ffd4840aeda7baf869d448a3d7" kindref="member">inv</ref>(jacobian)</highlight></codeline>
<codeline lineno="3425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_nx:</highlight></codeline>
<codeline lineno="3426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[:]=xArray[ebNE,k,:self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.dim]</highlight></codeline>
<codeline lineno="3427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx[m]-=self.<ref refid="d5/dc9/classproteus_1_1FemTools_1_1ElementMaps_1a89485035d1b05f9e6649c3f5eca410df" kindref="member">mesh</ref>.nodeArray[J,m]</highlight></codeline>
<codeline lineno="3429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps_1a7e8daf0c047445f523bebfbe2eea1cef" kindref="member">referenceElement</ref>.range_dim:</highlight></codeline>
<codeline lineno="3431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray[ebNE,k,m]<sp/>+=<sp/>inverseJacobian[m,n]*dx[n]</highlight></codeline>
<codeline lineno="3432"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3433"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>Function<sp/>Spaces<sp/>iso-(diffeo-)morphic<sp/>to<sp/>reference<sp/>spaces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3434"><highlight class="normal"></highlight></codeline>
<codeline lineno="3435"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>Arguments<sp/>will<sp/>still<sp/>be<sp/>in<sp/>reference<sp/>space<sp/>(xi),<sp/>but</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3436"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>gradients<sp/>will<sp/>be<sp/>in<sp/>physical<sp/>space<sp/>(grad<sp/>=<sp/>grad_x).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3437"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3438"><highlight class="normal"></highlight></codeline>
<codeline lineno="3439"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>class<sp/>MappedSpace(LocalFunctionSpace):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3440"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3441"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>psi(x)<sp/>=<sp/>psi_r<sp/>(<sp/>xi(x))<sp/>=<sp/>psi_r(xi)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3442"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>grad_x<sp/>psi(xi)<sp/>=<sp/>J^{-t}(xi)<sp/>grad_{xi}<sp/>psi(xi)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3443"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3444"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>__init__(self,referenceSpace,map,nd=3):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3445"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3446"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace<sp/>=<sp/>referenceSpace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3447"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.map<sp/>=<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3448"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dim=nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3449"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis<sp/>=<sp/>self.referenceSpace.basis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3450"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3451"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>xi:<sp/>etenvec(self.map.getInverseJacobianTranspose(xi),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3452"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.basisGradients[0](xi)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3453"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3454"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>xi:<sp/>etenvec(self.map.getInverseJacobianTranspose(xi),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3455"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.basisGradients[1](xi)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3456"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>nd<sp/>&gt;<sp/>1:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3457"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3458"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>xi:<sp/>etenvec(self.map.getInverseJacobianTranspose(xi),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3459"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.basisGradients[2](xi)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3460"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>nd<sp/>&gt;<sp/>2:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3461"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3462"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>xi:<sp/>etenvec(self.map.getInverseJacobianTranpose(xi),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3463"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.basisGradients[3](xi)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3464"><highlight class="normal"></highlight></codeline>
<codeline lineno="3465"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>class<sp/>AffineMappedSpace(LocalFunctionSpace):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3466"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3467"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>M<sp/>xi<sp/>+<sp/>b</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3468"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>psi(x)<sp/>=<sp/>psi_r(xi)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3469"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>grad_x<sp/>psi<sp/>=<sp/>M^{-t}<sp/>grad_{xi}<sp/>(constant<sp/>w.r.t.<sp/>xi<sp/>or<sp/>x</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3470"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>so<sp/>we<sp/>provide<sp/>updateGradients<sp/>to<sp/>do<sp/>this<sp/>whenever<sp/>map<sp/>changes)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3471"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3472"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>__init__(self,referenceSpace,affineMap,nd=3):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3473"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LocalFunctionSpace.__init__(self)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3474"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace<sp/>=<sp/>referenceSpace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3475"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.map<sp/>=<sp/>affineMap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3476"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dim=nd+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3477"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basis<sp/>=<sp/>self.referenceSpace.basis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3478"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisOnMappedDomain=[]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3479"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisOnMappedDomain.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3480"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>x:<sp/>self.basis[0](self.map.getInverseValue(x)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3481"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList=[]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3482"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3483"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>etenvec(self.map.getInverseJacobianTranspose(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3484"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.gradientList[0]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3485"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(lambda<sp/>xi:<sp/>self.gradientList[0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3486"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisOnMappedDomain.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3487"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>x:<sp/>self.basis[1](self.map.getInverseValue(x)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3488"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3489"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>etenvec(self.map.getInverseJacobianTranspose(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3490"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.gradientList[1]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3491"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(lambda<sp/>xi:<sp/>self.gradientList[1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3492"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>nd<sp/>&gt;<sp/>1:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3493"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisOnMappedDomain.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3494"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>x:<sp/>self.basis[2](self.map.getInverseValue(x)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3495"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3496"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>etenvec(self.map.getInverseJacobianTranspose(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3497"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.gradientList[2]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3498"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(lambda<sp/>xi:<sp/>self.gradientList[2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3499"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>nd<sp/>&gt;<sp/>2:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3500"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisOnMappedDomain.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3501"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lambda<sp/>x:<sp/>self.basis[3](self.map.getInverseValue(x)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3502"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList.append(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3503"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>etenvec(self.map.getInverseJacobianTranspose(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3504"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.gradientList[3]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3505"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.basisGradients.append(lambda<sp/>xi:<sp/>self.gradientList[3])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3506"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>updateGradients():</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3507"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>i<sp/>in<sp/>range(self.dim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3508"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.gradientList[i]=etenvec(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3509"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.map.getInverseJacobianTranspose(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3510"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.referenceSpace.gradientList[i])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3511"><highlight class="normal"></highlight></codeline>
<codeline lineno="3512"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3513"><highlight class="stringliteral">Finite<sp/>Element<sp/>Spaces</highlight></codeline>
<codeline lineno="3514"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3515"><highlight class="normal"></highlight></codeline>
<codeline lineno="3516" refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>(object):</highlight></codeline>
<codeline lineno="3517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3518"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Base<sp/>class<sp/>for<sp/>spaces<sp/>of<sp/>functions<sp/>defined<sp/>by<sp/>a<sp/>set<sp/>of<sp/>finite</highlight></codeline>
<codeline lineno="3519"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>elements<sp/>that<sp/>are<sp/>each<sp/>related<sp/>to<sp/>the<sp/>same<sp/>reference<sp/>finite<sp/>element.</highlight></codeline>
<codeline lineno="3520"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="3521"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>dim<sp/>--<sp/>global<sp/>dimension<sp/>of<sp/>the<sp/>space</highlight></codeline>
<codeline lineno="3522"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>mesh<sp/>--<sp/>a<sp/>Mesh<sp/>object,<sp/>which<sp/>is<sp/>a<sp/>partition<sp/>of<sp/>the<sp/>domain</highlight></codeline>
<codeline lineno="3523"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>finiteElements<sp/>--<sp/>a<sp/>dictionary<sp/>of<sp/>the<sp/>FiniteElement<sp/>objects</highlight></codeline>
<codeline lineno="3524"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>indexed<sp/>by<sp/>element<sp/>number</highlight></codeline>
<codeline lineno="3525"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>dofMap<sp/>--<sp/>a<sp/>DOF</highlight></codeline>
<codeline lineno="3526"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a5672f2b0ca39776044ae03ffbe9a0083" kindref="member">__init__</ref>(self,<sp/>referenceFiniteElement,<sp/>elementMaps,<sp/>dofMap):</highlight></codeline>
<codeline lineno="3528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a8ace1789e7f42895a7b42b57fd14467b" kindref="member">dim</ref>=dofMap.nDOF</highlight></codeline>
<codeline lineno="3530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7b630929af11d8d753bc923ff38254a3" kindref="member">range_dim</ref><sp/>=<sp/>list(range(dofMap.nDOF))</highlight></codeline>
<codeline lineno="3531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>=referenceFiniteElement</highlight></codeline>
<codeline lineno="3532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref><sp/>=<sp/>elementMaps</highlight></codeline>
<codeline lineno="3533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref><sp/>=<sp/>elementMaps.mesh</highlight></codeline>
<codeline lineno="3534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>=<sp/>referenceFiniteElement.referenceElement.dim</highlight></codeline>
<codeline lineno="3535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>=dofMap</highlight></codeline>
<codeline lineno="3536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a32768f3e273dea9d449a7f719068ceee" kindref="member">max_nDOF_element</ref><sp/>=<sp/>referenceFiniteElement.localFunctionSpace.dim</highlight></codeline>
<codeline lineno="3537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad97f4cb48480089322daf1cd7c323aa5" kindref="member">interpolationPoints</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global,</highlight></codeline>
<codeline lineno="3538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.interpolationConditions.nQuadraturePoints,</highlight></codeline>
<codeline lineno="3539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3),</highlight></codeline>
<codeline lineno="3540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aec622678672f1db1acc85e82687440f8" kindref="member">updateInterpolationPoints</ref>()</highlight></codeline>
<codeline lineno="3542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>=0</highlight></codeline>
<codeline lineno="3543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref>=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aa7db983ca3452bc0325d482d5f2dd2c8" kindref="member">getBasisValuesRef</ref>(self,xiArray):</highlight></codeline>
<codeline lineno="3546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a257a0751992f8db91653854beb5d7145" kindref="member">psi</ref><sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a257a0751992f8db91653854beb5d7145" kindref="member">psi</ref>[k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiArray[k])</highlight></codeline>
<codeline lineno="3554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a257a0751992f8db91653854beb5d7145" kindref="member">psi</ref></highlight></codeline>
<codeline lineno="3555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a2dd24c5b3063476ad0f9c67f814dddbf" kindref="member">getBasisValues</ref>(self,</highlight></codeline>
<codeline lineno="3556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#\todo<sp/>it<sp/>isn&apos;t<sp/>really<sp/>necessarry<sp/>to<sp/>load<sp/>values<sp/>into<sp/>array<sp/>for<sp/>uniform<sp/>quadrature<sp/>and<sp/>basis<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiArray[k])</highlight></codeline>
<codeline lineno="3567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getValues(psi,vArray)</highlight></codeline>
<codeline lineno="3569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[eN,k,j]<sp/>=<sp/>psi[k,j]</highlight></codeline>
<codeline lineno="3574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a943a2ce75fbf1ae67b2e6c52ccf317c0" kindref="member">getBasisValuesAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[1]</highlight></codeline>
<codeline lineno="3578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[eN,k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiArrayArray[eN,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a810d04a26d9009d3eeab429633e4791f" kindref="member">getBasisGradientValuesRef</ref>(self,</highlight></codeline>
<codeline lineno="3584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7bf4a91a7f4f4f922fccc4236f7a86c2" kindref="member">grad_psi</ref><sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7bf4a91a7f4f4f922fccc4236f7a86c2" kindref="member">grad_psi</ref>[k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiArray[k])</highlight></codeline>
<codeline lineno="3594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7bf4a91a7f4f4f922fccc4236f7a86c2" kindref="member">grad_psi</ref></highlight></codeline>
<codeline lineno="3595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1adfe9c213428616258701deef352f26a7" kindref="member">getBasisGradientValues</ref>(self,</highlight></codeline>
<codeline lineno="3596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="3598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;</highlight></codeline>
<codeline lineno="3600"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>calculates<sp/>the<sp/>BasisGradientValues<sp/>for</highlight></codeline>
<codeline lineno="3601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calculations<sp/>on<sp/>the<sp/>reference<sp/>element.</highlight></codeline>
<codeline lineno="3602"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="3603"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Parameters</highlight></codeline>
<codeline lineno="3604"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="3605"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray<sp/>:<sp/>input,<sp/>:obj:`list`<sp/>of<sp/>:obj:`tuple`</highlight></codeline>
<codeline lineno="3606"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>list<sp/>of<sp/>quadrature<sp/>points<sp/>(x,y,z)<sp/>in<sp/>2D<sp/>case,<sp/>z<sp/>=<sp/>0.</highlight></codeline>
<codeline lineno="3607"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray<sp/>:<sp/>input,<sp/>:obj:`numpy.array`</highlight></codeline>
<codeline lineno="3608"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Values<sp/>of<sp/>the<sp/>inverseJacobian<sp/>matrix<sp/>used<sp/>in<sp/>the<sp/>affine</highlight></codeline>
<codeline lineno="3609"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transformation<sp/>from<sp/>the<sp/>physical<sp/>domain<sp/>to<sp/>the<sp/>reference</highlight></codeline>
<codeline lineno="3610"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element.</highlight></codeline>
<codeline lineno="3611"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray<sp/>:<sp/>output,<sp/>:obj:`numpy.array`</highlight></codeline>
<codeline lineno="3612"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gradient<sp/>values<sp/>of<sp/>basis<sp/>functions<sp/>on<sp/>reference<sp/>triangle,</highlight></codeline>
<codeline lineno="3613"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adjusted<sp/>for<sp/>transformation<sp/>from<sp/>physical<sp/>domain.</highlight></codeline>
<codeline lineno="3614"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiArray[k])</highlight></codeline>
<codeline lineno="3625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getGradientValues(grad_psi,</highlight></codeline>
<codeline lineno="3627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="3628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray)</highlight></codeline>
<codeline lineno="3629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[eN,k,j,m]<sp/>+=<sp/>grad_psi[k,j,n]*inverseJacobianArray[eN,k,n,m]</highlight></codeline>
<codeline lineno="3636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ac601cebd7c1b1705c1132743bb26d487" kindref="member">getBasisHessianValuesRef</ref>(self,</highlight></codeline>
<codeline lineno="3637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad13f4ce545c1b75956400a7b2e569f54" kindref="member">Hessian_psi</ref><sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim,</highlight></codeline>
<codeline lineno="3643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad13f4ce545c1b75956400a7b2e569f54" kindref="member">Hessian_psi</ref>[k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisHessians[j](xiArray[k])</highlight></codeline>
<codeline lineno="3648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad13f4ce545c1b75956400a7b2e569f54" kindref="member">Hessian_psi</ref></highlight></codeline>
<codeline lineno="3649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a35f998fd407f5a634c4f7cd3fefbcc65" kindref="member">getBasisHessianValues</ref>(self,</highlight></codeline>
<codeline lineno="3650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="3652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_vArray):</highlight></codeline>
<codeline lineno="3653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_psi<sp/>=<sp/>numpy.zeros((n_xi,</highlight></codeline>
<codeline lineno="3657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim,</highlight></codeline>
<codeline lineno="3659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_psi[k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisHessians[j](xiArray[k])</highlight></codeline>
<codeline lineno="3664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getHessianValues(Hessian_psi,</highlight></codeline>
<codeline lineno="3666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="3667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_vArray)</highlight></codeline>
<codeline lineno="3668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9bcfa7a179be0263afca4f896f31f78d" kindref="member">getBasisGradientValuesAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianArray,</highlight></codeline>
<codeline lineno="3671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[1]</highlight></codeline>
<codeline lineno="3674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiArrayArray[eN,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[eN,k,j,m]<sp/>+=<sp/>grad_psi[n]*inverseJacobianArray[eN,k,n,m]</highlight></codeline>
<codeline lineno="3682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a5ca60b9850db07fb20a9b572724da79b" kindref="member">getBasisValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="3683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permutations,</highlight></codeline>
<codeline lineno="3684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;</highlight></codeline>
<codeline lineno="3687"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>calculates<sp/>the<sp/>basis<sp/>function<sp/>values<sp/>on<sp/>the<sp/>trace<sp/>of<sp/>the<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="3688"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permutations<sp/>(input)<sp/><sp/><sp/><sp/>-<sp/></highlight></codeline>
<codeline lineno="3689"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray<sp/>(input)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>a<sp/>list<sp/>of<sp/>the<sp/>element<sp/>boundary<sp/>quarature<sp/>points<sp/>mapped<sp/>from<sp/>the<sp/>physical<sp/>domain<sp/>to<sp/>the<sp/>reference<sp/>triangle.</highlight></codeline>
<codeline lineno="3690"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray<sp/>(output)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>the<sp/>vector<sp/>to<sp/>store<sp/>the<sp/>basis<sp/>function<sp/>trace<sp/>values<sp/>on<sp/>the<sp/>reference<sp/>triangle</highlight></codeline>
<codeline lineno="3691"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[2]</highlight></codeline>
<codeline lineno="3693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries*n_xi,</highlight></codeline>
<codeline lineno="3695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[ebN*n_xi+k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiArray[0,ebN,k])</highlight></codeline>
<codeline lineno="3701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getValuesTrace(psi,</highlight></codeline>
<codeline lineno="3703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permutations,</highlight></codeline>
<codeline lineno="3704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray)</highlight></codeline>
<codeline lineno="3705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[eN,ebN,k,j]<sp/>=<sp/>psi[permutations[eN,ebN,k],j]</highlight></codeline>
<codeline lineno="3711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a36170521565fe5f9af36aa3d77519110" kindref="member">getBasisValuesTraceAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[2]</highlight></codeline>
<codeline lineno="3715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#vArray[eN,ebN,k,j]<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisTrace[ebN][j](xiArrayArray[eN,ebN,k,:self.referenceFiniteElement.referenceElement.dim])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN](xiArrayArray[eN,ebN,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[eN,ebN,k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="3725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a88482ef3f24b233df500ce33c68ef0bd" kindref="member">getBasisGradientValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="3726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permutations,</highlight></codeline>
<codeline lineno="3727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[2]</highlight></codeline>
<codeline lineno="3732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries*n_xi,</highlight></codeline>
<codeline lineno="3734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN*n_xi+k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiArray[0,ebN,k])</highlight></codeline>
<codeline lineno="3741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getGradientValuesTrace(grad_psi,</highlight></codeline>
<codeline lineno="3743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permutations,</highlight></codeline>
<codeline lineno="3744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray)</highlight></codeline>
<codeline lineno="3746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[eN,ebN,k,j,m]<sp/>+=<sp/>grad_psi[permutations[eN,ebN,k],j,n]*inverseJacobianTraceArray[eN,ebN,k,n,m]</highlight></codeline>
<codeline lineno="3754"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ae9c8d84e3691c831a4f4042ccc566e3d" kindref="member">getBasisGradientValuesTraceAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[2]</highlight></codeline>
<codeline lineno="3760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="3762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisGradientsTrace[ebN][j](xiArrayArray[eN,ebN,k,:self.referenceFiniteElement.referenceElement.dim])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN](xiArrayArray[eN,ebN,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[eN,ebN,k,j,m]<sp/>+=<sp/>grad_psi[n]*inverseJacobianTraceArray[eN,ebN,k,n,m]</highlight></codeline>
<codeline lineno="3773"><highlight class="normal"></highlight></codeline>
<codeline lineno="3774"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a337429acc59794b134998ab05aa860da" kindref="member">getBasisValuesTraceRef</ref>(self,xiArray):</highlight></codeline>
<codeline lineno="3775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aed79429b0b044328de0362ce9d71129a" kindref="member">psi_trace</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#psi[ebN,k,j]<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aed79429b0b044328de0362ce9d71129a" kindref="member">psi_trace</ref>[ebN,k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="3789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aed79429b0b044328de0362ce9d71129a" kindref="member">psi_trace</ref></highlight></codeline>
<codeline lineno="3790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a4527c7dcf4f0bbffd61b0717295a36c8" kindref="member">getBasisValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="3791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="3798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#psi[ebN,k,j]<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[ebN,k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="3807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getValuesGlobalExteriorTrace(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi,</highlight></codeline>
<codeline lineno="3812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray)</highlight></codeline>
<codeline lineno="3813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.elementMaps.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.elementMaps.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.elementMaps.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[ebNE,k,j]<sp/>=<sp/>psi[ebN_local,k,j]</highlight></codeline>
<codeline lineno="3821"><highlight class="normal"></highlight></codeline>
<codeline lineno="3822"><highlight class="normal"></highlight></codeline>
<codeline lineno="3823"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1adeb461d9327c6559d1574f3b8577e7e1" kindref="member">getBasisValuesGlobalExteriorTraceAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray):</highlight></codeline>
<codeline lineno="3826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[1]</highlight></codeline>
<codeline lineno="3827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.elementBoundayLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>manually<sp/>map<sp/>from<sp/>\bar{x}<sp/>(reference<sp/>element<sp/>boundary<sp/>quadrature<sp/>point<sp/>to<sp/>reference<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#and<sp/>then<sp/>evaluate<sp/>using<sp/>basis,<sp/>since<sp/>basisTrace<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#vArray[ebNE,k,j]<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisTrace[ebN_local][j](xiArrayArray[ebNE,k,:self.referenceFiniteElement.referenceElement.dim])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN_local](xiArrayArray[ebNE,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vArray[ebNE,k,j]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basis[j](xiHat_k)</highlight></codeline>
<codeline lineno="3838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ab88c2b37e105764c230a75cb378e02c4" kindref="member">getBasisGradientValuesTraceRef</ref>(self,</highlight></codeline>
<codeline lineno="3839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray):</highlight></codeline>
<codeline lineno="3840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a2c547d89c7edfb362ed19d050cca6a17" kindref="member">grad_psi_trace</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a2c547d89c7edfb362ed19d050cca6a17" kindref="member">grad_psi_trace</ref>[ebN,k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiArray[k])</highlight></codeline>
<codeline lineno="3851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a2c547d89c7edfb362ed19d050cca6a17" kindref="member">grad_psi_trace</ref></highlight></codeline>
<codeline lineno="3852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a643aa6175f4c76b768dc1e7844a5dc10" kindref="member">getBasisGradientValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="3853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray,</highlight></codeline>
<codeline lineno="3854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArray.shape[0]</highlight></codeline>
<codeline lineno="3858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="3860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi,</highlight></codeline>
<codeline lineno="3861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="3862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim),</highlight></codeline>
<codeline lineno="3863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3864"><highlight class="normal"></highlight></codeline>
<codeline lineno="3865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="3866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi[ebN,k,j,:]<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisGradientsTrace[ebN][j](xiArray[k])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN](xiArray[k])</highlight></codeline>
<codeline lineno="3872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi[ebN,k,j,:]<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a619f439ee55b68cee39c04f9d1f1b03e" kindref="member">useC</ref><sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.parametricFiniteElementSpace_getGradientValuesGlobalExteriorTrace(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="3875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="3876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="3877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi,</highlight></codeline>
<codeline lineno="3878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray)</highlight></codeline>
<codeline lineno="3880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[ebNE,k,j,m]<sp/>+=<sp/>grad_psi[ebN_local,k,j,n]*inverseJacobianArray[ebNE,k,n,m]</highlight></codeline>
<codeline lineno="3890"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aeb99ba48cf77a9aea25575edf6e8481a" kindref="member">getBasisGradientValuesGlobalExteriorTraceAtArray</ref>(self,</highlight></codeline>
<codeline lineno="3891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArrayArray,</highlight></codeline>
<codeline lineno="3892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inverseJacobianTraceArray,</highlight></codeline>
<codeline lineno="3893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray):</highlight></codeline>
<codeline lineno="3894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray.flat[:]=0.0</highlight></codeline>
<codeline lineno="3895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>xiArrayArray.shape[1]</highlight></codeline>
<codeline lineno="3896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="3897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="3898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="3899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="3900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="3901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="3902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="3903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>move<sp/>away<sp/>from<sp/>using<sp/>basisGradientsTrace<sp/>directly<sp/>since<sp/>will<sp/>be<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#switch<sp/>to<sp/>using<sp/>boundaryMapList<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#grad_psi<sp/>=<sp/>self.referenceFiniteElement.localFunctionSpace.basisGradientsTrace[ebN_local][j](xiArrayArray[ebNE,k,:self.referenceFiniteElement.referenceElement.dim])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiHat_k<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.boundaryMapList[ebN_local](xiArrayArray[ebNE,k,:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim])</highlight></codeline>
<codeline lineno="3907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_psi<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.basisGradients[j](xiHat_k)</highlight></codeline>
<codeline lineno="3908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="3910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vArray[ebNE,k,j,m]<sp/>+=<sp/>grad_psi[n]*inverseJacobianTraceArray[ebNE,k,n,m]</highlight></codeline>
<codeline lineno="3911"><highlight class="normal"></highlight></codeline>
<codeline lineno="3912"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1aec622678672f1db1acc85e82687440f8" kindref="member">updateInterpolationPoints</ref>(self):</highlight></codeline>
<codeline lineno="3913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pdb</highlight></codeline>
<codeline lineno="3914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pdb.set_trace()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.getValues(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.interpolationConditions.quadraturePointArray,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad97f4cb48480089322daf1cd7c323aa5" kindref="member">interpolationPoints</ref>)</highlight></codeline>
<codeline lineno="3916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad97f4cb48480089322daf1cd7c323aa5" kindref="member">interpolationPoints</ref></highlight></codeline>
<codeline lineno="3917"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1afa50c02999ea85b2f53b856ee1dc70f4" kindref="member">endTimeSeriesEnsight</ref>(self,timeValues,filename,description,ts=1):</highlight></codeline>
<codeline lineno="3918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>this<sp/>could<sp/>break<sp/>something,<sp/>but<sp/>it<sp/>should<sp/>be<sp/>true:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref><sp/>=<sp/>len(timeValues)</highlight></codeline>
<codeline lineno="3920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;TIME\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;time<sp/>set:<sp/>&apos;</highlight><highlight class="normal">+repr(ts)+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+description+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="3921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number<sp/>of<sp/>steps:<sp/>&apos;</highlight><highlight class="normal">+<sp/>repr(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>)+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="3922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;filename<sp/>start<sp/>number:<sp/>0\n&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="3923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;filename<sp/>increment:<sp/>1\n&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="3924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;time<sp/>values:&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(lines)</highlight></codeline>
<codeline lineno="3927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>tn<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>timeValues:</highlight></codeline>
<codeline lineno="3928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;<sp/>%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%tn)</highlight></codeline>
<codeline lineno="3929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="3930"><highlight class="normal"></highlight></codeline>
<codeline lineno="3931"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad30fddb55be41bff527bc9500012286d" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="3932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3933"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>we<sp/>would<sp/>like<sp/>to<sp/>be<sp/>able<sp/>to<sp/>get<sp/>references<sp/>to<sp/>existing<sp/>values<sp/>for<sp/>values<sp/>at<sp/>nodes<sp/>for<sp/>some<sp/>calculations</highlight></codeline>
<codeline lineno="3934"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>like<sp/>vtkVisualization</highlight></codeline>
<codeline lineno="3935"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError</highlight></codeline>
<codeline lineno="3937"><highlight class="normal"></highlight></codeline>
<codeline lineno="3938"><highlight class="normal"></highlight></codeline>
<codeline lineno="3939" refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="3940"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3941"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="3942"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="3943"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="3944"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="3945"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>linear<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="3946"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3947"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1aaa7e843d8f0634995f6c1dc44a1f39ae" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="3948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a90fe4f8b64ceeda6e1ed3e57d97fb242" kindref="member">order</ref><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="3949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="3950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="3951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="3952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="3953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="3954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="3955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="3956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="3957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="3958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a6c06d9aceb18fae12d9a352bb685e4b2" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="3959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a6c06d9aceb18fae12d9a352bb685e4b2" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight></codeline>
<codeline lineno="3960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1ade47d62bf3bd642d1b6b138ba0b46c3e" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="3961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1ade47d62bf3bd642d1b6b138ba0b46c3e" kindref="member">writeMeshXdmf</ref>(ar,</highlight><highlight class="stringliteral">&quot;Spatial_Domain&quot;</highlight><highlight class="normal">,t,init,meshChanged,tCount)</highlight></codeline>
<codeline lineno="3962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid</highlight></codeline>
<codeline lineno="3963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a6e49a5b4be086049b81ba5a39c58a0cd" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="3964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Gnuplot</highlight></codeline>
<codeline lineno="3965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="3966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="3968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.viewer(&quot;set<sp/>terminal<sp/>x11&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.plot(Gnuplot.Data(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeArray[:,0],</highlight></codeline>
<codeline lineno="3970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="3971"><highlight class="normal"></highlight></codeline>
<codeline lineno="3972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=filename))</highlight></codeline>
<codeline lineno="3973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="3974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="3976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.viewer(&quot;set<sp/>terminal<sp/>x11&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nx<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global)</highlight></codeline>
<codeline lineno="3978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ny<sp/>=<sp/>nx</highlight></codeline>
<codeline lineno="3979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="3980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="3981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSol<sp/>=<sp/>numpy.reshape(u.dof,(nx,ny))</highlight></codeline>
<codeline lineno="3982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>parametric&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>data<sp/>style<sp/>lines&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>hidden&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>contour<sp/>base&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.xlabel(</highlight><highlight class="stringliteral">&apos;x&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.ylabel(</highlight><highlight class="stringliteral">&apos;y&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.splot(Gnuplot.GridData(nSol,</highlight></codeline>
<codeline lineno="3989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x,</highlight></codeline>
<codeline lineno="3990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,</highlight></codeline>
<codeline lineno="3991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>binary=0,</highlight></codeline>
<codeline lineno="3992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inline=0,</highlight></codeline>
<codeline lineno="3993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=filename))</highlight></codeline>
<codeline lineno="3994"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1ae503256bbd13f9e9f715ad52faf2efeb" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="3995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="3996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:u.name,</highlight></codeline>
<codeline lineno="3997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Scalar&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="3999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,)})</highlight></codeline>
<codeline lineno="4004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comm<sp/>=<sp/>Comm.get()</highlight></codeline>
<codeline lineno="4007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_sync(u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),</highlight></codeline>
<codeline lineno="4008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#need<sp/>to<sp/>use<sp/>the<sp/>mesh<sp/>node<sp/>offsets<sp/>due<sp/>to<sp/>parallel<sp/>periodic<sp/>case</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#offsets<sp/>=<sp/>self.dofMap.dof_offsets_subdomain_owned,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#data<sp/>=<sp/>u.dof[:(self.dofMap.dof_offsets_subdomain_owned[comm.rank()+1]<sp/>-self.dofMap.dof_offsets_subdomain_owned[comm.rank()])])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offsets=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="4012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>u.dof[:(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned[comm.rank()+1]<sp/>-self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned[comm.rank()])])</highlight></codeline>
<codeline lineno="4013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;global_sync<sp/>not<sp/>supported<sp/>with<sp/>text<sp/>heavy<sp/>data&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:u.name,</highlight></codeline>
<codeline lineno="4017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Scalar&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,)})</highlight></codeline>
<codeline lineno="4024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_async(u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),<sp/>data<sp/>=<sp/>u.dof)</highlight></codeline>
<codeline lineno="4027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.savetxt(ar.textDataDir+</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&quot;{0:s}{1:d}&quot;</highlight><highlight class="normal">.format(u.name,<sp/>tCount)+</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">,u.dof)</highlight></codeline>
<codeline lineno="4029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SubElement(values,</highlight><highlight class="stringliteral">&quot;xi:include&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;parse&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;text&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;href&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;./&quot;</highlight><highlight class="normal">+ar.textDataDir+</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&quot;{0:s}{1:d}&quot;</highlight><highlight class="normal">.format(u.name,<sp/>tCount)+</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4030"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a46e643397c7e122e79586c457dcfa9f6" kindref="member">readFunctionXdmf</ref>(self,ar,u,tCount=0):</highlight></codeline>
<codeline lineno="4031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFileGlb<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>map<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeNumbering_subdomain2global</highlight></codeline>
<codeline lineno="4034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array=ar.hdfFileGlb.get_node(</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;{0:s}{1:d}&quot;</highlight><highlight class="normal">.format(u.name,<sp/>tCount))</highlight></codeline>
<codeline lineno="4035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(map)):</highlight></codeline>
<codeline lineno="4036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[i]<sp/>=<sp/>array[map[i]]</highlight></codeline>
<codeline lineno="4037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>array</highlight></codeline>
<codeline lineno="4038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="4040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#this<sp/>is<sp/>known<sp/>to<sp/>be<sp/>slow<sp/>but<sp/>it<sp/>scales<sp/>with</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#respect<sp/>to<sp/>memory<sp/>(as<sp/>opposed<sp/>to<sp/>the<sp/>faster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#approach<sp/>of<sp/>pulling<sp/>in<sp/>the<sp/>entire<sp/>array)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permute<sp/>=<sp/>np.argsort(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeNumbering_subdomain2global)</highlight></codeline>
<codeline lineno="4044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[permute]<sp/>=<sp/>ar.hdfFile[</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)][self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeNumbering_subdomain2global[permute].tolist()]</highlight></codeline>
<codeline lineno="4045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#faster<sp/>way</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#u.dof[:]<sp/>=<sp/>ar.hdfFile[&quot;/&quot;+u.name+&quot;_t{0:d}&quot;.format(tCount)].value[self.mesh.globalMesh.nodeNumbering_subdomain2global]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[:]=ar.hdfFile[</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)]</highlight></codeline>
<codeline lineno="4049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#numpy.savetxt(ar.textDataDir+&quot;/&quot;+&quot;{0:s}{0:d}&quot;.format(u.name,<sp/>tCount)+&quot;.txt&quot;,u.dof)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#SubElement(values,&quot;xi:include&quot;,{&quot;parse&quot;:&quot;text&quot;,&quot;href&quot;:&quot;./&quot;+ar.textDataDir+&quot;/&quot;+&quot;{0:s}{0:d}&quot;.format(u.name,<sp/>tCount)+&quot;.txt&quot;})</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a579786c93e2042f28dc1d2a9fc1c6a28" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>concatNow=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>concatNow:</highlight></codeline>
<codeline lineno="4056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="4057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_dof<sp/>=<sp/>uList[components[0]].dof</highlight></codeline>
<codeline lineno="4066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>uList[components[1]].dof</highlight></codeline>
<codeline lineno="4070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>3:</highlight></codeline>
<codeline lineno="4071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>uList[components[2]].dof</highlight></codeline>
<codeline lineno="4074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>velocity<sp/>=<sp/>numpy.column_stack((u_dof,v_dof,w_dof))</highlight></codeline>
<codeline lineno="4075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+vectorName+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_sync(vectorName+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),</highlight></codeline>
<codeline lineno="4078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offsets=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="4079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>velocity[:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_owned,:])</highlight></codeline>
<codeline lineno="4080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_dof<sp/>=<sp/>uList[components[0]].dof</highlight></codeline>
<codeline lineno="4090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>uList[components[1]].dof</highlight></codeline>
<codeline lineno="4094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>3:</highlight></codeline>
<codeline lineno="4095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>uList[components[2]].dof</highlight></codeline>
<codeline lineno="4098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>velocity<sp/>=<sp/>numpy.column_stack((u_dof,v_dof,w_dof))</highlight></codeline>
<codeline lineno="4099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+vectorName+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_async(vectorName+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),<sp/>data<sp/>=<sp/>velocity)</highlight></codeline>
<codeline lineno="4102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>(0.0<sp/>*<sp/>$1<sp/>))&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="4112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>$2)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ci<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>components:</highlight></codeline>
<codeline lineno="4117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReferenceString=</highlight><highlight class="stringliteral">&quot;/Xdmf/Domain/Grid/Grid[%i]/Attribute[%i]/DataItem&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tCount+1,ci+1)</highlight></codeline>
<codeline lineno="4118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component<sp/>=<sp/>SubElement(values,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Reference&quot;</highlight><highlight class="normal">:ReferenceString})</highlight></codeline>
<codeline lineno="4119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1af3cf26e7bf6f2afe98d77bbdadb4c603" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="4144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>n<sp/>in<sp/>u.femSpace.range_dim:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>uOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>u.dof[n*u.dim_dof<sp/>+<sp/>t])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="4148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.femSpace.range_dim:</highlight></codeline>
<codeline lineno="4149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="4150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="4151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="4152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a1fe1090497c8cad7e969f331381b65e9" kindref="member">writeE2VectorFunctionEnsight</ref>(self,u,v,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>nOutput,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="4167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,v.dof,uOut)</highlight></codeline>
<codeline lineno="4168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF_ZEROS(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,uOut)</highlight></codeline>
<codeline lineno="4169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="4170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a4c354e1050ada917c21b756b2748f93b" kindref="member">writeE2VectorFunctionHeaderEnsight</ref>(self,u,v,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="4180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1adac3dfd2fe22cd5e6477cc252ce127dc" kindref="member">writeE3VectorFunctionEnsight</ref>(self,u,v,w,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>nOutput,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="4195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,v.dof,uOut)</highlight></codeline>
<codeline lineno="4196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(w.femSpace.dim,w.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,w.dof,uOut)</highlight></codeline>
<codeline lineno="4197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="4198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1afc780d1edf5824efaf23dcf6e9dd38eb" kindref="member">writeE3VectorFunctionHeaderEnsight</ref>(self,u,v,w,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="4208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a1a00f6279a4fd6cdd8d869b1f9aa749a" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1ac8fa794e757221dc95900752d9606d78" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="4227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="4229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="4230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="4233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="4234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="4235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4241"><highlight class="normal"></highlight></codeline>
<codeline lineno="4242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="4243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="dd/d75/classproteus_1_1Viewers_1_1MatlabWriter" kindref="compound">Viewers.MatlabWriter</ref>(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="4244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_LagrangeC0P1(fout,</highlight></codeline>
<codeline lineno="4245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="4246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="4247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="4248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="4249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="4250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="4251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="4252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="4253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="4254"><highlight class="normal"></highlight></codeline>
<codeline lineno="4255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="4256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="4258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis_1a59036bc53874767c67048f8b39486b5e" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="4259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues.flat[:]<sp/>=<sp/>dof.flat[:]</highlight></codeline>
<codeline lineno="4262"><highlight class="normal"></highlight></codeline>
<codeline lineno="4263" refid="de/d65/classproteus_1_1FemTools_1_1C0__LinearOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="de/d65/classproteus_1_1FemTools_1_1C0__LinearOnCubeWithNodalBasis" kindref="compound">C0_LinearOnCubeWithNodalBasis</ref>(<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>):</highlight></codeline>
<codeline lineno="4264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4265"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4266"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4267"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4268"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>cube<sp/>under</highlight></codeline>
<codeline lineno="4269"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>n-linear(non-affine)<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>cube.</highlight></codeline>
<codeline lineno="4270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/d65/classproteus_1_1FemTools_1_1C0__LinearOnCubeWithNodalBasis_1a14998bbbf5a08e69095a251ef88c565c" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="4273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions" kindref="compound">CubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" kindref="compound">ParametricMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="4281" refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis" kindref="compound">C0_AffineLinearOnCubeWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="4282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4283"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4284"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4285"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4286"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="4287"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>linear<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="4288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis_1a02a4f39ef9c0cc3f4ab9eaef643d8c0b" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="4291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="da/dcd/classproteus_1_1FemTools_1_1CubeNodalInterpolationConditions" kindref="compound">CubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="4299"><highlight class="normal"></highlight></codeline>
<codeline lineno="4300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis_1a7b9d0b9316ca52ba0f8921ebdd42947a" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="4301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis_1a7b9d0b9316ca52ba0f8921ebdd42947a" kindref="member">writeMeshXdmf</ref>(ar,</highlight><highlight class="stringliteral">&quot;Spatial_Domain&quot;</highlight><highlight class="normal">,t,init,meshChanged,tCount)</highlight></codeline>
<codeline lineno="4302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid</highlight></codeline>
<codeline lineno="4303"><highlight class="normal"></highlight></codeline>
<codeline lineno="4304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis_1ac4746de0431126bdaaeb719f26d46664" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comm<sp/>=<sp/>Comm.get()</highlight></codeline>
<codeline lineno="4306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="4307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:u.name,</highlight></codeline>
<codeline lineno="4308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Scalar&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,)})</highlight></codeline>
<codeline lineno="4315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_sync(u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),</highlight></codeline>
<codeline lineno="4318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#need<sp/>to<sp/>use<sp/>the<sp/>mesh<sp/>node<sp/>offsets<sp/>due<sp/>to<sp/>parallel<sp/>periodic<sp/>case</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#offsets<sp/>=<sp/>self.dofMap.dof_offsets_subdomain_owned,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#data<sp/>=<sp/>u.dof[:(self.dofMap.dof_offsets_subdomain_owned[comm.rank()+1]<sp/>-<sp/>self.dofMap.dof_offsets_subdomain_owned[comm.rank()])],</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offsets=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="4322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>u.dof[:(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned[comm.rank()+1]<sp/>-self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned[comm.rank()])])</highlight></codeline>
<codeline lineno="4323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;global_sync<sp/>not<sp/>supported<sp/>with<sp/>text<sp/>heavy<sp/>data&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:u.name,</highlight></codeline>
<codeline lineno="4327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Scalar&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,)})</highlight></codeline>
<codeline lineno="4334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_async(u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),<sp/>data<sp/>=<sp/>u.dof)</highlight></codeline>
<codeline lineno="4337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.savetxt(ar.textDataDir+</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&quot;{0:s}{1:d}&quot;</highlight><highlight class="normal">.format(u.name,<sp/>tCount)+</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">,u.dof)</highlight></codeline>
<codeline lineno="4339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SubElement(values,</highlight><highlight class="stringliteral">&quot;xi:include&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;parse&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;text&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;href&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;./&quot;</highlight><highlight class="normal">+ar.textDataDir+</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&quot;{0:s}{1:d}&quot;</highlight><highlight class="normal">.format(u.name,<sp/>tCount)+</highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4340"><highlight class="normal"></highlight></codeline>
<codeline lineno="4341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/d40/classproteus_1_1FemTools_1_1C0__AffineLinearOnCubeWithNodalBasis_1a27fc25b78d59f1337955fffec4d4d19c" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>concatNow=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>concatNow:</highlight></codeline>
<codeline lineno="4344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="4345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_dof<sp/>=<sp/>uList[components[0]].dof</highlight></codeline>
<codeline lineno="4354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>uList[components[1]].dof</highlight></codeline>
<codeline lineno="4358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>3:</highlight></codeline>
<codeline lineno="4359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>uList[components[2]].dof</highlight></codeline>
<codeline lineno="4362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>velocity<sp/>=<sp/>numpy.column_stack((u_dof,v_dof,w_dof))</highlight></codeline>
<codeline lineno="4363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+vectorName+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_sync(vectorName+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),</highlight></codeline>
<codeline lineno="4366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offsets<sp/>=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nodeOffsets_subdomain_owned,</highlight></codeline>
<codeline lineno="4367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>velocity[:self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_owned,:])</highlight></codeline>
<codeline lineno="4368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;Format&quot;</highlight><highlight class="normal">:ar.dataItemFormat,</highlight></codeline>
<codeline lineno="4374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;DataType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Float&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Precision&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;8&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_dof<sp/>=<sp/>uList[components[0]].dof</highlight></codeline>
<codeline lineno="4378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>2:</highlight></codeline>
<codeline lineno="4379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_dof<sp/>=<sp/>uList[components[1]].dof</highlight></codeline>
<codeline lineno="4382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>&lt;<sp/>3:</highlight></codeline>
<codeline lineno="4383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>numpy.zeros(u_dof.shape,dtype=</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_dof<sp/>=<sp/>uList[components[2]].dof</highlight></codeline>
<codeline lineno="4386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>velocity<sp/>=<sp/>numpy.column_stack((u_dof,v_dof,w_dof))</highlight></codeline>
<codeline lineno="4387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.hdfFile<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values.text<sp/>=<sp/>ar.hdfFilename+</highlight><highlight class="stringliteral">&quot;:/&quot;</highlight><highlight class="normal">+vectorName+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)</highlight></codeline>
<codeline lineno="4389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ar.create_dataset_async(vectorName+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount),<sp/>data<sp/>=<sp/>velocity)</highlight></codeline>
<codeline lineno="4390"><highlight class="normal"></highlight></codeline>
<codeline lineno="4391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="4393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>(0.0<sp/>*<sp/>$1<sp/>))&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="4402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>$2)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.globalMesh.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ci<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>components:</highlight></codeline>
<codeline lineno="4407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReferenceString=</highlight><highlight class="stringliteral">&quot;/Xdmf/Domain/Grid/Grid[%i]/Attribute[%i]/DataItem&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tCount+1,ci+1)</highlight></codeline>
<codeline lineno="4408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component<sp/>=<sp/>SubElement(values,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Reference&quot;</highlight><highlight class="normal">:ReferenceString})</highlight></codeline>
<codeline lineno="4409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribute<sp/>=<sp/>SubElement(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.arGrid,</highlight><highlight class="stringliteral">&quot;Attribute&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Name&quot;</highlight><highlight class="normal">:vectorName,</highlight></codeline>
<codeline lineno="4411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;AttributeType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Vector&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Center&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Node&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="4413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>(0.0<sp/>*<sp/>$1<sp/>))&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>len(components)<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="4419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/><sp/><sp/><sp/>=<sp/>SubElement(attribute,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&quot;ItemType&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Function&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;JOIN($0<sp/>,<sp/>$1<sp/>,<sp/>$2)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="4422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Dimensions&quot;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;%i<sp/>%i&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,3)})</highlight></codeline>
<codeline lineno="4423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ci<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>components:</highlight></codeline>
<codeline lineno="4424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ReferenceString=</highlight><highlight class="stringliteral">&quot;/Xdmf/Domain/Grid/Grid[%i]/Attribute[%i]/DataItem&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tCount+1,ci+1)</highlight></codeline>
<codeline lineno="4425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component<sp/>=<sp/>SubElement(values,</highlight><highlight class="stringliteral">&quot;DataItem&quot;</highlight><highlight class="normal">,{</highlight><highlight class="stringliteral">&quot;Reference&quot;</highlight><highlight class="normal">:ReferenceString})</highlight></codeline>
<codeline lineno="4426"><highlight class="normal"></highlight></codeline>
<codeline lineno="4427"><highlight class="normal">P1<sp/>=<sp/>C0_AffineLinearOnSimplexWithNodalBasis</highlight></codeline>
<codeline lineno="4428"><highlight class="normal"></highlight></codeline>
<codeline lineno="4429" refid="dd/dd7/classproteus_1_1FemTools_1_1C0__LagrangeOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dd/dd7/classproteus_1_1FemTools_1_1C0__LagrangeOnCubeWithNodalBasis" kindref="compound">C0_LagrangeOnCubeWithNodalBasis</ref>(<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>):</highlight></codeline>
<codeline lineno="4430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4431"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4432"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4433"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4434"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>cube<sp/>under</highlight></codeline>
<codeline lineno="4435"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>n-linear(non-affine)<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>cube.</highlight></codeline>
<codeline lineno="4436"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/dd7/classproteus_1_1FemTools_1_1C0__LagrangeOnCubeWithNodalBasis_1a297a8645cc9c2dde2e5fc148be6fd5c0" kindref="member">__init__</ref>(self,mesh,nd=3,order=2):</highlight></codeline>
<codeline lineno="4438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" kindref="compound">LagrangeOnCubeWithNodalBasis</ref>(nd,order=2)</highlight></codeline>
<codeline lineno="4439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#todo<sp/>fix<sp/>these<sp/>interpolation<sp/>conditions<sp/>to<sp/>work<sp/>on<sp/>Cube</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeCubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" kindref="compound">ParametricMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" kindref="compound">LagrangeOnCubeWithNodalBasis</ref>(nd,order=mesh.px)),</highlight></codeline>
<codeline lineno="4447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" kindref="compound">QuadraticLagrangeCubeDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="4448"><highlight class="normal"></highlight></codeline>
<codeline lineno="4449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;C0_LagrangeOnCubeWithNodalBasis&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(mesh.px)</highlight></codeline>
<codeline lineno="4451"><highlight class="normal"></highlight></codeline>
<codeline lineno="4452" refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis" kindref="compound">C0_AffineLagrangeOnCubeWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="4453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4454"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4455"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4456"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4457"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="4458"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>linear<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="4459"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a18ad03e45cfbb442bd46cc27f944e9ed" kindref="member">__init__</ref>(self,mesh,nd=3,order=2):</highlight></codeline>
<codeline lineno="4461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a14f5617ac8fb77a8128dca2f1e7d321b" kindref="member">order</ref><sp/>=<sp/>order</highlight></codeline>
<codeline lineno="4462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace=<sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="4463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#todo<sp/>fix<sp/>these<sp/>interpolation<sp/>conditions<sp/>to<sp/>work<sp/>on<sp/>Cube</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a14f5617ac8fb77a8128dca2f1e7d321b" kindref="member">order</ref>==2:</highlight></codeline>
<codeline lineno="4465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" kindref="compound">LagrangeOnCubeWithNodalBasis</ref>(nd,order=2)</highlight></codeline>
<codeline lineno="4466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeCubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>elif<sp/>self.order==1:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/>LagrangeOnCubeWithNodalBasis(nd,order=1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/>CubeNodalInterpolationConditions(localFunctionSpace.referenceElement)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError<sp/>(</highlight><highlight class="stringliteral">&quot;Lagrange<sp/>factory<sp/>only<sp/>implemented<sp/>for<sp/>Q2&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;elements<sp/>so<sp/>far.<sp/>For<sp/>Q1<sp/>use<sp/>C0_AffineLinearOnCubeWithNodalBasis.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace.referenceElement,</highlight></codeline>
<codeline lineno="4478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" kindref="compound">QuadraticLagrangeCubeDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="4480"><highlight class="normal"></highlight></codeline>
<codeline lineno="4481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="4482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="4483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x_j<sp/>=<sp/>interpolationConditions.quadraturePointArray[j]</highlight></codeline>
<codeline lineno="4484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi_ij<sp/>=<sp/>localFunctionSpace.basis[i](x_j)</highlight></codeline>
<codeline lineno="4485"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print<sp/>i,j,x_j,psi_ij</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>i==j:</highlight></codeline>
<codeline lineno="4487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(abs(1.0-psi_ij)<sp/>&lt;<sp/>1.0e-8)</highlight></codeline>
<codeline lineno="4488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(abs(psi_ij)<sp/>&lt;<sp/>1.0e-8)</highlight></codeline>
<codeline lineno="4490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="4492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1afc153d4e05512d4289a92484f8b63b84" kindref="member">XdmfWriter</ref>=<ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="4493"><highlight class="normal"></highlight></codeline>
<codeline lineno="4494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1ae3c74c01c6c501efcea6e59bf02c444b" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="4495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a14f5617ac8fb77a8128dca2f1e7d321b" kindref="member">order</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1afc153d4e05512d4289a92484f8b63b84" kindref="member">XdmfWriter</ref>.writeMeshXdmf_C0Q2Lagrange(ar,name,mesh=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>,spaceDim=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="4497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="4498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="4499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError<sp/>(</highlight><highlight class="stringliteral">&quot;Lagrange<sp/>factory<sp/>only<sp/>implemented<sp/>for<sp/>Q2&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;elements<sp/>so<sp/>far.<sp/>For<sp/>Q1<sp/>use<sp/>C0_AffineLinearOnCubeWithNodalBasis.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4502"><highlight class="normal"></highlight></codeline>
<codeline lineno="4503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1aea5ac0fbc57e340b63a41609ad0a1124" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1afc153d4e05512d4289a92484f8b63b84" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_C0P2Lagrange(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a9e9f404553c39a5f9713e390e31f179f" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1afc153d4e05512d4289a92484f8b63b84" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_nodal(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;c0p2_Lagrange&quot;</highlight><highlight class="normal">,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4507"><highlight class="normal"></highlight></codeline>
<codeline lineno="4508"><highlight class="normal"></highlight></codeline>
<codeline lineno="4509"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Lagrange<sp/>Factory<sp/>On<sp/>Cube</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4510"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dd2/namespaceproteus_1_1FemTools_1a347483a36089f932a25d40d8fdba379a" kindref="member">LagrangeCubeFactory</ref>(OrderIn):</highlight></codeline>
<codeline lineno="4511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">LagrangeCubeOrderN(<ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis" kindref="compound">C0_AffineLagrangeOnCubeWithNodalBasis</ref>):</highlight></codeline>
<codeline lineno="4512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/de9/classproteus_1_1FemTools_1_1C0__AffineLagrangeOnCubeWithNodalBasis_1a18ad03e45cfbb442bd46cc27f944e9ed" kindref="member">__init__</ref>(self,mesh,nd):</highlight></codeline>
<codeline lineno="4513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C0_AffineLagrangeOnCubeWithNodalBasis.__init__(self,mesh,nd,order=OrderIn)</highlight></codeline>
<codeline lineno="4514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>LagrangeCubeOrderN</highlight></codeline>
<codeline lineno="4515"><highlight class="normal"></highlight></codeline>
<codeline lineno="4516"><highlight class="normal"></highlight><highlight class="comment">#<sp/>TODO<sp/>-<sp/>migrate<sp/>Q1<sp/>to<sp/>an<sp/>instance<sp/>of<sp/>LagrangeCubeFactor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4517"><highlight class="normal">Q1<sp/>=<sp/>C0_AffineLinearOnCubeWithNodalBasis</highlight></codeline>
<codeline lineno="4518"><highlight class="normal">Q2<sp/>=<sp/><ref refid="da/dd2/namespaceproteus_1_1FemTools_1a347483a36089f932a25d40d8fdba379a" kindref="member">LagrangeCubeFactory</ref>(2)</highlight></codeline>
<codeline lineno="4519"><highlight class="normal">C0_AffineQuadraticOnCubeWithNodalBasis<sp/>=<sp/>Q2</highlight></codeline>
<codeline lineno="4520"><highlight class="normal"></highlight></codeline>
<codeline lineno="4521" refid="da/d6a/classproteus_1_1FemTools_1_1C0__BernsteinOnCube" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/d6a/classproteus_1_1FemTools_1_1C0__BernsteinOnCube" kindref="compound">C0_BernsteinOnCube</ref>(<ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>):</highlight></codeline>
<codeline lineno="4522"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4523"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>standard<sp/>linear<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4524"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4525"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>cube<sp/>under</highlight></codeline>
<codeline lineno="4526"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>n-linear(non-affine)<sp/>mapping.<sp/>The<sp/>Bernstein<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>cube.</highlight></codeline>
<codeline lineno="4527"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d6a/classproteus_1_1FemTools_1_1C0__BernsteinOnCube_1af3156606785d12a8159372a4744aed0d" kindref="member">__init__</ref>(self,mesh,nd=3,order=2):</highlight></codeline>
<codeline lineno="4529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Bernstein<sp/>polynomials<sp/>are<sp/>not<sp/>interpolatory.<sp/>Remove<sp/>this<sp/>assert<sp/>to<sp/>use<sp/>p2<sp/>Lagrange<sp/>interpolatory<sp/>conditions&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube" kindref="compound">BernsteinOnCube</ref>(nd,order=2)</highlight></codeline>
<codeline lineno="4531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NOTE:<sp/>Bernstein<sp/>polynomials<sp/>ARE<sp/>NOT<sp/>INTERPOLATORY<sp/>but<sp/>we<sp/>use<sp/>them<sp/>as<sp/>control<sp/>points<sp/>to<sp/>create<sp/>a<sp/>bezier<sp/>curve.<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeCubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d0d/classproteus_1_1FemTools_1_1ParametricMaps" kindref="compound">ParametricMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d86/classproteus_1_1FemTools_1_1LagrangeOnCubeWithNodalBasis" kindref="compound">LagrangeOnCubeWithNodalBasis</ref>(nd,order=mesh.px)),</highlight></codeline>
<codeline lineno="4539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" kindref="compound">QuadraticLagrangeCubeDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="4540"><highlight class="normal"></highlight></codeline>
<codeline lineno="4541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;C0_BernsteinOnCubeWithNodalBasis&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(mesh.px)</highlight></codeline>
<codeline lineno="4543"><highlight class="normal"></highlight></codeline>
<codeline lineno="4544" refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube" kindref="compound">C0_AffineBernsteinOnCube</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="4545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4546"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Bernstein<sp/>CG<sp/>space.</highlight></codeline>
<codeline lineno="4547"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>C0</highlight></codeline>
<codeline lineno="4548"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="4549"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>linear<sp/>affine<sp/>mapping.<sp/>The<sp/>Bernstein<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="4550"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1ab64429e65c2c4f717df6d5456b78ba55" kindref="member">__init__</ref>(self,mesh,nd=3,order=2):</highlight></codeline>
<codeline lineno="4552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a932b7d15b2ee42d6cdfb9cc90fc62e96" kindref="member">order</ref><sp/>=<sp/>order</highlight></codeline>
<codeline lineno="4553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace=<sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="4554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#todo<sp/>fix<sp/>these<sp/>interpolation<sp/>conditions<sp/>to<sp/>work<sp/>on<sp/>Cube</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="4556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a932b7d15b2ee42d6cdfb9cc90fc62e96" kindref="member">order</ref>==2:</highlight></codeline>
<codeline lineno="4557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d0/d36/classproteus_1_1FemTools_1_1BernsteinOnCube" kindref="compound">BernsteinOnCube</ref>(nd,order=2)</highlight></codeline>
<codeline lineno="4558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NOTE:<sp/>Bernstein<sp/>polynomials<sp/>ARE<sp/>NOT<sp/>INTERPOLATORY<sp/>but<sp/>we<sp/>use<sp/>them<sp/>as<sp/>control<sp/>points<sp/>to<sp/>create<sp/>a<sp/>bezier<sp/>curve.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d5/da7/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeCubeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#elif<sp/>self.order==1:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#localFunctionSpace<sp/>=<sp/>LagrangeOnCubeWithNodalBasis(nd,order=1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolationConditions<sp/>=<sp/>CubeNodalInterpolationConditions(localFunctionSpace.referenceElement)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError<sp/>(</highlight><highlight class="stringliteral">&quot;Lagrange<sp/>factory<sp/>only<sp/>implemented<sp/>for<sp/>Q2&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;elements<sp/>so<sp/>far.<sp/>For<sp/>Q1<sp/>use<sp/>C0_AffineLinearOnCubeWithNodalBasis.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace.referenceElement,</highlight></codeline>
<codeline lineno="4571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="df/d28/classproteus_1_1FemTools_1_1LinearOnCubeWithNodalBasis" kindref="compound">LinearOnCubeWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d9/dfa/classproteus_1_1FemTools_1_1QuadraticLagrangeCubeDOFMap" kindref="compound">QuadraticLagrangeCubeDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="4573"><highlight class="normal"></highlight></codeline>
<codeline lineno="4574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="4575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="4576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x_j<sp/>=<sp/>interpolationConditions.quadraturePointArray[j]</highlight></codeline>
<codeline lineno="4577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi_ij<sp/>=<sp/>localFunctionSpace.basis[i](x_j)</highlight></codeline>
<codeline lineno="4578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>i,j,x_j,psi_ij</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="4581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a3d03e4315c2b704ee49fbe823c7f608a" kindref="member">XdmfWriter</ref>=<ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="4582"><highlight class="normal"></highlight></codeline>
<codeline lineno="4583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a2fb771d18614de69c3d1168972ae56e3" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="4584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a932b7d15b2ee42d6cdfb9cc90fc62e96" kindref="member">order</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a3d03e4315c2b704ee49fbe823c7f608a" kindref="member">XdmfWriter</ref>.writeMeshXdmf_C0Q2Lagrange(ar,name,mesh=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>,spaceDim=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="4586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="4587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="4588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>NotImplementedError<sp/>(</highlight><highlight class="stringliteral">&quot;Lagrange<sp/>factory<sp/>only<sp/>implemented<sp/>for<sp/>Q2&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;elements<sp/>so<sp/>far.<sp/>For<sp/>Q1<sp/>use<sp/>C0_AffineLinearOnCubeWithNodalBasis.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4591"><highlight class="normal"></highlight></codeline>
<codeline lineno="4592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a81a79dfccfb2720923d8afad9b081866" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a3d03e4315c2b704ee49fbe823c7f608a" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_C0P2Lagrange(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4594"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a803e89a0473e2ad735369f5f5366c242" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d10/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnCube_1a3d03e4315c2b704ee49fbe823c7f608a" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_nodal(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;c0p2_Lagrange&quot;</highlight><highlight class="normal">,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4596"><highlight class="normal"></highlight></codeline>
<codeline lineno="4597"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Bernstein<sp/>Factory<sp/>On<sp/>Cube</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4598"><highlight class="normal"></highlight><highlight class="comment">#def<sp/>BernsteinCubeFactory(OrderIn):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4599"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>class<sp/>BernsteinCubeOrderN(C0_AffineBernsteinOnCube):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4600"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>__init__(self,mesh,nd):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4601"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C0_AffineBernsteinOnCube.__init__(self,mesh,nd,order=OrderIn)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4602"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>return<sp/>BernsteinCubeOrderN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4603"><highlight class="normal"></highlight></codeline>
<codeline lineno="4604"><highlight class="normal"></highlight><highlight class="comment">#<sp/>TODO<sp/>-<sp/>migrate<sp/>Q1<sp/>to<sp/>an<sp/>instance<sp/>of<sp/>BernsteinCubeFactor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4605"><highlight class="normal"></highlight><highlight class="comment">#Q1<sp/>=<sp/>C0_AffineLinearOnCubeWithNodalBasis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4606"><highlight class="normal"></highlight><highlight class="comment">#Q2<sp/>=<sp/>BernsteinCubeFactory(2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4607"><highlight class="normal"></highlight></codeline>
<codeline lineno="4608" refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="4609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a5cf0a1d0e152e16536fc0c03a789f4c1" kindref="member">__init__</ref>(self,mesh,nd=3,k=0):</highlight></codeline>
<codeline lineno="4610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d5/d74/classproteus_1_1FemTools_1_1Monomials" kindref="compound">Monomials</ref>(nd,k)</highlight></codeline>
<codeline lineno="4611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="df/da1/classproteus_1_1FemTools_1_1MonomialInterpolationConditions" kindref="compound">MonomialInterpolationConditions</ref>(localFunctionSpace.referenceElement,localFunctionSpace)</highlight></codeline>
<codeline lineno="4612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" kindref="compound">DiscontinuousGalerkinDOFMap</ref>(mesh,localFunctionSpace))</highlight></codeline>
<codeline lineno="4619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="4622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ab493e0739b40692046f0e92fd2cb2203" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="4623"><highlight class="normal"></highlight></codeline>
<codeline lineno="4624"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1abbcb434f26779876c7d42496e8d9bdc3" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="4625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1abbcb434f26779876c7d42496e8d9bdc3" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight><highlight class="comment">#need<sp/>to<sp/>allow<sp/>paraview<sp/>to<sp/>even<sp/>read<sp/>in<sp/>quadpoint<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4626"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a0fca3a42892bed4a94ab3eb93404a95e" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="4627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a454110f2fbc6b820a01882b432cc55ff" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>hack,<sp/>to<sp/>allow<sp/>for<sp/>output<sp/>from<sp/>quadrature<sp/>arrays<sp/>even<sp/>if<sp/>not<sp/>plotting<sp/>solution<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nOutput+=<sp/>1</highlight></codeline>
<codeline lineno="4631"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ac133ed748789214390eb1e4a9d77144a" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a06619e1d7209d01e18308997ff53db15" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="4634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4635"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="4636"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="4637"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4638"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Warning,<sp/>currently<sp/>has<sp/>to<sp/>compute<sp/>values<sp/>at<sp/>interpolation<sp/>points!</highlight></codeline>
<codeline lineno="4639"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tries<sp/>to<sp/>use<sp/>basis<sp/>values<sp/>at<sp/>interpolation<sp/>points<sp/>if<sp/>in<sp/>u</highlight></codeline>
<codeline lineno="4640"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="4643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="4644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="4645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4651"><highlight class="normal"></highlight></codeline>
<codeline lineno="4652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;basisValuesAtInterpolationPoints&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="4654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/>u.basisValuesAtInterpolationPoints</highlight></codeline>
<codeline lineno="4655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="4657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1],</highlight></codeline>
<codeline lineno="4658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="4659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.getBasisValues(u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray,</highlight></codeline>
<codeline lineno="4661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints)</highlight></codeline>
<codeline lineno="4662"><highlight class="normal"></highlight></codeline>
<codeline lineno="4663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValuesArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;interpolationValuesArray&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="4665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="4666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1]),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.getValues(u.basisValuesAtInterpolationPoints,u.interpolationValuesArray)</highlight></codeline>
<codeline lineno="4668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="4669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/>Viewers.MatlabWriter(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="4670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_MonomialDGPK(fout,</highlight></codeline>
<codeline lineno="4671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="4672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="4673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="4674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints,</highlight></codeline>
<codeline lineno="4675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray,</highlight></codeline>
<codeline lineno="4676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="4677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="4678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="4679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="4680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="4681"><highlight class="normal"></highlight></codeline>
<codeline lineno="4682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="4683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="4685"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a5aae32c7d62c5ac533c795de4c6656c3" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="4686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeMeshXdmf_MonomialDGPK(ar,self.elementMaps.mesh,self.nSpace_global,</highlight></codeline>
<codeline lineno="4687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.interpolationPoints,</highlight></codeline>
<codeline lineno="4688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="4689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ad605cf8437137d3b6f32f8fa0b7caea7" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4691"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>much<sp/>choice<sp/>except<sp/>to<sp/>get<sp/>u<sp/>values<sp/>at<sp/>interpolation<sp/>points?</highlight></codeline>
<codeline lineno="4692"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;basisValuesAtInterpolationPoints&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="4695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/>u.basisValuesAtInterpolationPoints</highlight></codeline>
<codeline lineno="4696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="4698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1],</highlight></codeline>
<codeline lineno="4699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="4700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.getBasisValues(u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray,</highlight></codeline>
<codeline lineno="4702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints)</highlight></codeline>
<codeline lineno="4703"><highlight class="normal"></highlight></codeline>
<codeline lineno="4704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValuesArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;interpolationValuesArray&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="4706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="4707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1]),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.getValues(u.basisValuesAtInterpolationPoints,u.interpolationValuesArray)</highlight></codeline>
<codeline lineno="4709"><highlight class="normal"></highlight></codeline>
<codeline lineno="4710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeFunctionXdmf_MonomialDGPK(ar,u.interpolationValuesArray,u.name,tCount=tCount,init=init,<sp/>mesh=u.femSpace.mesh)</highlight></codeline>
<codeline lineno="4711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1a78913907345069b3dd23700047fbdec0" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4714"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;Monomial<sp/>DGPK<sp/>writeVectorFunctionXdmf<sp/>not<sp/>implemented<sp/>yet&quot;</highlight><highlight class="normal">,level=1)</highlight></codeline>
<codeline lineno="4716"><highlight class="normal"></highlight></codeline>
<codeline lineno="4717" refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP0_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4718"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1a0db2a648f88a83af315667906bc1c4ca" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,0)</highlight></codeline>
<codeline lineno="4720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1a3f8c826b3c234b62e21878ce66581b21" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="4721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1a3f8c826b3c234b62e21878ce66581b21" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight></codeline>
<codeline lineno="4722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1aaa25f5341f4252e159714e67109adbf1" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4740"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1ae5d0765c178c44f52a3c89abc7370ed9" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_average&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_jump&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4763"><highlight class="normal"></highlight></codeline>
<codeline lineno="4764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="4784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="4785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="4786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="4787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="4788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="4789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_element):</highlight></codeline>
<codeline lineno="4790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="4791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[eN]</highlight></codeline>
<codeline lineno="4792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="4793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="4794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="4795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="4796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="4797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="4798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="4799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="4800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_average[n])</highlight></codeline>
<codeline lineno="4801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_jump_max[n])</highlight></codeline>
<codeline lineno="4802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="4804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="4805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="4806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="4807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.close()</highlight></codeline>
<codeline lineno="4808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.close()</highlight></codeline>
<codeline lineno="4809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="4810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1a6deb5a8ac573d376e5610510b20ad540" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="4811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ab493e0739b40692046f0e92fd2cb2203" kindref="member">XdmfWriter</ref>.writeMeshXdmf_DGP0(ar,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh,</highlight></codeline>
<codeline lineno="4812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="4813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="4814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="4815"><highlight class="normal"></highlight></codeline>
<codeline lineno="4816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1a91d7c99166e9e5c2c375c68f2be4a679" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ab493e0739b40692046f0e92fd2cb2203" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_DGP0(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4818"><highlight class="normal"></highlight></codeline>
<codeline lineno="4819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1ac0ed03d3c73b11f099fc318200005788" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="4820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis_1ab493e0739b40692046f0e92fd2cb2203" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_DGP0(ar,uList,components,vectorName,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="4821"><highlight class="normal"></highlight></codeline>
<codeline lineno="4822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d1f/classproteus_1_1FemTools_1_1DG__AffineP0__OnSimplexWithMonomialBasis_1ad6a4f4039adef8d2f177f1f0fdb16e91" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="4823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4824"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.computeC0P1InterpolantDGP0(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="4826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementOffsets,</highlight></codeline>
<codeline lineno="4827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementsArray,</highlight></codeline>
<codeline lineno="4828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g,</highlight></codeline>
<codeline lineno="4829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof,</highlight></codeline>
<codeline lineno="4830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues,</highlight></codeline>
<codeline lineno="4831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof)</highlight></codeline>
<codeline lineno="4832"><highlight class="normal"></highlight></codeline>
<codeline lineno="4833" refid="df/dd4/classproteus_1_1FemTools_1_1DG__AffineP1__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="df/dd4/classproteus_1_1FemTools_1_1DG__AffineP1__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP1_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="df/dd4/classproteus_1_1FemTools_1_1DG__AffineP1__OnSimplexWithMonomialBasis_1a2b96d96b9877f3906e1dba43c0035a83" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,1)</highlight></codeline>
<codeline lineno="4836" refid="da/d86/classproteus_1_1FemTools_1_1DG__AffineP2__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/d86/classproteus_1_1FemTools_1_1DG__AffineP2__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP2_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/d86/classproteus_1_1FemTools_1_1DG__AffineP2__OnSimplexWithMonomialBasis_1aefe092bf360feaca43dcba376f393dbd" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,2)</highlight></codeline>
<codeline lineno="4839" refid="d2/d78/classproteus_1_1FemTools_1_1DG__AffineP3__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d2/d78/classproteus_1_1FemTools_1_1DG__AffineP3__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP3_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d2/d78/classproteus_1_1FemTools_1_1DG__AffineP3__OnSimplexWithMonomialBasis_1a6a8597cfb225626925977aca3c21a7c8" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,3)</highlight></codeline>
<codeline lineno="4842" refid="de/de8/classproteus_1_1FemTools_1_1DG__AffineP4__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="de/de8/classproteus_1_1FemTools_1_1DG__AffineP4__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP4_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/de8/classproteus_1_1FemTools_1_1DG__AffineP4__OnSimplexWithMonomialBasis_1a90e26e3e91f541a23b318cb0ede2acc3" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,4)</highlight></codeline>
<codeline lineno="4845" refid="d4/d79/classproteus_1_1FemTools_1_1DG__AffineP5__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/d79/classproteus_1_1FemTools_1_1DG__AffineP5__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP5_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d79/classproteus_1_1FemTools_1_1DG__AffineP5__OnSimplexWithMonomialBasis_1a782dca2fd919174f88b49c9322f7718e" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,5)</highlight></codeline>
<codeline lineno="4848" refid="dd/d09/classproteus_1_1FemTools_1_1DG__AffineP6__OnSimplexWithMonomialBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dd/d09/classproteus_1_1FemTools_1_1DG__AffineP6__OnSimplexWithMonomialBasis" kindref="compound">DG_AffineP6_OnSimplexWithMonomialBasis</ref>(<ref refid="d2/d42/classproteus_1_1FemTools_1_1DG__AffinePolynomialsOnSimplexWithMonomialBasis" kindref="compound">DG_AffinePolynomialsOnSimplexWithMonomialBasis</ref>):</highlight></codeline>
<codeline lineno="4849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/d09/classproteus_1_1FemTools_1_1DG__AffineP6__OnSimplexWithMonomialBasis_1a0f32610b5272d585014c14be45848893" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DG_AffinePolynomialsOnSimplexWithMonomialBasis.__init__(self,mesh,nd,6)</highlight></codeline>
<codeline lineno="4851"><highlight class="normal"></highlight></codeline>
<codeline lineno="4852" refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis" kindref="compound">DG_AffineLinearOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="4853"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="4854"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>linear<sp/>DG<sp/>space<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="4855"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4856"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>piecewise<sp/>continuous.</highlight></codeline>
<codeline lineno="4857"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="4858"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>piecewise<sp/>linear,<sp/>continuous,<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="4859"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>mwf/cek</highlight></codeline>
<codeline lineno="4860"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4861"><highlight class="normal"></highlight></codeline>
<codeline lineno="4862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a79b98ff6bfb6f57b445f6afb5950487c" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="4863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="4864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="4865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="4866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="4867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="4868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="4869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="4870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="4871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" kindref="compound">DiscontinuousGalerkinDOFMap</ref>(mesh,localFunctionSpace))</highlight></codeline>
<codeline lineno="4872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="4875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a15c7cd0674812010327c7e99a41aebb2" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="4876"><highlight class="normal"></highlight></codeline>
<codeline lineno="4877"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1ac883fbe6d6ab2878df0373ecf9584043" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="4878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Gnuplot</highlight></codeline>
<codeline lineno="4879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="4891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.viewer(&quot;set<sp/>terminal<sp/>x11&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="4894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="4895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="4896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="4897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="4898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="4899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="4900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,i]*u.dim_dof+t</highlight></codeline>
<codeline lineno="4901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="4902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[I]</highlight></codeline>
<codeline lineno="4903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="4904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="4905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="4906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="4907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="4908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="4909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="4910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="4911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="4912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.plot(Gnuplot.Data(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeArray[:,0],</highlight></codeline>
<codeline lineno="4913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average,</highlight></codeline>
<codeline lineno="4914"><highlight class="normal"></highlight></codeline>
<codeline lineno="4915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=u.name))</highlight></codeline>
<codeline lineno="4916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="4917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nx<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global)</highlight></codeline>
<codeline lineno="4918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ny<sp/>=<sp/>nx</highlight></codeline>
<codeline lineno="4919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="4920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="4921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSol<sp/>=<sp/>numpy.reshape(nodal_average,(nx,ny))</highlight></codeline>
<codeline lineno="4922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>parametric&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>data<sp/>style<sp/>lines&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>hidden&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>contour<sp/>base&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.xlabel(</highlight><highlight class="stringliteral">&apos;x&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.ylabel(</highlight><highlight class="stringliteral">&apos;y&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.splot(Gnuplot.GridData(nSol,</highlight></codeline>
<codeline lineno="4929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x,</highlight></codeline>
<codeline lineno="4930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,</highlight></codeline>
<codeline lineno="4931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>binary=0,</highlight></codeline>
<codeline lineno="4932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inline=0,</highlight></codeline>
<codeline lineno="4933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=filename))</highlight></codeline>
<codeline lineno="4934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1aba710d09241e8509e604ae48f2a0c5c3" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="4935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1aba710d09241e8509e604ae48f2a0c5c3" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight></codeline>
<codeline lineno="4936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a4e68d3dfd25a2e5c3105c7042201e877" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1accce1b367376698ec927485cd414a82f" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="4955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="4957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="4958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="4969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="4970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_average&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="4976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_jump&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4977"><highlight class="normal"></highlight></codeline>
<codeline lineno="4978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="4985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="4995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="4996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="4997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="4998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="4999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="5000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="5001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="5002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="5003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="5004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,i]*u.dim_dof+t</highlight></codeline>
<codeline lineno="5005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="5006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[I]</highlight></codeline>
<codeline lineno="5007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="5008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="5009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="5010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="5011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="5012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="5013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="5014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="5015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_average[n])</highlight></codeline>
<codeline lineno="5016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_jump_max[n])</highlight></codeline>
<codeline lineno="5017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="5019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="5020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="5021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="5022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.close()</highlight></codeline>
<codeline lineno="5023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.close()</highlight></codeline>
<codeline lineno="5024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="5025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a3d94aaec7d04515f002349b8f1c7d14e" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="5026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5027"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="5028"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="5029"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="5032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="5033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5040"><highlight class="normal"></highlight></codeline>
<codeline lineno="5041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="5042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="dd/d75/classproteus_1_1Viewers_1_1MatlabWriter" kindref="compound">Viewers.MatlabWriter</ref>(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="5043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_LagrangeDGP1(fout,</highlight></codeline>
<codeline lineno="5044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="5045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="5046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="5047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="5048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="5049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="5050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="5051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="5052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="5054"><highlight class="normal"></highlight></codeline>
<codeline lineno="5055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="5056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="5058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a0562fb26a8ed53ed0dd1b922fee33146" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="5059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a15c7cd0674812010327c7e99a41aebb2" kindref="member">XdmfWriter</ref>.writeMeshXdmf_DGP1Lagrange(ar,name,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,</highlight></codeline>
<codeline lineno="5060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.elementNodesArray,</highlight></codeline>
<codeline lineno="5061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="5062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="5063"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5064"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1ad73e91c7b383408d2867c16b35f20b63" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a15c7cd0674812010327c7e99a41aebb2" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_DGP1Lagrange(ar,u,tCount=tCount,init=init,<sp/>dofMap<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>)</highlight></codeline>
<codeline lineno="5066"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1aaf765f94dadfa39fadd1cead4de1663b" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1a15c7cd0674812010327c7e99a41aebb2" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_nodal(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;dgp1_Lagrange&quot;</highlight><highlight class="normal">,tCount=tCount,init=init,<sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>)</highlight></codeline>
<codeline lineno="5068"><highlight class="normal"></highlight></codeline>
<codeline lineno="5069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis_1ac665401cbd9d88e38c855dad1140cd7c" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="5070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5071"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculate<sp/>function<sp/>at<sp/>mesh<sp/>nodes<sp/>from<sp/>degrees<sp/>of<sp/>freedom<sp/>defined<sp/>elsewhere</highlight></codeline>
<codeline lineno="5072"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.computeC0P1InterpolantDGP12(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="5074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementOffsets,</highlight></codeline>
<codeline lineno="5075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementsArray,</highlight></codeline>
<codeline lineno="5076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g,</highlight></codeline>
<codeline lineno="5077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof,</highlight></codeline>
<codeline lineno="5078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues,</highlight></codeline>
<codeline lineno="5079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof)</highlight></codeline>
<codeline lineno="5080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="5081" refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis" kindref="compound">C0_AffineQuadraticOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="5082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5083"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>quadratic<sp/>C0<sp/>space<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="5084"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5085"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>piecewise<sp/>continuous.</highlight></codeline>
<codeline lineno="5086"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="5087"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>piecewise<sp/>linear,<sp/>continuous,<sp/>affine<sp/>mapping.</highlight></codeline>
<codeline lineno="5088"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="5089"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5090"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1ac5f35b4d4dd0c07903c585012b2f9d05" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="5091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1ab0e3eefa3c7d368d9826964147d4973d" kindref="member">order</ref><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="5092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis" kindref="compound">QuadraticOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="5095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="5096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="5097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="5098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="5099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace.referenceElement,</highlight></codeline>
<codeline lineno="5100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="5101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" kindref="compound">QuadraticLagrangeDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="5102"><highlight class="normal"></highlight></codeline>
<codeline lineno="5103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="5105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a43c205c1013ab80a6b1be78d6d18ade6" kindref="member">XdmfWriter</ref>=<ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="5106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a8b04b06d70cf7d57fd1965bdb8c8cb4f" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="5107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>now,<sp/>just<sp/>print<sp/>out<sp/>nodal<sp/>dofs<sp/>for<sp/>vertices</highlight></codeline>
<codeline lineno="5109"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5110"><highlight class="normal"></highlight></codeline>
<codeline lineno="5111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Gnuplot</highlight></codeline>
<codeline lineno="5112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="5124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#self.viewer(&quot;set<sp/>terminal<sp/>x11&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>for<sp/>now<sp/>just<sp/>loop<sp/>over<sp/>vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim4plot<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim+1</highlight></codeline>
<codeline lineno="5127"><highlight class="normal"></highlight></codeline>
<codeline lineno="5128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="5130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="5131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="5132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="5133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="5134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="5135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>for<sp/>now<sp/>just<sp/>loop<sp/>over<sp/>vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>i<sp/>in<sp/>range(self.referenceFiniteElement.localFunctionSpace.dim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(dim4plot):</highlight></codeline>
<codeline lineno="5138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,i]*u.dim_dof+t</highlight></codeline>
<codeline lineno="5139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="5140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[I]</highlight></codeline>
<codeline lineno="5141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="5142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="5143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="5144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="5145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="5146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="5147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="5148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="5149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.plot(Gnuplot.Data(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeArray[:,0],</highlight></codeline>
<codeline lineno="5151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average,</highlight></codeline>
<codeline lineno="5152"><highlight class="normal"></highlight></codeline>
<codeline lineno="5153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=filename))</highlight></codeline>
<codeline lineno="5154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="5155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nx<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global)</highlight></codeline>
<codeline lineno="5156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ny<sp/>=<sp/>nx</highlight></codeline>
<codeline lineno="5157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="5158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="5159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSol<sp/>=<sp/>numpy.reshape(nodal_average,(nx,ny))</highlight></codeline>
<codeline lineno="5160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>parametric&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>data<sp/>style<sp/>lines&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>hidden&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>contour<sp/>base&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.xlabel(</highlight><highlight class="stringliteral">&apos;x&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.ylabel(</highlight><highlight class="stringliteral">&apos;y&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.splot(Gnuplot.GridData(nSol,</highlight></codeline>
<codeline lineno="5167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x,</highlight></codeline>
<codeline lineno="5168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,</highlight></codeline>
<codeline lineno="5169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>binary=0,</highlight></codeline>
<codeline lineno="5170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inline=0,</highlight></codeline>
<codeline lineno="5171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=filename))</highlight></codeline>
<codeline lineno="5172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1ad19e2847b4bdf8cd8ebf61b292fa9345" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="5173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a43c205c1013ab80a6b1be78d6d18ade6" kindref="member">XdmfWriter</ref>.writeMeshXdmf_C0P2Lagrange(ar,name,mesh=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>,spaceDim=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="5174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="5175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="5176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1af65c770085ac72705777d07dcf06d1ae" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="5178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base=1</highlight></codeline>
<codeline lineno="5179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#write<sp/>the<sp/>casefile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;FORMAT\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;type:<sp/>ensight<sp/>gold\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;GEOMETRY\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;model:<sp/>&apos;</highlight><highlight class="normal">+filename+</highlight><highlight class="stringliteral">&apos;.geo\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="5184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut=open(filename+</highlight><highlight class="stringliteral">&apos;.geo&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>3<sp/>Node<sp/>Bar<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;node<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;part<sp/>\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>description:</highlight></codeline>
<codeline lineno="5191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(description+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;A<sp/>Mesh\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a8ace1789e7f42895a7b42b57fd14467b" kindref="member">dim</ref>)</highlight></codeline>
<codeline lineno="5195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh</highlight></codeline>
<codeline lineno="5196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lagrangeNodesArray<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.lagrangeNodesArray</highlight></codeline>
<codeline lineno="5197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>fix<sp/>lagrange<sp/>nodes<sp/>format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(i<sp/>+<sp/>base))</highlight></codeline>
<codeline lineno="5201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,0])</highlight></codeline>
<codeline lineno="5204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,1])</highlight></codeline>
<codeline lineno="5207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,2])</highlight></codeline>
<codeline lineno="5210"><highlight class="normal"></highlight></codeline>
<codeline lineno="5211"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5212"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5213"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(nN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5214"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5215"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(mesh.nNodes_global<sp/>+<sp/>eN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5216"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5217"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5218"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5219"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5220"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5221"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5222"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5223"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5224"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5225"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5226"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5227"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5228"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5229"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5230"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;bar3\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(eN+base))</highlight></codeline>
<codeline lineno="5234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i%10i%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>tuple(base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,j]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim))</highlight></codeline>
<codeline lineno="5236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="5237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>6<sp/>Node<sp/>Triangular<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;node<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;part<sp/>\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>description:</highlight></codeline>
<codeline lineno="5242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(description+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;A<sp/>Mesh\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a8ace1789e7f42895a7b42b57fd14467b" kindref="member">dim</ref>)</highlight></codeline>
<codeline lineno="5246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh</highlight></codeline>
<codeline lineno="5247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lagrangeNodesArray<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.lagrangeNodesArray</highlight></codeline>
<codeline lineno="5248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>fix<sp/>lagrange<sp/>nodes<sp/>format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(i<sp/>+<sp/>base))</highlight></codeline>
<codeline lineno="5252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,0])</highlight></codeline>
<codeline lineno="5255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,1])</highlight></codeline>
<codeline lineno="5258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,2])</highlight></codeline>
<codeline lineno="5261"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5262"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5263"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(nN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5264"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5265"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(mesh.nNodes_global<sp/>+<sp/>ebN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5266"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5267"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5268"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5269"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5270"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5271"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5272"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5273"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5274"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5275"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5276"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5277"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5278"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5279"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5280"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;tria6\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(eN+base))</highlight></codeline>
<codeline lineno="5284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i%10i%10i%10i%10i%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>tuple(base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,j]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim))</highlight></codeline>
<codeline lineno="5286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="5287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>10<sp/>Node<sp/>Tetrahedral<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;node<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;part<sp/>\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>description:</highlight></codeline>
<codeline lineno="5292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(description+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;A<sp/>Mesh\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a8ace1789e7f42895a7b42b57fd14467b" kindref="member">dim</ref>)</highlight></codeline>
<codeline lineno="5296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh</highlight></codeline>
<codeline lineno="5297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lagrangeNodesArray<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.lagrangeNodesArray</highlight></codeline>
<codeline lineno="5298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>fix<sp/>lagrange<sp/>nodes<sp/>format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(i<sp/>+<sp/>base))</highlight></codeline>
<codeline lineno="5302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,0])</highlight></codeline>
<codeline lineno="5305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,1])</highlight></codeline>
<codeline lineno="5308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,2])</highlight></codeline>
<codeline lineno="5311"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5312"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5313"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(nN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5314"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nEdges_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5315"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(mesh.nNodes_global<sp/>+<sp/>eN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5316"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5317"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5318"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5319"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nEdges_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5320"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5321"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5322"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5323"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5324"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nEdges_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5325"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5326"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5327"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5328"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5329"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nEdges_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5330"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[eN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;tetra10\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>todo<sp/>fix<sp/>for<sp/>new<sp/>parallel<sp/>numbering</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(eN+base))</highlight></codeline>
<codeline lineno="5335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes=dict([(j,base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,j])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(4)])</highlight></codeline>
<codeline lineno="5338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#brute<sp/>force<sp/>way<sp/>to<sp/>make<sp/>sure<sp/>the<sp/>remaining<sp/>nodes<sp/>are<sp/>in<sp/>the<sp/>right<sp/>order<sp/>to<sp/>describe<sp/>the<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>edgeN_element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(6):</highlight></codeline>
<codeline lineno="5340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edgeN<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,4+edgeN_element]<sp/>-<sp/>mesh.nNodes_global</highlight></codeline>
<codeline lineno="5341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n0<sp/>=<sp/>mesh.edgeNodesArray[edgeN,0]</highlight></codeline>
<codeline lineno="5342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n1<sp/>=<sp/>mesh.edgeNodesArray[edgeN,1]</highlight></codeline>
<codeline lineno="5343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,0]:</highlight></codeline>
<codeline lineno="5344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,1]:</highlight></codeline>
<codeline lineno="5345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+0]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+2]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+3]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,0]:</highlight></codeline>
<codeline lineno="5351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,1]:</highlight></codeline>
<codeline lineno="5352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+0]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+2]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+3]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,1]:</highlight></codeline>
<codeline lineno="5358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+1]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+4]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,1]:</highlight></codeline>
<codeline lineno="5363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+1]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+4]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+5]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>n1<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,2]:</highlight></codeline>
<codeline lineno="5371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n0<sp/>==<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,3]:</highlight></codeline>
<codeline lineno="5372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes[4+5]=base+self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,edgeN_element+4]</highlight></codeline>
<codeline lineno="5373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;fell<sp/>through&quot;</highlight><highlight class="normal">,n0,n1)</highlight></codeline>
<codeline lineno="5375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i%10i%10i%10i%10i%10i%10i%10i%10i%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>tuple(nodes.values()))</highlight></codeline>
<codeline lineno="5376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.close()</highlight></codeline>
<codeline lineno="5377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a313be21c84866ae5978b4ec489717d82" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a68241127ca2dd7b73b38f47e30bd4490" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a43c205c1013ab80a6b1be78d6d18ade6" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_C0P2Lagrange(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="5397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a1af8c4cd1368530119e99484e68d80c3" kindref="member">readFunctionXdmf</ref>(self,ar,u,tCount=0):</highlight></codeline>
<codeline lineno="5398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ar.global_sync:</highlight></codeline>
<codeline lineno="5399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>permute<sp/>=<sp/>np.argsort(u.femSpace.dofMap.subdomain2global)</highlight></codeline>
<codeline lineno="5400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[permute]<sp/>=<sp/>ar.hdfFile[</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)][u.femSpace.dofMap.subdomain2global[permute].tolist()]</highlight></codeline>
<codeline lineno="5401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[:]=ar.hdfFile[</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">+u.name+</highlight><highlight class="stringliteral">&quot;_p&quot;</highlight><highlight class="normal">+repr(ar.comm.rank())+</highlight><highlight class="stringliteral">&quot;_t{0:d}&quot;</highlight><highlight class="normal">.format(tCount)].value</highlight></codeline>
<codeline lineno="5403"><highlight class="normal"></highlight></codeline>
<codeline lineno="5404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1af9bce3cdae6481f4ebd28f7d41bc4891" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a43c205c1013ab80a6b1be78d6d18ade6" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_nodal(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;c0p2_Lagrange&quot;</highlight><highlight class="normal">,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="5406"><highlight class="normal"></highlight></codeline>
<codeline lineno="5407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a40da0a995e45ad88a6fffe204349e720" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5411"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>now<sp/>only<sp/>works<sp/>for<sp/>triangles</highlight></codeline>
<codeline lineno="5412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_average.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_average_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_average.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_jump_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut.write(u.name+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut.write(&apos;part\n&apos;+&apos;%10i\n&apos;<sp/>%<sp/>1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut.write(&apos;coordinates\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut.write(u.name+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut.write(&apos;part\n&apos;+&apos;%10i\n&apos;<sp/>%<sp/>1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut.write(&apos;coordinates\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodal_average<sp/>=<sp/>numpy.zeros((self.elementMaps.mesh.nNodes_global,),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodal_max<sp/>=<sp/>numpy.zeros((self.elementMaps.mesh.nNodes_global,),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodal_min=<sp/>numpy.zeros((self.elementMaps.mesh.nNodes_global,),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodal_jump_max<sp/>=<sp/>numpy.zeros((self.elementMaps.mesh.nNodes_global,),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodal_nDOF<sp/>=<sp/>numpy.zeros((self.elementMaps.mesh.nNodes_global,),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>t<sp/>in<sp/>u.range_dim_dof:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(self.elementMaps.mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#mwf<sp/>for<sp/>now<sp/>just<sp/>loop<sp/>over<sp/>vertices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#for<sp/>i<sp/>in<sp/>range(self.referenceFiniteElement.localFunctionSpace.dim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>i<sp/>in<sp/>range(self.referenceFiniteElement.referenceElement.dim+1):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>self.dofMap.l2g[eN,i]*u.dim_dof+t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.elementMaps.mesh.elementNodesArray[eN,i]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[I]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/>max(nodal_max[n],u_node)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/>min(nodal_min[n],u_node)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>for<sp/>n<sp/>in<sp/>range(self.elementMaps.mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>nodal_average[n])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>nodal_jump_max[n])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if<sp/>u.isVector:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>n<sp/>in<sp/>range(self.elementMaps.mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>0.0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>0.0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut.close()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut.close()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="5494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>n<sp/>in<sp/>u.femSpace.range_dim:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>uOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>u.dof[n*u.dim_dof<sp/>+<sp/>t])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="5498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.femSpace.range_dim:</highlight></codeline>
<codeline lineno="5499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="5500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="5501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="5502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1ab6f003173407f5113d44fe81a96fee49" kindref="member">writeE2VectorFunctionEnsight</ref>(self,u,v,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5504"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old<sp/>ensight<sp/>printing</highlight></codeline>
<codeline lineno="5505"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>nOutput,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="5520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,v.dof,uOut)</highlight></codeline>
<codeline lineno="5521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF_ZEROS(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,uOut)</highlight></codeline>
<codeline lineno="5522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="5523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a455f3010646ff96d937bd7318e13abf3" kindref="member">writeE2VectorFunctionHeaderEnsight</ref>(self,u,v,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="5533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a6ebd7f0fc3841fe749dd4d05a5fef8fe" kindref="member">writeE3VectorFunctionEnsight</ref>(self,u,v,w,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>nOutput,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(u.femSpace.dim,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,u.dof,uOut)</highlight></codeline>
<codeline lineno="5548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(v.femSpace.dim,v.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,v.dof,uOut)</highlight></codeline>
<codeline lineno="5549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(w.femSpace.dim,w.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,w.dof,uOut)</highlight></codeline>
<codeline lineno="5550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="5551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a7864da4753d9b7ac7b19aacb0e6f8b18" kindref="member">writeE3VectorFunctionHeaderEnsight</ref>(self,u,v,w,filename,nOutput,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;2<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;2.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="5561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a2ec460a7e7f2ede504ef55acc80e9b4e" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="5562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5563"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="5564"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="5565"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="5568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="5569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5576"><highlight class="normal"></highlight></codeline>
<codeline lineno="5577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="5578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="dd/d75/classproteus_1_1Viewers_1_1MatlabWriter" kindref="compound">Viewers.MatlabWriter</ref>(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="5579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_LagrangeC0P2(fout,</highlight></codeline>
<codeline lineno="5580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="5581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.dofMap.lagrangeNodesArray,u.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="5582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="5583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="5584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="5585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="5586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="5587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="5589"><highlight class="normal"></highlight></codeline>
<codeline lineno="5590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="5591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="5593"><highlight class="normal"></highlight></codeline>
<codeline lineno="5594"><highlight class="normal">P2<sp/>=<sp/>C0_AffineQuadraticOnSimplexWithNodalBasis</highlight></codeline>
<codeline lineno="5595"><highlight class="normal"></highlight></codeline>
<codeline lineno="5596" refid="da/dc1/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnSimplex" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/dc1/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnSimplex" kindref="compound">C0_AffineBernsteinOnSimplex</ref>(<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis" kindref="compound">C0_AffineQuadraticOnSimplexWithNodalBasis</ref>):</highlight></codeline>
<codeline lineno="5597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5598"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>quadratic<sp/>C0<sp/>space<sp/>with<sp/>Bernstein<sp/>basis.</highlight></codeline>
<codeline lineno="5599"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5600"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>piecewise<sp/>continuous.</highlight></codeline>
<codeline lineno="5601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="5602"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>piecewise<sp/>linear,<sp/>continuous,<sp/>affine<sp/>mapping.</highlight></codeline>
<codeline lineno="5603"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="5604"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="5605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/dc1/classproteus_1_1FemTools_1_1C0__AffineBernsteinOnSimplex_1aab65cd0b1cd4895fd31613a9e5272e14" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="5606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1ab0e3eefa3c7d368d9826964147d4973d" kindref="member">order</ref><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="5607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d4/da8/classproteus_1_1FemTools_1_1BernsteinOnSimplex" kindref="compound">BernsteinOnSimplex</ref>(nd)</highlight></codeline>
<codeline lineno="5608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NOTE:<sp/>Bernstein<sp/>polynomials<sp/>ARE<sp/>NOT<sp/>INTERPOLATORY<sp/>but<sp/>we<sp/>use<sp/>them<sp/>as<sp/>control<sp/>points<sp/>to<sp/>create<sp/>a<sp/>bezier<sp/>curve.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="5611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="5612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="5613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="5614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="5615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace.referenceElement,</highlight></codeline>
<codeline lineno="5616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="5617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" kindref="compound">QuadraticLagrangeDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="5618"><highlight class="normal"></highlight></codeline>
<codeline lineno="5619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="5621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/db2/classproteus_1_1FemTools_1_1C0__AffineQuadraticOnSimplexWithNodalBasis_1a43c205c1013ab80a6b1be78d6d18ade6" kindref="member">XdmfWriter</ref>=<ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="5622"><highlight class="normal"></highlight></codeline>
<codeline lineno="5623" refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis" kindref="compound">DG_AffineQuadraticOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="5624"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5625"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>quadratic<sp/>DG<sp/>space<sp/>with<sp/>the<sp/>nodal<sp/>basis.</highlight></codeline>
<codeline lineno="5626"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5627"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Globally<sp/>piecewise<sp/>continuous.<sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the</highlight></codeline>
<codeline lineno="5628"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under<sp/>a<sp/>piecewise<sp/>linear,</highlight></codeline>
<codeline lineno="5629"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>continuous,<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="5630"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="5631"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a70b7fefe7896699855564669c5c80ce1" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="5633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d3/dba/classproteus_1_1FemTools_1_1QuadraticOnSimplexWithNodalBasis" kindref="compound">QuadraticOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d4/def/classproteus_1_1FemTools_1_1QuadraticLagrangeNodalInterpolationConditions" kindref="compound">QuadraticLagrangeNodalInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="5636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="5637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="5638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="5639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="5640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localGeometricSpace.referenceElement,</highlight></codeline>
<codeline lineno="5641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="5642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dc/d6d/classproteus_1_1FemTools_1_1DiscontinuousGalerkinDOFMap" kindref="compound">DiscontinuousGalerkinDOFMap</ref>(mesh,localFunctionSpace))</highlight></codeline>
<codeline lineno="5643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref><sp/>=<sp/><ref refid="d2/df7/classproteus_1_1FemTools_1_1QuadraticLagrangeDOFMap" kindref="compound">QuadraticLagrangeDOFMap</ref>(mesh,localFunctionSpace,nd)</highlight></codeline>
<codeline lineno="5645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="5647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a4e334c23d894764991c8a02e0c8c2273" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="5648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a7e002c8caf68abd17843a3c056c067e1" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="5649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base=1</highlight></codeline>
<codeline lineno="5650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#write<sp/>the<sp/>casefile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;FORMAT\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;type:<sp/>ensight<sp/>gold\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;GEOMETRY\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;model:<sp/>&apos;</highlight><highlight class="normal">+filename+</highlight><highlight class="stringliteral">&apos;.geo\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="5655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut=open(filename+</highlight><highlight class="stringliteral">&apos;.geo&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="5657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>6<sp/>Node<sp/>Triangular<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="5659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>10<sp/>Node<sp/>Tetrahedral<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;Unstructured<sp/>3<sp/>Node<sp/>edge<sp/>Mesh\n\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;node<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>id<sp/>given\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;part<sp/>\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>description:</highlight></codeline>
<codeline lineno="5666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(description+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;A<sp/>Mesh\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.nDOF)</highlight></codeline>
<codeline lineno="5670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh</highlight></codeline>
<codeline lineno="5671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lagrangeNodesArray<sp/>=<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.lagrangeNodesArray</highlight></codeline>
<codeline lineno="5672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>fix<sp/>lagrange<sp/>nodes<sp/>format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(i<sp/>+<sp/>base))</highlight></codeline>
<codeline lineno="5676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,0])</highlight></codeline>
<codeline lineno="5679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,1])</highlight></codeline>
<codeline lineno="5682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(lagrangeNodesArray.shape[0]):</highlight></codeline>
<codeline lineno="5684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%12.5E\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>lagrangeNodesArray[i,2])</highlight></codeline>
<codeline lineno="5685"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>#node<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5686"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5687"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(nN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5688"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5689"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%10i\n&apos;<sp/>%<sp/>(mesh.nNodes_global<sp/>+<sp/>ebN<sp/>+<sp/>base))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5690"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>#x-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5691"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5692"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5693"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5694"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,0])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5695"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>#y-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5696"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5697"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5698"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5699"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,1])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5700"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>#z-coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5701"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>nN<sp/>in<sp/>range(mesh.nNodes_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5702"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>mesh.nodeArray[nN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5703"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>ebN<sp/>in<sp/>range(mesh.nElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5704"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(&apos;%12.5E\n&apos;<sp/>%<sp/>lagrangeNodesArray[ebN,2])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="5707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;tria6\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="5709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;tetra10\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;bar3\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>mesh.nElements_global)</highlight></codeline>
<codeline lineno="5712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(eN+base))</highlight></codeline>
<codeline lineno="5714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elemString<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%10i&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim-1):</highlight></codeline>
<codeline lineno="5716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elemString<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;%10i&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elemString<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="5719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#meshOut.write(&apos;%10i%10i%10i%10i%10i%10i\n&apos;<sp/>%<sp/>tuple(base+self.CGDOFMap.l2g[eN,j]<sp/>for<sp/>j<sp/>in<sp/>self.referenceFiniteElement.localFunctionSpace.range_dim))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.write(elemString<sp/>%<sp/>tuple(base+self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.l2g[eN,j]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.range_dim))</highlight></codeline>
<codeline lineno="5721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>meshOut.close()</highlight></codeline>
<codeline lineno="5722"><highlight class="normal"></highlight></codeline>
<codeline lineno="5723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a781c3f8af0fe33e2bba2ed27930ea212" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="5724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Gnuplot</highlight></codeline>
<codeline lineno="5725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="5734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="5737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>added<sp/>terminal<sp/>cmd</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&quot;set<sp/>terminal<sp/>x11&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="5741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="5742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="5743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="5744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="5745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="5746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>i<sp/>in<sp/>range(self.referenceFiniteElement.localFunctionSpace.dim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim+1):</highlight></codeline>
<codeline lineno="5748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,i]*u.dim_dof+t</highlight></codeline>
<codeline lineno="5749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="5750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>u.dof[I]</highlight></codeline>
<codeline lineno="5751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="5752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="5753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="5754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="5755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="5756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="5757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="5758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="5759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.plot(Gnuplot.Data(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeArray[:,0],</highlight></codeline>
<codeline lineno="5761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average,</highlight></codeline>
<codeline lineno="5762"><highlight class="normal"></highlight></codeline>
<codeline lineno="5763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=u.name))</highlight></codeline>
<codeline lineno="5764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="5765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nx<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global)</highlight></codeline>
<codeline lineno="5766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ny<sp/>=<sp/>nx</highlight></codeline>
<codeline lineno="5767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="5768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>old_div(numpy.arange(nx,dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">),float(nx-1))</highlight></codeline>
<codeline lineno="5769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSol<sp/>=<sp/>numpy.reshape(nodal_average,(nx,ny))</highlight></codeline>
<codeline lineno="5770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>parametric&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>data<sp/>style<sp/>lines&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>hidden&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>(</highlight><highlight class="stringliteral">&apos;set<sp/>contour<sp/>base&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.xlabel(</highlight><highlight class="stringliteral">&apos;x&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.ylabel(</highlight><highlight class="stringliteral">&apos;y&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a3f571e7d3197489df2eb011a9ccdcda0" kindref="member">viewer</ref>.splot(Gnuplot.GridData(nSol,</highlight></codeline>
<codeline lineno="5777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x,</highlight></codeline>
<codeline lineno="5778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,</highlight></codeline>
<codeline lineno="5779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>binary=0,</highlight></codeline>
<codeline lineno="5780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inline=0))</highlight></codeline>
<codeline lineno="5781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a1e452a6110a25e3c46288dcf03b1cb5e" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_average.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="5804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_average_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_average.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_jump_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1ac270e53f52df33b15a6615b7e551f267" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="5813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5814"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>now<sp/>only<sp/>works<sp/>for<sp/>triangles</highlight></codeline>
<codeline lineno="5815"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="5818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if<sp/>not<sp/>append:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>caseOut=open(case_filename+&apos;.case&apos;,&apos;a&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>if<sp/>firstVariable==True:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(&apos;VARIABLE\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>caseOut.write(&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;.vec****\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_average.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;VARIABLE\n&apos;+&apos;vector<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.vec\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.vec&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if<sp/>not<sp/>append:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>caseOut=open(case_filename+&apos;.case&apos;,&apos;a&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>caseOut.write(&apos;VARIABLE\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>u.range_dim_dof:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&apos;<sp/>&apos;+filename+u.name+&apos;.scl****\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_average_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_average.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#caseOut.write(&apos;scalar<sp/>per<sp/>node:<sp/>&apos;+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+&quot;_jump_&quot;+`t`+&apos;<sp/>&apos;+filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`+&apos;\n&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#AverageOut=open(filename+u.name+&apos;_average.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#JumpOut=open(filename+u.name+&apos;_jump_max.scl&apos;+`self.nOutput`,&apos;w&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.nDOF*u.dim_dof,),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>mesh.nElements_node<sp/>deprecated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nElements_node<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global,),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="5851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#first<sp/>do<sp/>triangle<sp/><sp/>node</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN_element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_element):</highlight></codeline>
<codeline lineno="5853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>nN_element</highlight></codeline>
<codeline lineno="5854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_cg<sp/>=<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="5855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nN<sp/>=<sp/>J_cg</highlight></codeline>
<codeline lineno="5856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_dg<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,j]</highlight></codeline>
<codeline lineno="5857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nDOF_node<sp/>=<sp/>float(self.elementMaps.mesh.nElements_node[nN])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nElements_node[nN]<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="5859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[J_cg]<sp/>+=<sp/>u.dof[J_dg]</highlight><highlight class="comment">#/nDOF_node</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#now<sp/>do<sp/>edge<sp/>nodes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.nNodes_global):</highlight></codeline>
<codeline lineno="5863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[nN]<sp/>/=<sp/>float(nElements_node[nN])</highlight></codeline>
<codeline lineno="5864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh</highlight></codeline>
<codeline lineno="5865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNI<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nInteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="5866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.interiorElementBoundariesArray[ebNI]</highlight></codeline>
<codeline lineno="5867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_eN_global<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="5868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_eN_global<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,1]</highlight></codeline>
<codeline lineno="5869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="5870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN,1]</highlight></codeline>
<codeline lineno="5871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_j_element<sp/>=<sp/>(left_ebN_element+1)%3<sp/>+<sp/>mesh.nNodes_element<sp/></highlight><highlight class="comment">#needs<sp/>to<sp/>be<sp/>fixed<sp/>for<sp/>1d,<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_j_element<sp/>=(right_ebN_element+1)%3<sp/>+<sp/>mesh.nNodes_element</highlight><highlight class="comment">#needs<sp/>to<sp/>be<sp/>fixed<sp/>for<sp/>1d,<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_J_cg<sp/>=<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.l2g[left_eN_global,left_j_element]</highlight></codeline>
<codeline lineno="5874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_J_dg<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[left_eN_global,left_j_element]</highlight></codeline>
<codeline lineno="5875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_J_cg<sp/>=<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.l2g[right_eN_global,right_j_element]</highlight></codeline>
<codeline lineno="5876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_J_dg<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[right_eN_global,right_j_element]</highlight></codeline>
<codeline lineno="5877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>left_J_cg<sp/>!=<sp/>right_J_cg:</highlight></codeline>
<codeline lineno="5878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;problem<sp/>in<sp/>DGAffineQuadratic<sp/>writeFunctionEnsight&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[left_J_cg*u.dim_dof<sp/>+<sp/>t]<sp/>=<sp/>0.5*(u.dof[left_J_dg*u.dim_dof<sp/>+<sp/>t]</highlight></codeline>
<codeline lineno="5881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+</highlight></codeline>
<codeline lineno="5882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[right_J_dg*u.dim_dof<sp/>+<sp/>t])</highlight></codeline>
<codeline lineno="5883"><highlight class="normal"></highlight></codeline>
<codeline lineno="5884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="5885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="5886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_global<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="5887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="5888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j_element<sp/>=<sp/>(ebN_element+1)%3<sp/>+<sp/>mesh.nNodes_element</highlight></codeline>
<codeline lineno="5889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_cg<sp/>=<sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.l2g[eN_global,j_element]</highlight></codeline>
<codeline lineno="5890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_dg<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN_global,j_element]</highlight></codeline>
<codeline lineno="5891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[J_cg*u.dim_dof<sp/>+<sp/>t]<sp/>=<sp/>u.dof[J_dg*u.dim_dof<sp/>+<sp/>t]</highlight></codeline>
<codeline lineno="5893"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>eN<sp/>in<sp/>range(mesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5894"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>j<sp/>in<sp/>range(mesh.nNodes_element,self.referenceFiniteElement.localFunctionSpace.dim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5895"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_cg<sp/>=<sp/>self.CGDOFMap.l2g[eN,j]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5896"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J_dg<sp/>=<sp/>self.dofMap.l2g[eN,j]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5897"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#find<sp/>element<sp/><sp/>boundary<sp/>number<sp/><sp/>using<sp/>Farthing&apos;s<sp/>rule</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5898"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_element<sp/><sp/>=<sp/>(j-1)%3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5899"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>t<sp/>in<sp/>u.range_dim_dof:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5900"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[J_cg*u.dim_dof<sp/>+<sp/>t]<sp/>+=<sp/>u.dof[J_dg*u.dim_dof<sp/>+<sp/>t]*0.5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="5903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="5905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.writeDOF(self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.nDOF,u.dim_dof,t,</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal">,nodal_average,uOut)</highlight></codeline>
<codeline lineno="5906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>J<sp/>in<sp/>range(self.CGDOFMap.nDOF):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>uOut.write(&apos;%12.5e\n&apos;<sp/>%<sp/>nodal_average[J*u.dim_dof<sp/>+<sp/>t])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="5910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>J<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>.nDOF):</highlight></codeline>
<codeline lineno="5911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="5912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uOut.close()</highlight></codeline>
<codeline lineno="5913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="5914"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1abc89cb7729c94098cc5217b7a354d12e" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="5915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5916"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="5917"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="5918"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="5920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="5921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="5922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="5924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="5928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5929"><highlight class="normal"></highlight></codeline>
<codeline lineno="5930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="5931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="dd/d75/classproteus_1_1Viewers_1_1MatlabWriter" kindref="compound">Viewers.MatlabWriter</ref>(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="5932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_LagrangeDGP2(fout,</highlight></codeline>
<codeline lineno="5933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="5934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="5935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="5936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.CGDOFMap.lagrangeNodesArray,</highlight></codeline>
<codeline lineno="5937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="5938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.CGDOFMap.l2g,</highlight></codeline>
<codeline lineno="5939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="5940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="5941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="5942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="5943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="5944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="5945"><highlight class="normal"></highlight></codeline>
<codeline lineno="5946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="5947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="5949"><highlight class="normal"></highlight></codeline>
<codeline lineno="5950"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1ab7abc0714a38c8eab7ed30bf82f16b27" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="5951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a4e334c23d894764991c8a02e0c8c2273" kindref="member">XdmfWriter</ref>.writeMeshXdmf_DGP2Lagrange(ar,name,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="5952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1aaee24c852e7469e50310241dacbe1045" kindref="member">CGDOFMap</ref>,t=t,</highlight></codeline>
<codeline lineno="5953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>init=init,meshChanged=meshChanged,arGrid=arGrid,</highlight></codeline>
<codeline lineno="5954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tCount=tCount)</highlight></codeline>
<codeline lineno="5955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a74f8264e996df960fda1800a9d96dbfe" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a4e334c23d894764991c8a02e0c8c2273" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_DGP2Lagrange(ar,u,tCount=tCount,init=init,<sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>)</highlight></codeline>
<codeline lineno="5958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1ab3aa32d577a22a070ab0a1cbc91b6f27" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="5959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a4e334c23d894764991c8a02e0c8c2273" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_nodal(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;dgp2_Lagrange&quot;</highlight><highlight class="normal">,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="5960"><highlight class="normal"></highlight></codeline>
<codeline lineno="5961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="de/ded/classproteus_1_1FemTools_1_1DG__AffineQuadraticOnSimplexWithNodalBasis_1a8e1453586ed4dfdac5a4b3e36f7fad97" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="5962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5963"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculate<sp/>solution<sp/>at<sp/>mesh<sp/>nodes<sp/>from<sp/>degrees<sp/>of<sp/>freedom<sp/>defind<sp/>elsewhere.</highlight></codeline>
<codeline lineno="5964"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.computeC0P1InterpolantDGP12(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="5966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementOffsets,</highlight></codeline>
<codeline lineno="5967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementsArray,</highlight></codeline>
<codeline lineno="5968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g,</highlight></codeline>
<codeline lineno="5969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof,</highlight></codeline>
<codeline lineno="5970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues,</highlight></codeline>
<codeline lineno="5971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof)</highlight></codeline>
<codeline lineno="5972" refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis" kindref="compound">NC_AffineLinearOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="5973"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="5974"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Space<sp/>of<sp/>functions<sp/>that<sp/>are<sp/>P^1<sp/>on<sp/>elements<sp/>and<sp/>continuous<sp/>at</highlight></codeline>
<codeline lineno="5975"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>element<sp/>boundary<sp/>barycenters.</highlight></codeline>
<codeline lineno="5976"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5977"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>geometric<sp/>element<sp/>is<sp/>the<sp/>image<sp/>of<sp/>the<sp/>reference<sp/>simplex<sp/>under</highlight></codeline>
<codeline lineno="5978"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a<sp/>linear<sp/>affine<sp/>mapping.<sp/>The<sp/>nodal<sp/>basis<sp/>is<sp/>used<sp/>on<sp/>the<sp/>reference<sp/>simplex.</highlight></codeline>
<codeline lineno="5979"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5980"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1ac2af8ed39ebaefa96fc17f9ef80112f4" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="5981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="dd/d74/classproteus_1_1FemTools_1_1CrouzeixRaviartWithNodalBasis" kindref="compound">CrouzeixRaviartWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="5982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d4/dba/classproteus_1_1FemTools_1_1FaceBarycenterInterpolationConditions" kindref="compound">FaceBarycenterInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="5983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="5984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="5985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="5986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="5987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="5988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="5989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/d45/classproteus_1_1FemTools_1_1ElementBoundaryDOFMap" kindref="compound">ElementBoundaryDOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="5990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="5992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a7b9c0408ded2ec55c205004df1d86bff" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="5993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1ab77e180da327cf1a3a5d0bbc9b47ed3c" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="5994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Gnuplot</highlight></codeline>
<codeline lineno="5995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.referenceElement.dim<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="5996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a1b474e56dbd6f7d5524cfc8083b7e5b5" kindref="member">uPlot</ref><sp/>=<sp/>Gnuplot.Gnuplot()</highlight></codeline>
<codeline lineno="5997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a1b474e56dbd6f7d5524cfc8083b7e5b5" kindref="member">uPlot</ref>(</highlight><highlight class="stringliteral">&quot;set<sp/>terminal<sp/>x11&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="5998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a1b474e56dbd6f7d5524cfc8083b7e5b5" kindref="member">uPlot</ref>.plot(Gnuplot.Data(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeArray[:,0],</highlight></codeline>
<codeline lineno="5999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="6000"><highlight class="normal"></highlight></codeline>
<codeline lineno="6001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title=u.name))</highlight></codeline>
<codeline lineno="6002"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a025148bcf5326e06d52ee62e0d3fe374" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="6003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a025148bcf5326e06d52ee62e0d3fe374" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight></codeline>
<codeline lineno="6004"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a404fcce59df39e0de43bf292cff90dca" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>now<sp/>plotting<sp/>average<sp/>and<sp/>jump<sp/>at<sp/>nodes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="6008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="6023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_average&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_jump&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6027"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a8d0a11a9f1e718f9895b9fa615b80abf" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>case_filename<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>case_filename<sp/>=<sp/>filename</highlight></codeline>
<codeline lineno="6030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>firstVariable==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.vec%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut=open(case_filename+</highlight><highlight class="stringliteral">&apos;.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="6046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_average&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>node:<sp/>&apos;</highlight><highlight class="normal">+</highlight></codeline>
<codeline lineno="6049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.name+</highlight><highlight class="stringliteral">&quot;_jump&quot;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">+filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl****\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6050"><highlight class="normal"></highlight></codeline>
<codeline lineno="6051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_average.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut=open(filename+u.name+</highlight><highlight class="stringliteral">&apos;_jump_max.scl%4.4i&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="6055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(u.name+</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;part\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;%10i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>1)</highlight></codeline>
<codeline lineno="6058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="6060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="6062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="6064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="6066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF<sp/>=<sp/>numpy.zeros((self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global,),</highlight></codeline>
<codeline lineno="6068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/><sp/><sp/><sp/>=<sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.referenceElement.nNodes</highlight></codeline>
<codeline lineno="6070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xiArray<sp/>=<sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.referenceElement.nodeList</highlight></codeline>
<codeline lineno="6071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((n_xi,u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="6072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>udofs<sp/>=<sp/>numpy.zeros(u.femSpace.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="6074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6075"><highlight class="normal"></highlight></codeline>
<codeline lineno="6076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u.range_dim_dof:</highlight></codeline>
<codeline lineno="6077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[:]=0.0</highlight></codeline>
<codeline lineno="6078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[:]=0.0</highlight></codeline>
<codeline lineno="6079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[:]=0.0</highlight></codeline>
<codeline lineno="6080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[:]=0.0</highlight></codeline>
<codeline lineno="6081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[:]=0.0</highlight></codeline>
<codeline lineno="6082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi.flat[:]<sp/>=<sp/>0.0;<sp/>udofs.flat[:]<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="6084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acce40273f0a22aa0bccec4e32144db94" kindref="member">referenceFiniteElement</ref>.localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="6085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g[eN,j]*u.dim_dof+t</highlight></codeline>
<codeline lineno="6086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>udofs[j]<sp/>=<sp/>u.dof[J]</highlight></codeline>
<codeline lineno="6087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(n_xi):</highlight></codeline>
<codeline lineno="6088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi[k,j]<sp/>=<sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.basis[j](xiArray[k])</highlight></codeline>
<codeline lineno="6089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#j</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uatNodes<sp/>=<sp/>numpy.dot(psi,udofs)<sp/></highlight><highlight class="comment">#should<sp/>be<sp/>nNodes<sp/>long</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_element):</highlight></codeline>
<codeline lineno="6093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray[eN,i]</highlight></codeline>
<codeline lineno="6094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_node<sp/>=<sp/>uatNodes[i]</highlight></codeline>
<codeline lineno="6095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>+=<sp/>u_node</highlight></codeline>
<codeline lineno="6096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_nDOF[n]+=1</highlight></codeline>
<codeline lineno="6097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nodal_nDOF[n]<sp/>&gt;=2:</highlight></codeline>
<codeline lineno="6098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_max[n]<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(nodal_max[n],u_node)</highlight></codeline>
<codeline lineno="6099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_min[n]<sp/>=<sp/><ref refid="db/dcc/jf_8h_1ac6afabdc09a49a433ee19d8a9486056d" kindref="member">min</ref>(nodal_min[n],u_node)</highlight></codeline>
<codeline lineno="6100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_jump_max[n]<sp/>=<sp/>nodal_max[n]-nodal_min[n]</highlight></codeline>
<codeline lineno="6101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#eN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="6105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodal_average[n]<sp/>/=<sp/>nodal_nDOF[n]</highlight></codeline>
<codeline lineno="6106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_average[n])</highlight></codeline>
<codeline lineno="6107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>nodal_jump_max[n])</highlight></codeline>
<codeline lineno="6108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(3<sp/>-<sp/>u.dim_dof):</highlight></codeline>
<codeline lineno="6110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nNodes_global):</highlight></codeline>
<codeline lineno="6111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="6112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>0.0)</highlight></codeline>
<codeline lineno="6113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AverageOut.close()</highlight></codeline>
<codeline lineno="6114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JumpOut.close()</highlight></codeline>
<codeline lineno="6115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9998e5571223dc1314d0dda42f438d07" kindref="member">nOutput</ref>+=1</highlight></codeline>
<codeline lineno="6116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1aa797131df71f2011b6e08a3d741b5ff6" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="6117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a7b9c0408ded2ec55c205004df1d86bff" kindref="member">XdmfWriter</ref>.writeMeshXdmf_CrouzeixRaviartP1(ar,self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh,</highlight></codeline>
<codeline lineno="6118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1acbd1255b784d4b2e1b0dc9927ea1bb4d" kindref="member">nSpace_global</ref>,</highlight></codeline>
<codeline lineno="6119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>,</highlight></codeline>
<codeline lineno="6120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="6121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="6122"><highlight class="normal"></highlight></codeline>
<codeline lineno="6123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a41fe2d5134a89ffa446a5f8d2392ae63" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a7b9c0408ded2ec55c205004df1d86bff" kindref="member">XdmfWriter</ref>.writeFunctionXdmf_CrouzeixRaviartP1(ar,u,tCount=tCount,init=init,<sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>)</highlight></codeline>
<codeline lineno="6125"><highlight class="normal"></highlight></codeline>
<codeline lineno="6126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a80cd5290613bc3f321812bf0e3c1ab27" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a7b9c0408ded2ec55c205004df1d86bff" kindref="member">XdmfWriter</ref>.writeVectorFunctionXdmf_CrouzeixRaviartP1(ar,uList,components,vectorName,tCount=tCount,init=init,<sp/>dofMap=self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>)</highlight></codeline>
<codeline lineno="6128"><highlight class="normal"></highlight></codeline>
<codeline lineno="6129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a4806aef569b4a23ed6350cf64dae70f1" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="6130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="6132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="6133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="6136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="6137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6144"><highlight class="normal"></highlight></codeline>
<codeline lineno="6145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="6146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="dd/d75/classproteus_1_1Viewers_1_1MatlabWriter" kindref="compound">Viewers.MatlabWriter</ref>(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="6147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_CrouzeixRaviartP1(fout,</highlight></codeline>
<codeline lineno="6148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="6149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="6150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="6152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="6153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="6154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="6155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="6156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="6158"><highlight class="normal"></highlight></codeline>
<codeline lineno="6159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="6160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="6162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d72/classproteus_1_1FemTools_1_1NC__AffineLinearOnSimplexWithNodalBasis_1a06018fcc04f37b56f6effa608b5aa98a" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="6163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6164"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculate<sp/>function<sp/>at<sp/>mesh<sp/>nodes<sp/>from<sp/>degrees<sp/>of<sp/>freedom<sp/>defined<sp/>elsewhere</highlight></codeline>
<codeline lineno="6165"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.computeC0P1InterpolantNCP1(self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementOffsets,</highlight></codeline>
<codeline lineno="6168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a71b82187ff1664f6795e6d732fdfbbe1" kindref="member">elementMaps</ref>.mesh.nodeElementsArray,</highlight></codeline>
<codeline lineno="6169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a9a5e51f262f32de9eeb6d3fe79eff063" kindref="member">dofMap</ref>.l2g,</highlight></codeline>
<codeline lineno="6170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof,</highlight></codeline>
<codeline lineno="6171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues,</highlight></codeline>
<codeline lineno="6172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof)</highlight></codeline>
<codeline lineno="6173"><highlight class="normal"></highlight><highlight class="comment">#end<sp/>NC</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6174"><highlight class="normal"></highlight></codeline>
<codeline lineno="6175" refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants" kindref="compound">DG_Constants</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="6176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6177"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>constant<sp/>DG<sp/>space</highlight></codeline>
<codeline lineno="6178"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1ac3d7986d0c3b16b21c6dce9ec2cc5911" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="6180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d0/db3/classproteus_1_1FemTools_1_1p0" kindref="compound">p0</ref>(nd)</highlight></codeline>
<codeline lineno="6181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d1/d2b/classproteus_1_1FemTools_1_1p0InterpolationConditions" kindref="compound">p0InterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="6182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="6183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="6184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="6185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="6186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="6187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="6188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d04/classproteus_1_1FemTools_1_1p0DOFMap" kindref="compound">p0DOFMap</ref>(mesh))</highlight></codeline>
<codeline lineno="6189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="6191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a9fabc2ad98719f521c9f709dd9b730b0" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="6192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a0b4ee6a02c8676a997991a7de80514fc" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="6193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a0b4ee6a02c8676a997991a7de80514fc" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight><highlight class="comment">#need<sp/>to<sp/>allow<sp/>paraview<sp/>to<sp/>even<sp/>read<sp/>in<sp/>quadpoint<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a325e8a30908fb6d9aa10a64021a67121" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="6195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a5c281eb52d35be540aa76383b33919d4" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>hack,<sp/>to<sp/>allow<sp/>for<sp/>output<sp/>from<sp/>quadrature<sp/>arrays<sp/>even<sp/>if<sp/>not<sp/>plotting<sp/>solution<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nOutput+=<sp/>1</highlight></codeline>
<codeline lineno="6199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1adf6f9ba4b76e284ea99d8d27ec540f42" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1aa9d37e7e03309ae3cc31de8c4e2db9d9" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="6202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="6204"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="6205"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="6208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="6209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6216"><highlight class="normal"></highlight></codeline>
<codeline lineno="6217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="6218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/>Viewers.MatlabWriter(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="6219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_DGP0(fout,</highlight></codeline>
<codeline lineno="6220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="6221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="6222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.dofMap.l2g,</highlight></codeline>
<codeline lineno="6224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof,</highlight></codeline>
<codeline lineno="6225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="6226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="6227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="6228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="6230"><highlight class="normal"></highlight></codeline>
<codeline lineno="6231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="6232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="6234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a789e0f2e4b9bd09ebf4524c355b933fa" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="6235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeMeshXdmf_DGP0(ar,self.elementMaps.mesh,</highlight></codeline>
<codeline lineno="6236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nSpace_global,</highlight></codeline>
<codeline lineno="6237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,</highlight></codeline>
<codeline lineno="6238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="6239"><highlight class="normal"></highlight></codeline>
<codeline lineno="6240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a7f7e694aaa5eae8a9abb4f526f064654" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeFunctionXdmf_DGP0(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="6242"><highlight class="normal"></highlight></codeline>
<codeline lineno="6243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1a0c5ce78604d51be2bbf4974cbe8ec222" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeVectorFunctionXdmf_DGP0(ar,uList,components,vectorName,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="6245"><highlight class="normal"></highlight></codeline>
<codeline lineno="6246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dc/df8/classproteus_1_1FemTools_1_1DG__Constants_1acfad86e1bbe5bb7483f16f02e76dd3e6" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="6247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Compute<sp/>function<sp/>at<sp/>mesh<sp/>nodes<sp/>from<sp/>degrees<sp/>of<sp/>freedom<sp/>defined<sp/>elsewhere</highlight></codeline>
<codeline lineno="6249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.computeC0P1InterpolantDGP0(self.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.elementMaps.mesh.nodeElementOffsets,</highlight></codeline>
<codeline lineno="6252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.elementMaps.mesh.nodeElementsArray,</highlight></codeline>
<codeline lineno="6253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dofMap.l2g,</highlight></codeline>
<codeline lineno="6254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof,</highlight></codeline>
<codeline lineno="6255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues,</highlight></codeline>
<codeline lineno="6256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof)</highlight></codeline>
<codeline lineno="6257"><highlight class="normal"></highlight></codeline>
<codeline lineno="6258" refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis" kindref="compound">C0_AffineP1BubbleOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="6259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>C0P1<sp/>enriched<sp/>with<sp/>bubble<sp/>functions</highlight></codeline>
<codeline lineno="6261"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1ad93c264b43d06ac9b4dd87ccfac2cbdb" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="6263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="d2/dd8/classproteus_1_1FemTools_1_1P1BubblesWithNodalBasis" kindref="compound">P1BubblesWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="6264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d7/d65/classproteus_1_1FemTools_1_1P1BubbleInterpolationConditions" kindref="compound">P1BubbleInterpolationConditions</ref>(localFunctionSpace.referenceElement)</highlight></codeline>
<codeline lineno="6265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="6266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="6267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="6268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="6269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="6270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="6271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap" kindref="compound">P1BubbleDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="6272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="6275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a5f9f4f3670ceaec62e26cd1653671d3e" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="6276"><highlight class="normal"></highlight></codeline>
<codeline lineno="6277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a52f9b3418d49f16b667d8a34772e0996" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="6278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a52f9b3418d49f16b667d8a34772e0996" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight><highlight class="comment">#need<sp/>to<sp/>allow<sp/>paraview<sp/>to<sp/>even<sp/>read<sp/>in<sp/>quadpoint<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a1d8bde889f8a01335b8f0ee4a92060ba" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="6280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1aa7a9c00a8c97c3ab1ad2995a3fecc4bc" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>hack,<sp/>to<sp/>allow<sp/>for<sp/>output<sp/>from<sp/>quadrature<sp/>arrays<sp/>even<sp/>if<sp/>not<sp/>plotting<sp/>solution<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nOutput+=<sp/>1</highlight></codeline>
<codeline lineno="6284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a32527ecad91b6eb3ce571c3329181ba7" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a48da34572fbcebf4795584423de71bd4" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="6287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="6289"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="6290"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Warning,<sp/>currently<sp/>has<sp/>to<sp/>compute<sp/>values<sp/>at<sp/>interpolation<sp/>points!</highlight></codeline>
<codeline lineno="6292"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tries<sp/>to<sp/>use<sp/>basis<sp/>values<sp/>at<sp/>interpolation<sp/>points<sp/>if<sp/>in<sp/>u</highlight></codeline>
<codeline lineno="6293"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="6296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="6297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6304"><highlight class="normal"></highlight></codeline>
<codeline lineno="6305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;basisValuesAtInterpolationPoints&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/>u.basisValuesAtInterpolationPoints</highlight></codeline>
<codeline lineno="6308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1],</highlight></codeline>
<codeline lineno="6311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="6312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.getBasisValues(u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray,</highlight></codeline>
<codeline lineno="6314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints)</highlight></codeline>
<codeline lineno="6315"><highlight class="normal"></highlight></codeline>
<codeline lineno="6316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValuesArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;interpolationValuesArray&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1]),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.getValues(u.basisValuesAtInterpolationPoints,u.interpolationValuesArray)</highlight></codeline>
<codeline lineno="6321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="6322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/>Viewers.MatlabWriter(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="6323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_MonomialDGPK(fout,</highlight></codeline>
<codeline lineno="6324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="6325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="6326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints,</highlight></codeline>
<codeline lineno="6328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray,</highlight></codeline>
<codeline lineno="6329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="6330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="6331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="6332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="6334"><highlight class="normal"></highlight></codeline>
<codeline lineno="6335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="6336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="6338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1ab76b4ddb10147fa4647d7233e522eb72" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="6339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeMeshXdmf_P1Bubble(ar,self.elementMaps.mesh,self.nSpace_global,</highlight></codeline>
<codeline lineno="6340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.dofMap.l2g,</highlight></codeline>
<codeline lineno="6341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="6342"><highlight class="normal"></highlight></codeline>
<codeline lineno="6343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a9b1ef05048423724cf772d2a2644a6e0" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6345"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>much<sp/>choice<sp/>except<sp/>to<sp/>get<sp/>u<sp/>values<sp/>at<sp/>interpolation<sp/>points?</highlight></codeline>
<codeline lineno="6346"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeFunctionXdmf_P1Bubble(ar,u,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="6348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a3c42ac17bd4e5ebffd6dfaebec42c778" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6351"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Write<sp/>function<sp/>to<sp/>XDFM<sp/>rep</highlight></codeline>
<codeline lineno="6352"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeVectorFunctionXdmf_P1Bubble(ar,uList,components,vectorName,</highlight><highlight class="stringliteral">&quot;_c0p1_Bubble&quot;</highlight><highlight class="normal">,tCount=tCount,init=init)</highlight></codeline>
<codeline lineno="6354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d6/d8b/classproteus_1_1FemTools_1_1C0__AffineP1BubbleOnSimplexWithNodalBasis_1a82ce623bf3dd13661edf5d41e1263ed0" kindref="member">getValuesAtMeshNodes</ref>(self,dof,nodalValues,isVector,dim_dof):</highlight></codeline>
<codeline lineno="6355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6356"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculate<sp/>function<sp/>values<sp/>at<sp/>mesh<sp/>nodes<sp/>from<sp/>degrees<sp/>of<sp/>freedom<sp/>defined<sp/>elsewhere</highlight></codeline>
<codeline lineno="6357"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ntot<sp/>=<sp/>len(nodalValues.flat)</highlight></codeline>
<codeline lineno="6359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodalValues.flat[:]<sp/>=<sp/>dof.flat[:ntot]</highlight></codeline>
<codeline lineno="6360"><highlight class="normal"></highlight></codeline>
<codeline lineno="6361"><highlight class="normal"></highlight></codeline>
<codeline lineno="6362"><highlight class="normal"></highlight></codeline>
<codeline lineno="6363" refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis" kindref="compound">C0_AffineP1P0BubbleOnSimplexWithNodalBasis</ref>(<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace" kindref="compound">ParametricFiniteElementSpace</ref>):</highlight></codeline>
<codeline lineno="6364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6365"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>TODO<sp/>set<sp/>output<sp/>to<sp/>take<sp/>advantage<sp/>of<sp/>nodal<sp/>information</highlight></codeline>
<codeline lineno="6366"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a05d26b90696f15d0077dc7a0249ad31c" kindref="member">__init__</ref>(self,mesh,nd=3):</highlight></codeline>
<codeline lineno="6368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace<sp/>=<sp/><ref refid="db/d6c/classproteus_1_1FemTools_1_1P1P0BubblesWithNodalBasis" kindref="compound">P1P0BubblesWithNodalBasis</ref>(nd)</highlight></codeline>
<codeline lineno="6369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="da/df5/classproteus_1_1FemTools_1_1P1P0BubbleInterpolationConditions" kindref="compound">P1P0BubbleInterpolationConditions</ref>(localFunctionSpace.referenceElement,localFunctionSpace)</highlight></codeline>
<codeline lineno="6370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace.__init__(self,</highlight></codeline>
<codeline lineno="6371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace,</highlight></codeline>
<codeline lineno="6372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationConditions),</highlight></codeline>
<codeline lineno="6373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh,</highlight></codeline>
<codeline lineno="6374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localFunctionSpace.referenceElement,</highlight></codeline>
<codeline lineno="6375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(nd)),</highlight></codeline>
<codeline lineno="6376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="de/d3a/classproteus_1_1FemTools_1_1P1BubbleDOFMap" kindref="compound">P1BubbleDOFMap</ref>(mesh,localFunctionSpace,nd))</highlight></codeline>
<codeline lineno="6377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1a7897bb7655cdbb5d9c623102378f890e" kindref="member">strongDirichletConditions</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>archiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Archiver</highlight></codeline>
<codeline lineno="6380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1af375a388783caf62a74387af4a2f2dd1" kindref="member">XdmfWriter</ref><sp/>=<sp/><ref refid="d7/d1f/classproteus_1_1Archiver_1_1XdmfWriter" kindref="compound">Archiver.XdmfWriter</ref>()</highlight></codeline>
<codeline lineno="6381"><highlight class="normal"></highlight></codeline>
<codeline lineno="6382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a2a6baac6f2dd82fc7e62a8bd8892a0ab" kindref="member">writeMeshEnsight</ref>(self,filename,description=None):</highlight></codeline>
<codeline lineno="6383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/d37/classproteus_1_1FemTools_1_1ParametricFiniteElementSpace_1ad9d56dd69aef79965a5b0806bc02e5da" kindref="member">mesh</ref>.<ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a2a6baac6f2dd82fc7e62a8bd8892a0ab" kindref="member">writeMeshEnsight</ref>(filename,description)</highlight><highlight class="comment">#need<sp/>to<sp/>allow<sp/>paraview<sp/>to<sp/>even<sp/>read<sp/>in<sp/>quadpoint<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1ae03ed74a8d5665df9b1c47ede030cea4" kindref="member">writeFunctionGnuplot</ref>(self,u,filename):</highlight></codeline>
<codeline lineno="6385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a7e0dc541911c9cbfe2ea1bebbc218df0" kindref="member">writeFunctionEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>hack,<sp/>to<sp/>allow<sp/>for<sp/>output<sp/>from<sp/>quadrature<sp/>arrays<sp/>even<sp/>if<sp/>not<sp/>plotting<sp/>solution<sp/>directly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nOutput+=<sp/>1</highlight></codeline>
<codeline lineno="6389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a7507127f246d366e234508841875a396" kindref="member">writeFunctionHeaderEnsight</ref>(self,u,filename,append=False,firstVariable=True,case_filename=None):</highlight></codeline>
<codeline lineno="6390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1acb7ac50e75de7aa02cfccf88cae37b2d" kindref="member">writeFunctionMatlab</ref>(self,u,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="6392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6393"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>a<sp/>scalar<sp/>finite<sp/>element<sp/>function<sp/>to<sp/>matlab<sp/>format<sp/>for<sp/>viewing</highlight></codeline>
<codeline lineno="6394"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>number<sp/>of<sp/>function<sp/>representations<sp/>written</highlight></codeline>
<codeline lineno="6395"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6396"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Warning,<sp/>currently<sp/>has<sp/>to<sp/>compute<sp/>values<sp/>at<sp/>interpolation<sp/>points!</highlight></codeline>
<codeline lineno="6397"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tries<sp/>to<sp/>use<sp/>basis<sp/>values<sp/>at<sp/>interpolation<sp/>points<sp/>if<sp/>in<sp/>u</highlight></codeline>
<codeline lineno="6398"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>u.isVector:</highlight></codeline>
<codeline lineno="6400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,file):</highlight></codeline>
<codeline lineno="6401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>output</highlight></codeline>
<codeline lineno="6402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>append:</highlight></codeline>
<codeline lineno="6404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(output,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>IOError(</highlight><highlight class="stringliteral">&quot;output<sp/>=<sp/>%s<sp/>should<sp/>be<sp/>file<sp/>or<sp/>filename&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6409"><highlight class="normal"></highlight></codeline>
<codeline lineno="6410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;basisValuesAtInterpolationPoints&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/>u.basisValuesAtInterpolationPoints</highlight></codeline>
<codeline lineno="6413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1],</highlight></codeline>
<codeline lineno="6416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="6417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.getBasisValues(u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray,</highlight></codeline>
<codeline lineno="6419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints)</highlight></codeline>
<codeline lineno="6420"><highlight class="normal"></highlight></codeline>
<codeline lineno="6421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValuesArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;interpolationValuesArray&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1]),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.getValues(u.basisValuesAtInterpolationPoints,u.interpolationValuesArray)</highlight></codeline>
<codeline lineno="6426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Viewers</highlight></codeline>
<codeline lineno="6427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/>Viewers.MatlabWriter(nxgrid=50,nygrid=50,nzgrid=10)</highlight></codeline>
<codeline lineno="6428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nout<sp/>=<sp/>writer.viewScalar_MonomialDGPK(fout,</highlight></codeline>
<codeline lineno="6429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.nSpace_global,</highlight></codeline>
<codeline lineno="6430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.nodeArray,</highlight></codeline>
<codeline lineno="6431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.mesh.elementNodesArray,</highlight></codeline>
<codeline lineno="6432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints,</highlight></codeline>
<codeline lineno="6433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray,</highlight></codeline>
<codeline lineno="6434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=u.name,</highlight></codeline>
<codeline lineno="6435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>storeMeshData=storeMeshData,</highlight></codeline>
<codeline lineno="6436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>figureNumber=figureOffset)</highlight></codeline>
<codeline lineno="6437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(output,str):</highlight></codeline>
<codeline lineno="6438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="6439"><highlight class="normal"></highlight></codeline>
<codeline lineno="6440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nout</highlight></codeline>
<codeline lineno="6441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="6443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1af7eca1dfd12fe0cf07467705be5f1a36" kindref="member">writeMeshXdmf</ref>(self,ar,name,t=0.0,init=False,meshChanged=False,arGrid=None,tCount=0):</highlight></codeline>
<codeline lineno="6444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeMeshXdmf_MonomialDGPK(ar,self.elementMaps.mesh,self.nSpace_global,</highlight></codeline>
<codeline lineno="6445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.interpolationPoints,</highlight></codeline>
<codeline lineno="6446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t=t,init=init,meshChanged=meshChanged,arGrid=arGrid,tCount=tCount)</highlight></codeline>
<codeline lineno="6447"><highlight class="normal"></highlight></codeline>
<codeline lineno="6448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1a84bdb26b74fe60dbb2ae16630d03421b" kindref="member">writeFunctionXdmf</ref>(self,ar,u,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6450"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>much<sp/>choice<sp/>except<sp/>to<sp/>get<sp/>u<sp/>values<sp/>at<sp/>interpolation<sp/>points?</highlight></codeline>
<codeline lineno="6451"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;basisValuesAtInterpolationPoints&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basisValuesAtInterpolationPoints<sp/>=<sp/>u.basisValuesAtInterpolationPoints</highlight></codeline>
<codeline lineno="6455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1],</highlight></codeline>
<codeline lineno="6458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="6459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.getBasisValues(u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray,</highlight></codeline>
<codeline lineno="6461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.basisValuesAtInterpolationPoints)</highlight></codeline>
<codeline lineno="6462"><highlight class="normal"></highlight></codeline>
<codeline lineno="6463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationValuesArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;interpolationValuesArray&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(u):</highlight></codeline>
<codeline lineno="6465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.interpolationValuesArray<sp/>=<sp/>numpy.zeros((u.femSpace.interpolationPoints.shape[0],</highlight></codeline>
<codeline lineno="6466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.interpolationPoints.shape[1]),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.getValues(u.basisValuesAtInterpolationPoints,u.interpolationValuesArray)</highlight></codeline>
<codeline lineno="6468"><highlight class="normal"></highlight></codeline>
<codeline lineno="6469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.XdmfWriter.writeFunctionXdmf_MonomialDGPK(ar,u.interpolationValuesArray,u.name,tCount=tCount,init=init,mesh=u.femSpace.mesh)</highlight></codeline>
<codeline lineno="6470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6471"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d7/d5a/classproteus_1_1FemTools_1_1C0__AffineP1P0BubbleOnSimplexWithNodalBasis_1ad57c296c205dbdcaea9cc189deba4e64" kindref="member">writeVectorFunctionXdmf</ref>(self,ar,uList,components,vectorName,tCount=0,init=True):</highlight></codeline>
<codeline lineno="6472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6473"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Write<sp/>function<sp/>to<sp/>XDMF<sp/>representation</highlight></codeline>
<codeline lineno="6474"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;Monomial<sp/>DGPK<sp/>writeVectorFunctionXdmf<sp/>not<sp/>implemented<sp/>yet&quot;</highlight><highlight class="normal">,level=1)</highlight></codeline>
<codeline lineno="6476"><highlight class="normal"></highlight></codeline>
<codeline lineno="6477"><highlight class="normal"></highlight></codeline>
<codeline lineno="6478"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6479"><highlight class="stringliteral">Members<sp/>of<sp/>the<sp/>finite<sp/>element<sp/>space.</highlight></codeline>
<codeline lineno="6480"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6481"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Comm</highlight></codeline>
<codeline lineno="6482"><highlight class="normal"></highlight></codeline>
<codeline lineno="6483" refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(object):</highlight></codeline>
<codeline lineno="6484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>member<sp/>of<sp/>a<sp/>finite<sp/>element<sp/>space<sp/>of<sp/>scalar<sp/>functions.</highlight></codeline>
<codeline lineno="6485"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6486"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>manages<sp/>the<sp/>calculation<sp/>of<sp/>function,<sp/>gradient,<sp/>tensor,</highlight></codeline>
<codeline lineno="6487"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>trace<sp/>values<sp/>associated<sp/>with<sp/>a<sp/>finite<sp/>element<sp/>function.</highlight></codeline>
<codeline lineno="6488"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Typically,<sp/>this<sp/>function<sp/>will<sp/>be<sp/>a<sp/>scalar<sp/>function<sp/><sp/>(For<sp/>example,</highlight></codeline>
<codeline lineno="6489"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>in<sp/>a<sp/>2D<sp/>stokes<sp/>problem<sp/>with<sp/>a<sp/>pressure,<sp/>and<sp/>two<sp/>velocity</highlight></codeline>
<codeline lineno="6490"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>components<sp/>(say<sp/>u<sp/>or<sp/>v),<sp/>this<sp/>class<sp/>will<sp/>manage<sp/>the<sp/>calculation<sp/>of</highlight></codeline>
<codeline lineno="6491"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>one<sp/>of<sp/>the<sp/>scalar<sp/>functions<sp/>for<sp/>p,<sp/>u<sp/>or<sp/>v.</highlight></codeline>
<codeline lineno="6492"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6493"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Arguments</highlight></codeline>
<codeline lineno="6494"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>---------</highlight></codeline>
<codeline lineno="6495"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>finiteElementSpace<sp/>:<sp/>:class:`proteus.FemTools.ParametricFiniteElementSpace`</highlight></codeline>
<codeline lineno="6496"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6497"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Notes</highlight></codeline>
<codeline lineno="6498"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-----</highlight></codeline>
<codeline lineno="6499"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>`femSpace`<sp/>and<sp/>`dof`<sp/>are<sp/>the<sp/>two<sp/>main<sp/>attributes<sp/>of<sp/>this<sp/>class.</highlight></codeline>
<codeline lineno="6500"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>`dof`<sp/>attributes<sp/>provide<sp/>the<sp/>scalar<sp/>multiples<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="6501"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>underlying<sp/>basis<sp/>functions<sp/>that<sp/>comes<sp/>from<sp/>`femSpace`&apos;s</highlight></codeline>
<codeline lineno="6502"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>ParametricFiniteElementSpace<sp/>object</highlight></codeline>
<codeline lineno="6503"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a68bd5bb57e8560e5573aadf1550a672d" kindref="member">__init__</ref>(self,finiteElementSpace,dof=None,dof_last=None,dof_last_last=None,dim_dof=1,name=&quot;no_name&quot;,isVector=False):</highlight></codeline>
<codeline lineno="6505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>Name<sp/>assigned<sp/>to<sp/>the<sp/>FiniteElementFunction<sp/>instance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1aee7b3571d12d45a02cf49824e7243010" kindref="member">name</ref>=name</highlight></codeline>
<codeline lineno="6507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>boolean<sp/>variable<sp/>identifying<sp/>whether<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>finiteElementFunction<sp/>is<sp/>vector<sp/>quantitied.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a6820b32407fc7bdebe45ef110227603e" kindref="member">isVector</ref>=isVector</highlight></codeline>
<codeline lineno="6510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>:class:`proteus.FemTools.ParametricFiniteElementSpace`</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>provides<sp/>information<sp/>on<sp/>the<sp/>underlying<sp/>finite<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref><sp/>=<sp/>finiteElementSpace</highlight></codeline>
<codeline lineno="6514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>integer<sp/>variable<sp/>with<sp/>the<sp/>global<sp/>number<sp/>of<sp/>degrees<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>freedom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1aed5b7ddb7129bb822d9a3bc113e437ad" kindref="member">nDOF_global</ref><sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dim</highlight></codeline>
<codeline lineno="6517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>dimension<sp/>of<sp/>the<sp/>degree<sp/>of<sp/>freedom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>=<sp/>dim_dof</highlight></codeline>
<codeline lineno="6519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref><sp/>=<sp/>list(range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>))</highlight></codeline>
<codeline lineno="6520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dof<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>numpy<sp/>array<sp/>of<sp/>degree-of-freedom<sp/>values<sp/>used<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>calculate<sp/>the<sp/>finite<sp/>element<sp/>function.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>=dof</highlight></codeline>
<codeline lineno="6524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0e32bb0f47369e77b0b5886e20607ce6" kindref="member">dof_last</ref>=dof_last</highlight></codeline>
<codeline lineno="6525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a9f59d9baa8f3f0be490fdefb544024db" kindref="member">dof_last_last</ref>=dof_last_last</highlight></codeline>
<codeline lineno="6526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dim*dim_dof),</highlight></codeline>
<codeline lineno="6528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0e32bb0f47369e77b0b5886e20607ce6" kindref="member">dof_last</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dim*dim_dof),</highlight></codeline>
<codeline lineno="6530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a9f59d9baa8f3f0be490fdefb544024db" kindref="member">dof_last_last</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dim*dim_dof),</highlight></codeline>
<codeline lineno="6532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6533"><highlight class="normal"></highlight></codeline>
<codeline lineno="6534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>boolean<sp/>variable<sp/>indentifying<sp/>whether<sp/>calculations<sp/>should</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>use<sp/>C-routines.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#we<sp/>need<sp/>to<sp/>be<sp/>able<sp/>to<sp/>get<sp/>references<sp/>to<sp/>existing<sp/>values<sp/>for<sp/>values<sp/>at<sp/>nodes<sp/>for<sp/>some<sp/>calculations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#like<sp/>vtkVisualization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a91318b1067917dd4f97c86d3a8692877" kindref="member">meshNodeValues</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#:<sp/>for<sp/>parallel<sp/>FiniteElementFunciton<sp/>capability</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a8b5f7a7c4e3659f171a62e67a2803bd0" kindref="member">par_dof</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6542"><highlight class="normal"></highlight></codeline>
<codeline lineno="6543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1ab5bd3f08990f38c793299418349110f8" kindref="member">copy</ref>(self):</highlight></codeline>
<codeline lineno="6544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(finiteElementSpace=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>,</highlight></codeline>
<codeline lineno="6545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1ab5bd3f08990f38c793299418349110f8" kindref="member">copy</ref>(),</highlight></codeline>
<codeline lineno="6546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim_dof=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>,</highlight></codeline>
<codeline lineno="6547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1aee7b3571d12d45a02cf49824e7243010" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="6548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isVector=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a6820b32407fc7bdebe45ef110227603e" kindref="member">isVector</ref>)</highlight></codeline>
<codeline lineno="6549"><highlight class="normal"></highlight></codeline>
<codeline lineno="6550"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0fb3fcabdf4e9fd632d73d0bc55900b3" kindref="member">projectFromInterpolationConditions</ref>(self,interpolationValues):</highlight></codeline>
<codeline lineno="6551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.interpolationConditions.projectFiniteElementFunctionFromInterpolationConditions_opt<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.interpolationConditions.projectFiniteElementFunctionFromInterpolationConditions_opt(self,interpolationValues)</highlight></codeline>
<codeline lineno="6553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>functionals<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.interpolationConditions.functionalsQuadrature</highlight></codeline>
<codeline lineno="6555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dof_eN_i<sp/>=<sp/>functionals[i](interpolationValues[eN])</highlight></codeline>
<codeline lineno="6558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,i]*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>:self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,i]*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>+self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>]<sp/>=<sp/>dof_eN_i</highlight></codeline>
<codeline lineno="6559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a11c14fcf5aeb0fd2c9afa4d3a8affa9a" kindref="member">getValue</ref>(self,eN,xi):</highlight></codeline>
<codeline lineno="6560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Calculate<sp/>the<sp/>function<sp/>value<sp/>at<sp/>a<sp/>point<sp/>on<sp/>an<sp/>element.</highlight></codeline>
<codeline lineno="6561"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6562"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Arguments</highlight></codeline>
<codeline lineno="6563"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>---------</highlight></codeline>
<codeline lineno="6564"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/>:<sp/>int</highlight></codeline>
<codeline lineno="6565"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Global<sp/>element<sp/>number.</highlight></codeline>
<codeline lineno="6566"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xi<sp/>:<sp/>point</highlight></codeline>
<codeline lineno="6567"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluation<sp/>coordinate.</highlight></codeline>
<codeline lineno="6568"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6569"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns</highlight></codeline>
<codeline lineno="6570"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-------</highlight></codeline>
<codeline lineno="6571"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value:<sp/>float</highlight></codeline>
<codeline lineno="6572"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>finite<sp/>element<sp/>functions<sp/>value<sp/>at<sp/>xi.</highlight></codeline>
<codeline lineno="6573"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="6575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,psi<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(</highlight></codeline>
<codeline lineno="6576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN],</highlight></codeline>
<codeline lineno="6577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.localFunctionSpace.basis):</highlight></codeline>
<codeline lineno="6578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[i]*<ref refid="de/d5b/Headers_8h_1acf2aa06bc881a993584c334b2b7c6e03" kindref="member">psi</ref>(xi)</highlight></codeline>
<codeline lineno="6579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value</highlight></codeline>
<codeline lineno="6580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a31716c24b1f65cb500efd343880eab9a" kindref="member">getValues</ref>(self,</highlight></codeline>
<codeline lineno="6581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u):</highlight></codeline>
<codeline lineno="6583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>v.shape[1]</highlight></codeline>
<codeline lineno="6584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionValues(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u)</highlight></codeline>
<codeline lineno="6589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u[eN,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]*v[eN,k,j]</highlight></codeline>
<codeline lineno="6598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a45d789555aad838ffd5e3355f19be7d8" kindref="member">getGradientValues</ref>(self,</highlight></codeline>
<codeline lineno="6599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u):</highlight></codeline>
<codeline lineno="6601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>grad_v.shape[1]</highlight></codeline>
<codeline lineno="6602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSpace<sp/>=<sp/>grad_v.shape[-1]</highlight></codeline>
<codeline lineno="6603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionGradientValues(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u)</highlight></codeline>
<codeline lineno="6608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="6617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u[eN,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t,m]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>+t]*grad_v[eN,k,j,m]</highlight></codeline>
<codeline lineno="6618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0e80ea1c9d8e2ab03bdd7047ce52b0d3" kindref="member">getHessianValues</ref>(self,</highlight></codeline>
<codeline lineno="6619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_v,</highlight></codeline>
<codeline lineno="6620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_u):</highlight></codeline>
<codeline lineno="6621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>Hessian_v.shape[1]</highlight></codeline>
<codeline lineno="6622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSpace<sp/>=<sp/>Hessian_v.shape[-1]</highlight></codeline>
<codeline lineno="6623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionHessianValues(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_v,</highlight></codeline>
<codeline lineno="6626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hessian_u)</highlight></codeline>
<codeline lineno="6627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a89bc766bfdb3b6d76c8896e62a289b1f" kindref="member">getGradientTensorValues</ref>(self,</highlight></codeline>
<codeline lineno="6628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v_x_grad_w,</highlight></codeline>
<codeline lineno="6629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u_x_grad_w):</highlight></codeline>
<codeline lineno="6630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>grad_v_x_grad_w.shape[1]</highlight></codeline>
<codeline lineno="6631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSpace<sp/>=<sp/>grad_v_x_grad_w.shape[-1]</highlight></codeline>
<codeline lineno="6632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionGradientTensorValues(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v_x_grad_w,</highlight></codeline>
<codeline lineno="6635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u_x_grad_w)</highlight></codeline>
<codeline lineno="6636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a1badf2307fe6771d99c50769a9cb9a36" kindref="member">getValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="6637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u):</highlight></codeline>
<codeline lineno="6639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>v.shape[2]</highlight></codeline>
<codeline lineno="6640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionValuesTrace(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u)</highlight></codeline>
<codeline lineno="6645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="6650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u[eN,ebN,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]*v[eN,ebN,k,j]</highlight></codeline>
<codeline lineno="6655"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af818f4c08ea3cdb53b6a800e40992382" kindref="member">getGradientValuesTrace</ref>(self,</highlight></codeline>
<codeline lineno="6656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u):</highlight></codeline>
<codeline lineno="6658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>grad_v.shape[2]</highlight></codeline>
<codeline lineno="6659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSpace<sp/>=<sp/>grad_v.shape[-1]</highlight></codeline>
<codeline lineno="6660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionGradientValuesTrace(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u)</highlight></codeline>
<codeline lineno="6665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="6670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="6675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u[eN,ebN,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t,m]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]*grad_v[eN,ebN,k,j,m]</highlight></codeline>
<codeline lineno="6676"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a8becee1c516dce5d97f1c7bd3f53d4ef" kindref="member">getValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="6677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u):</highlight></codeline>
<codeline lineno="6679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>v.shape[2]</highlight></codeline>
<codeline lineno="6680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionValuesGlobalExteriorTrace(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="6682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="6683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="6684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v,</highlight></codeline>
<codeline lineno="6687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u)</highlight></codeline>
<codeline lineno="6688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="6692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="6693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="6694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="6695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u[ebNE,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]*v[ebNE,k,j]</highlight></codeline>
<codeline lineno="6700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a751cad5cbf9f548bd983028adca9f427" kindref="member">getGradientValuesGlobalExteriorTrace</ref>(self,</highlight></codeline>
<codeline lineno="6701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u):</highlight></codeline>
<codeline lineno="6703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_xi<sp/>=<sp/>grad_v.shape[1]</highlight></codeline>
<codeline lineno="6704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSpace<sp/>=<sp/>grad_v.shape[-1]</highlight></codeline>
<codeline lineno="6705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a0ed3a1f2f1bfc56ff1f09bde67ff6c7d" kindref="member">useC</ref>==</highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cfemIntegrals.calculateFiniteElementFunctionGradientValuesGlobalExteriorTrace(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.exteriorElementBoundariesArray,</highlight></codeline>
<codeline lineno="6707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryElementsArray,</highlight></codeline>
<codeline lineno="6708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryLocalElementBoundariesArray,</highlight></codeline>
<codeline lineno="6709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g,</highlight></codeline>
<codeline lineno="6710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,</highlight></codeline>
<codeline lineno="6711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_v,</highlight></codeline>
<codeline lineno="6712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u)</highlight></codeline>
<codeline lineno="6713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u.flat[:]=0.0</highlight></codeline>
<codeline lineno="6715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_n_xi<sp/>=<sp/>list(range(n_xi))</highlight></codeline>
<codeline lineno="6716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="6717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="6718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN<sp/><sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="6719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_local<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.elementMaps.mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="6720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_n_xi:</highlight></codeline>
<codeline lineno="6721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="6722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.l2g[eN,j]</highlight></codeline>
<codeline lineno="6723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1acba7817c79d914907ab7f1140f1aae9b" kindref="member">range_dim_dof</ref>:</highlight></codeline>
<codeline lineno="6724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>m<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.referenceFiniteElement.referenceElement.range_dim:</highlight></codeline>
<codeline lineno="6725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_u[ebNE,k*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t,m]+=self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>[J*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref><sp/>+<sp/>t]*grad_v[ebNE,k,j,m]</highlight></codeline>
<codeline lineno="6726"><highlight class="normal"></highlight></codeline>
<codeline lineno="6727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1adcb26cd8095dac946b829d74a181833b" kindref="member">writeFunctionGnuplot</ref>(self,filename,append=False):</highlight></codeline>
<codeline lineno="6728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1adcb26cd8095dac946b829d74a181833b" kindref="member">writeFunctionGnuplot</ref>(self,filename)</highlight></codeline>
<codeline lineno="6729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a3ca1bd410bca84e4fba62c46baeb0dbc" kindref="member">writeFunctionEnsight</ref>(self,filename,append=False,case_filename=None):</highlight></codeline>
<codeline lineno="6730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a3ca1bd410bca84e4fba62c46baeb0dbc" kindref="member">writeFunctionEnsight</ref>(self,filename,append,case_filename)</highlight></codeline>
<codeline lineno="6731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a8b5a1951a4bc668063f248248fd2ad78" kindref="member">writeFunctionMatlab</ref>(self,output,append=True,storeMeshData=True,figureOffset=1):</highlight></codeline>
<codeline lineno="6732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a8b5a1951a4bc668063f248248fd2ad78" kindref="member">writeFunctionMatlab</ref>(self,output,append=append,storeMeshData=storeMeshData,figureOffset=figureOffset)</highlight></codeline>
<codeline lineno="6733"><highlight class="normal"></highlight></codeline>
<codeline lineno="6734"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#we<sp/>need<sp/>to<sp/>be<sp/>able<sp/>to<sp/>get<sp/>references<sp/>to<sp/>existing<sp/>values<sp/>for<sp/>values<sp/>at<sp/>nodes<sp/>for<sp/>some<sp/>calculations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6735"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#like<sp/>vtkVisualization,<sp/>call<sp/>structure<sp/>is<sp/>different<sp/>that<sp/>getValues<sp/>because<sp/>realy<sp/>want<sp/>internal<sp/>storage<sp/>to<sp/>be<sp/>modified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a20520ae7d102f9826ea96e955472fe78" kindref="member">calculateValuesAtMeshNodes</ref>(self):</highlight></codeline>
<codeline lineno="6737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a91318b1067917dd4f97c86d3a8692877" kindref="member">meshNodeValues</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a91318b1067917dd4f97c86d3a8692877" kindref="member">meshNodeValues</ref><sp/>=<sp/>numpy.zeros((self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.mesh.nNodes_global*self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.getValuesAtMeshNodes(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a91318b1067917dd4f97c86d3a8692877" kindref="member">meshNodeValues</ref>,self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a6820b32407fc7bdebe45ef110227603e" kindref="member">isVector</ref>,self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref>)</highlight></codeline>
<codeline lineno="6740"><highlight class="normal"></highlight></codeline>
<codeline lineno="6741"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a3d10395602031db1eefc43b9362b3aa3" kindref="member">setupParallelCommunication</ref>(self):</highlight></codeline>
<codeline lineno="6743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6744"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build<sp/>data<sp/>structure<sp/>for<sp/>parallel<sp/>communication</highlight></codeline>
<codeline lineno="6745"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.dof_offsets_subdomain_owned<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;WARNING<sp/>setupParallelCommunication<sp/>not<sp/>valid<sp/>for<sp/>%s<sp/>must<sp/>have<sp/>parallel<sp/>information<sp/>for<sp/>dofMap&quot;</highlight><highlight class="normal"><sp/>%<sp/>self,level=-1)</highlight></codeline>
<codeline lineno="6748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comm<sp/>=<sp/>Comm.get()</highlight></codeline>
<codeline lineno="6750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>par_n<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.dof_offsets_subdomain_owned[comm.rank()+1]<sp/>-<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.dof_offsets_subdomain_owned[comm.rank()]</highlight></codeline>
<codeline lineno="6751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>par_N<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.nDOF_all_processes</highlight></codeline>
<codeline lineno="6752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>par_nghost<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.nDOF_subdomain<sp/>-<sp/>par_n</highlight></codeline>
<codeline lineno="6753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdomain2global<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.subdomain2global</highlight></codeline>
<codeline lineno="6754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_dof_neighbors=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abeb3f8e38439528781d2287281cf41a5" kindref="member">femSpace</ref>.dofMap.max_dof_neighbors</highlight></codeline>
<codeline lineno="6755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>par_bs<sp/>=<sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1abdfb364e2d2c9c00d81493f7acdcc03f" kindref="member">dim_dof</ref></highlight></codeline>
<codeline lineno="6756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1a8b5f7a7c4e3659f171a62e67a2803bd0" kindref="member">par_dof</ref><sp/>=<sp/><ref refid="dc/d75/classproteus_1_1LinearAlgebraTools_1_1ParVec__petsc4py" kindref="compound">ParVec_petsc4py</ref>(self.<ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction_1af7bc292dbe90fe6b9d931a6dfe0a178b" kindref="member">dof</ref>,par_bs,par_n,par_N,par_nghost,subdomain2global)</highlight></codeline>
<codeline lineno="6757"><highlight class="normal"></highlight></codeline>
<codeline lineno="6758"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6759"><highlight class="stringliteral">Boundary<sp/>Conditions</highlight></codeline>
<codeline lineno="6760"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6761"><highlight class="normal"></highlight></codeline>
<codeline lineno="6762" refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions" kindref="compound">DOFBoundaryConditions</ref>(object):</highlight></codeline>
<codeline lineno="6763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6764"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>for<sp/>generating<sp/>the<sp/>set<sp/>of<sp/>DOF<sp/>that<sp/>are<sp/>replaced<sp/>by</highlight></codeline>
<codeline lineno="6765"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Dirichlet<sp/>conditions<sp/>and<sp/>the<sp/>values<sp/>that<sp/>are<sp/>to<sp/>be<sp/>assigned<sp/>to</highlight></codeline>
<codeline lineno="6766"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>those<sp/>DOF.<sp/>For<sp/>now<sp/>I<sp/>will<sp/>ignore<sp/>the<sp/>ability<sp/>to<sp/>specify</highlight></codeline>
<codeline lineno="6767"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>different<sp/>boundary<sp/>conditions<sp/>for<sp/>interpolatory<sp/>DOF<sp/>that<sp/>correspond</highlight></codeline>
<codeline lineno="6768"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>the<sp/>same<sp/>physical<sp/>point<sp/>(i.e.<sp/>discontinuous<sp/>approximations<sp/>where</highlight></codeline>
<codeline lineno="6769"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>left<sp/>and<sp/>right<sp/>limits<sp/>can<sp/>be<sp/>specified)</highlight></codeline>
<codeline lineno="6770"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOFBoundaryConditionDict<sp/>--<sp/>a<sp/>dictionary<sp/>of<sp/>boundary<sp/>condition<sp/>functions</highlight></codeline>
<codeline lineno="6772"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>accessed<sp/>by<sp/>global<sp/>DOF<sp/>number</highlight></codeline>
<codeline lineno="6773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOFBoundryConditionPointDict<sp/>--<sp/>a<sp/>dictionary<sp/>of<sp/>physical<sp/>points<sp/>associated</highlight></codeline>
<codeline lineno="6774"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>the<sp/>boundary<sp/>condition</highlight></codeline>
<codeline lineno="6775"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>freeDOFSet<sp/>--<sp/>the<sp/>DOF<sp/>not<sp/>specified<sp/>by<sp/>boundary<sp/>conditions</highlight></codeline>
<codeline lineno="6776"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>global2freeGlobal<sp/>--<sp/>an<sp/>integer<sp/>mapping<sp/>from<sp/>global<sp/>DOF<sp/>numbers</highlight></codeline>
<codeline lineno="6777"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>the<sp/>free<sp/>DOF<sp/>numbers.</highlight></codeline>
<codeline lineno="6778"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6779"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>constructor<sp/>requires<sp/>a<sp/>function<sp/>that<sp/>takes<sp/>a<sp/>point<sp/>as<sp/>input</highlight></codeline>
<codeline lineno="6780"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and,<sp/>if<sp/>the<sp/>point<sp/>is<sp/>on<sp/>a<sp/>part<sp/>of<sp/>the<sp/>boundary<sp/>where<sp/>values<sp/>are</highlight></codeline>
<codeline lineno="6781"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>specified,<sp/>then<sp/>it<sp/>returns<sp/>the<sp/>function<sp/>of<sp/>t,x,<sp/>and<sp/>the<sp/>unknown</highlight></codeline>
<codeline lineno="6782"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>that<sp/>computes<sp/>the<sp/>boundary<sp/>condition.</highlight></codeline>
<codeline lineno="6783"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6784"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>TODO</highlight></codeline>
<codeline lineno="6785"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>For<sp/>now<sp/>allow<sp/>for<sp/>flag<sp/>to<sp/>specify<sp/>type<sp/>of<sp/>dirichlet<sp/>condition<sp/>to<sp/>allow</highlight></codeline>
<codeline lineno="6786"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>say<sp/>nonlinear<sp/>function<sp/>of<sp/>solution<sp/>to<sp/>be<sp/>specified</highlight></codeline>
<codeline lineno="6787"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>initially,<sp/>only<sp/>weak<sp/>bc&apos;s<sp/>will<sp/>allow<sp/>this<sp/>functionality<sp/>though</highlight></codeline>
<codeline lineno="6788"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6789"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1aa1d80a45be30a4e75d62c378bd2b0e71" kindref="member">__init__</ref>(self,femSpace,getPointwiseBoundaryConditions=None,weakDirichletConditions=False,</highlight></codeline>
<codeline lineno="6790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getPeriodicBoundaryConditions=None,allowNodalMaterialBoundaryTypes=True):</highlight></codeline>
<codeline lineno="6791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="6792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ae8d501b54037fd4a27e54254cf06c592" kindref="member">DOFBoundaryPointDict</ref>={}</highlight></codeline>
<codeline lineno="6793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a2691916a845c807be8fa2906ba094d22" kindref="member">DOFBoundaryMaterialFlag</ref>={}</highlight></codeline>
<codeline lineno="6794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>=<ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>()</highlight></codeline>
<codeline lineno="6795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>={}</highlight></codeline>
<codeline lineno="6796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">ptuple(object):</highlight></codeline>
<codeline lineno="6797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6798"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>define<sp/>a<sp/>dictionary<sp/>key<sp/>that<sp/>defines<sp/>points<sp/>as<sp/>equal<sp/>if<sp/>they&apos;re<sp/>&quot;close&quot;</highlight></codeline>
<codeline lineno="6799"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>h=femSpace.mesh.hMin</highlight></codeline>
<codeline lineno="6801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1aa1d80a45be30a4e75d62c378bd2b0e71" kindref="member">__init__</ref>(self,p):</highlight></codeline>
<codeline lineno="6802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a0eeb12724c119b62a7bf207ffc2856b6" kindref="member">p</ref>=p</highlight></codeline>
<codeline lineno="6803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__hash__(self):</highlight></codeline>
<codeline lineno="6804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hash(tuple(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a0eeb12724c119b62a7bf207ffc2856b6" kindref="member">p</ref>))</highlight></codeline>
<codeline lineno="6805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__eq__(self,other):</highlight></codeline>
<codeline lineno="6806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/><ref refid="d8/dd9/namespaceproteus_1abeaab5b02cfceb3c4c40bc6e088c0dfd" kindref="member">enorm</ref>(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a0eeb12724c119b62a7bf207ffc2856b6" kindref="member">p</ref><sp/>-<sp/>other.p)<sp/>&lt;=<sp/>self.h</highlight></codeline>
<codeline lineno="6807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPointwiseBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>femSpace.strongDirichletConditions<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>weakDirichletConditions:</highlight></codeline>
<codeline lineno="6808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="6809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>mesh<sp/>=<sp/>femSpace.elementMaps.mesh</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>for<sp/>ebNE<sp/>in<sp/>range(mesh.nExteriorElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>eN<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,0]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.referenceFiniteElement.interpolationConditions.nQuadraturePoints):</highlight></codeline>
<codeline lineno="6814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>femSpace.referenceFiniteElement.interpolationConditions.quadrature2DOF_element(k)</highlight></codeline>
<codeline lineno="6815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofN<sp/>=<sp/>femSpace.dofMap.l2g[eN,i]</highlight></codeline>
<codeline lineno="6816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>femSpace.interpolationPoints[eN,k]</highlight></codeline>
<codeline lineno="6817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#in<sp/>case<sp/>interpolation<sp/>is<sp/>wholly<sp/>in<sp/>element<sp/>interior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interiorInterpolationPoint<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN_element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.elementMaps.mesh.nElementBoundaries_element):</highlight></codeline>
<codeline lineno="6821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>femSpace.referenceFiniteElement.interpolationConditions.definedOnLocalElementBoundary(k,ebN_element)<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interiorInterpolationPoint<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>femSpace.elementMaps.mesh.elementBoundariesArray[eN,ebN_element]</highlight></codeline>
<codeline lineno="6824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>femSpace.elementMaps.mesh.elementBoundaryMaterialTypes[ebN]</highlight></codeline>
<codeline lineno="6825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>allow<sp/>for<sp/>flag<sp/>to<sp/>specify<sp/>type<sp/>of<sp/>dirichlet<sp/>condition<sp/>to<sp/>allow</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#say<sp/>nonlinear<sp/>function<sp/>of<sp/>solution<sp/>to<sp/>be<sp/>specified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#initially,<sp/>only<sp/>weak<sp/>bc&apos;s<sp/>will<sp/>allow<sp/>this<sp/>functionality<sp/>though</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gReturn<sp/>=<sp/>getPointwiseBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="6829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn[0]</highlight></codeline>
<codeline lineno="6831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>gReturn[1]</highlight></codeline>
<codeline lineno="6832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="6833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn</highlight></codeline>
<codeline lineno="6834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="6835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>gFlag<sp/>!=<sp/>1:</highlight></codeline>
<codeline lineno="6836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;WARNING<sp/>strong<sp/>Dirichlet<sp/>conditions<sp/>do<sp/>not<sp/>enforce<sp/>nonlinear<sp/>bcs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPeriodicBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>getPeriodicBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="6840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ptuple(p)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>:</highlight></codeline>
<codeline lineno="6842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>[ptuple(p)].add(dofN)</highlight></codeline>
<codeline lineno="6843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>[ptuple(p)]<sp/>=<sp/><ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>([dofN])</highlight></codeline>
<codeline lineno="6845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>g<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>[dofN]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="6847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ae8d501b54037fd4a27e54254cf06c592" kindref="member">DOFBoundaryPointDict</ref>[dofN]=x</highlight></codeline>
<codeline lineno="6848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a2691916a845c807be8fa2906ba094d22" kindref="member">DOFBoundaryMaterialFlag</ref>[dofN]<sp/>=<sp/>materialFlag</highlight></codeline>
<codeline lineno="6849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>.keys()):</highlight></codeline>
<codeline lineno="6852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.add(dofN)</highlight></codeline>
<codeline lineno="6853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#has<sp/>Dirichlet<sp/>bc<sp/>set<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#on<sp/>ebN_element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#local<sp/>faces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>interiorInterpolationPoint<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>.keys()):</highlight></codeline>
<codeline lineno="6857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.add(dofN)</highlight></codeline>
<codeline lineno="6858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="6859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>DOFBoundaryCondition<sp/>Pointwise<sp/>conditions<sp/>should<sp/>take<sp/>arguments<sp/>(x,flag)<sp/>now<sp/>trying<sp/>without<sp/>flag&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>allow<sp/>for<sp/>flag<sp/>to<sp/>specify<sp/>type<sp/>of<sp/>dirichlet<sp/>condition<sp/>to<sp/>allow</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#say<sp/>nonlinear<sp/>function<sp/>of<sp/>solution<sp/>to<sp/>be<sp/>specified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#initially,<sp/>only<sp/>weak<sp/>bc&apos;s<sp/>will<sp/>allow<sp/>this<sp/>functionality<sp/>though</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gReturn<sp/>=<sp/>getPointwiseBoundaryConditions(x)</highlight></codeline>
<codeline lineno="6864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn[0]</highlight></codeline>
<codeline lineno="6866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>gReturn[1]</highlight></codeline>
<codeline lineno="6867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="6868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn</highlight></codeline>
<codeline lineno="6869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="6870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>gFlag<sp/>!=<sp/>1:</highlight></codeline>
<codeline lineno="6871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;WARNING<sp/>strong<sp/>Dirichlet<sp/>conditions<sp/>do<sp/>not<sp/>enforce<sp/>nonlinear<sp/>bcs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPeriodicBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>getPeriodicBoundaryConditions(x)</highlight></codeline>
<codeline lineno="6875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>&quot;periodic<sp/>DOF<sp/>bc<sp/>&quot;,tuple(p)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ptuple(p)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>:</highlight></codeline>
<codeline lineno="6878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>[ptuple(p)].add(dofN)</highlight></codeline>
<codeline lineno="6879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>&quot;inserting<sp/>dof<sp/>in<sp/>periodic<sp/>and<sp/>free&quot;,dofN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>[ptuple(p)]<sp/>=<sp/><ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>([dofN])</highlight></codeline>
<codeline lineno="6883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="6885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>[dofN]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="6886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ae8d501b54037fd4a27e54254cf06c592" kindref="member">DOFBoundaryPointDict</ref>[dofN]=x</highlight></codeline>
<codeline lineno="6887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>.keys()):</highlight></codeline>
<codeline lineno="6890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.add(dofN)</highlight></codeline>
<codeline lineno="6891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#exception<sp/>on<sp/>argument<sp/>list<sp/>for<sp/>getPointWiseBoundaryConditions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#now<sp/>also<sp/>try<sp/>setting<sp/>Dirichlet<sp/>boundary<sp/>conditions<sp/>using<sp/>nodal<sp/>id<sp/>tags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nN_element<sp/>=<sp/>femSpace.referenceFiniteElement.interpolationConditions.quadrature2Node_element(k)</highlight></codeline>
<codeline lineno="6894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="6895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>allowNodalMaterialBoundaryTypes<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>(nN_element<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>nN_element<sp/>&lt;<sp/>femSpace.elementMaps.mesh.nNodes_element):</highlight></codeline>
<codeline lineno="6896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nN_global<sp/>=<sp/>femSpace.elementMaps.mesh.elementNodesArray[eN,nN_element]</highlight></codeline>
<codeline lineno="6898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>femSpace.elementMaps.mesh.nodeMaterialTypes[nN_global]</highlight></codeline>
<codeline lineno="6899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gReturn<sp/>=<sp/>getPointwiseBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="6900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn[0]</highlight></codeline>
<codeline lineno="6902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>gReturn[1]</highlight></codeline>
<codeline lineno="6903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="6904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn</highlight></codeline>
<codeline lineno="6905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="6906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>gFlag<sp/>!=<sp/>1:</highlight></codeline>
<codeline lineno="6907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;WARNING<sp/>strong<sp/>Dirichlet<sp/>conditions<sp/>do<sp/>not<sp/>enforce<sp/>nonlinear<sp/>bcs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPeriodicBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>getPeriodicBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="6911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#skip<sp/>dof<sp/>setting<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="comment">#cek<sp/>changed<sp/>from<sp/>break<sp/>to<sp/>pass/elif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>g:<sp/></highlight><highlight class="comment">#override<sp/>elementBoundary<sp/>condition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>[dofN]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="6915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ae8d501b54037fd4a27e54254cf06c592" kindref="member">DOFBoundaryPointDict</ref>[dofN]=x</highlight></codeline>
<codeline lineno="6916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a2691916a845c807be8fa2906ba094d22" kindref="member">DOFBoundaryMaterialFlag</ref>[dofN]<sp/>=<sp/>materialFlag</highlight></codeline>
<codeline lineno="6917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a77627a6ceb0822094eecf33a02b52948" kindref="member">DOFBoundaryConditionsDict</ref>.keys()):</highlight></codeline>
<codeline lineno="6920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.add(dofN)</highlight></codeline>
<codeline lineno="6921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#has<sp/>Dirichlet<sp/>bc<sp/>set<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="6923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>DOFBoundaryCondition<sp/>Pointwise<sp/>conditions<sp/>should<sp/>take<sp/>arguments<sp/>(x,flag)<sp/>skipping<sp/>nodal<sp/>flag<sp/>test&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#has<sp/>correspondence<sp/>between<sp/>interpolation<sp/>conditions<sp/>and<sp/>mesh<sp/>nodes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#eN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref><sp/>=<sp/><ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>(range(femSpace.dim))</highlight></codeline>
<codeline lineno="6930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nodeSet<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>.values()):</highlight></codeline>
<codeline lineno="6932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList<sp/>=<sp/>list(nodeSet)</highlight></codeline>
<codeline lineno="6933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList.sort()</highlight></codeline>
<codeline lineno="6934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.add(nodeList[0])</highlight></codeline>
<codeline lineno="6935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>nodeList[1:]:</highlight></codeline>
<codeline lineno="6936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="6937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1abfbe6e8b2b62a1ba682d1e2e06eeed77" kindref="member">nFreeDOF_global</ref><sp/>=<sp/>len(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>)</highlight></codeline>
<codeline lineno="6938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>={}</highlight></codeline>
<codeline lineno="6939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acd01b2da6c3b5b5b78e6dba7b99b8a11" kindref="member">myFreeDOF</ref>={}</highlight></codeline>
<codeline lineno="6940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>free_dofN,<sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acbdb6449839244d288ba0268987b0204" kindref="member">freeDOFSet</ref>):</highlight></codeline>
<codeline lineno="6941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>[dofN]<sp/>=<sp/>free_dofN</highlight></codeline>
<codeline lineno="6942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acd01b2da6c3b5b5b78e6dba7b99b8a11" kindref="member">myFreeDOF</ref>[dofN]<sp/>=<sp/>dofN</highlight></codeline>
<codeline lineno="6943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nodeSet<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a663df889a6cfb2c611eb72c239d2aea3" kindref="member">periodicDOFDict</ref>.values()):</highlight></codeline>
<codeline lineno="6944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList<sp/>=<sp/>list(nodeSet)</highlight></codeline>
<codeline lineno="6945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList.sort()</highlight></codeline>
<codeline lineno="6946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free_dofN<sp/>=<sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>[nodeList[0]]</highlight></codeline>
<codeline lineno="6947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;node<sp/>list&quot;</highlight><highlight class="normal">,nodeList)</highlight></codeline>
<codeline lineno="6948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>nodeSet:</highlight></codeline>
<codeline lineno="6949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>[dofN]<sp/>=<sp/>free_dofN</highlight></codeline>
<codeline lineno="6950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1acd01b2da6c3b5b5b78e6dba7b99b8a11" kindref="member">myFreeDOF</ref>[dofN]<sp/>=<sp/>nodeList[0]</highlight></codeline>
<codeline lineno="6951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#create<sp/>arrays<sp/>for<sp/>iterating<sp/>over<sp/>dofs<sp/>in<sp/>c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#not<sp/>necessarily<sp/>a<sp/>1-1<sp/>correspondence<sp/>between<sp/>free_dofN<sp/>and<sp/>dofN<sp/>because<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#periodic<sp/>bcs,<sp/>so<sp/>have<sp/>to<sp/>have<sp/>2<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfree<sp/>=<sp/>len(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>)</highlight></codeline>
<codeline lineno="6955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ab67f9ea47aad3d5369a59ec93f36f205" kindref="member">global2freeGlobal_global_dofs</ref><sp/>=<sp/>numpy.zeros((nfree,),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a52e4fa919fc093e8cfc7c0aa56d887ae" kindref="member">global2freeGlobal_free_dofs</ref><sp/>=<sp/>numpy.zeros((nfree,),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test<sp/>=<sp/>numpy.array(list(range(nfree)),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>.keys()):</highlight></codeline>
<codeline lineno="6959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1ab67f9ea47aad3d5369a59ec93f36f205" kindref="member">global2freeGlobal_global_dofs</ref>[i]<sp/>=<sp/>dofN</highlight><highlight class="comment">#map<sp/>each<sp/>of<sp/>the<sp/>unknown<sp/>DOF&apos;s<sp/>to<sp/>the<sp/>original<sp/>node<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a52e4fa919fc093e8cfc7c0aa56d887ae" kindref="member">global2freeGlobal_free_dofs</ref>[i]<sp/>=<sp/>self.<ref refid="dd/de6/classproteus_1_1FemTools_1_1DOFBoundaryConditions_1a78b59d78e324a5cf8321e047191c282a" kindref="member">global2freeGlobal</ref>[dofN]</highlight><highlight class="comment">#map<sp/>each<sp/>of<sp/>the<sp/>unknown<sp/>DOF&apos;s<sp/>to<sp/>the<sp/>free<sp/>unknown<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6961"><highlight class="normal"></highlight></codeline>
<codeline lineno="6962"><highlight class="normal"></highlight></codeline>
<codeline lineno="6963" refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt" kindref="compound">DOFBoundaryConditions_alt</ref>(object):</highlight></codeline>
<codeline lineno="6964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6965"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>for<sp/>generating<sp/>the<sp/>set<sp/>of<sp/>DOF<sp/>that<sp/>are<sp/>replaced<sp/>by</highlight></codeline>
<codeline lineno="6966"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Dirichlet<sp/>conditions<sp/>and<sp/>the<sp/>values<sp/>that<sp/>are<sp/>to<sp/>be<sp/>assigned<sp/>to</highlight></codeline>
<codeline lineno="6967"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>those<sp/>DOF.<sp/>For<sp/>now<sp/>I<sp/>will<sp/>ignore<sp/>the<sp/>ability<sp/>to<sp/>specify</highlight></codeline>
<codeline lineno="6968"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>different<sp/>boundary<sp/>conditions<sp/>for<sp/>interpolatory<sp/>DOF<sp/>that<sp/>correspond</highlight></codeline>
<codeline lineno="6969"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>the<sp/>same<sp/>physical<sp/>point<sp/>(i.e.<sp/>discontinuous<sp/>approximations<sp/>where</highlight></codeline>
<codeline lineno="6970"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>left<sp/>and<sp/>right<sp/>limits<sp/>can<sp/>be<sp/>specified)</highlight></codeline>
<codeline lineno="6971"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6972"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOFBoundaryConditionDict<sp/>--<sp/>a<sp/>dictionary<sp/>of<sp/>boundary<sp/>condition<sp/>functions</highlight></codeline>
<codeline lineno="6973"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>accessed<sp/>by<sp/>global<sp/>DOF<sp/>number</highlight></codeline>
<codeline lineno="6974"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>DOFBoundryConditionPointDict<sp/>--<sp/>a<sp/>dictionary<sp/>of<sp/>physical<sp/>points<sp/>associated</highlight></codeline>
<codeline lineno="6975"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>with<sp/>the<sp/>boundary<sp/>condition</highlight></codeline>
<codeline lineno="6976"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>freeDOFSet<sp/>--<sp/>the<sp/>DOF<sp/>not<sp/>specified<sp/>by<sp/>boundary<sp/>conditions</highlight></codeline>
<codeline lineno="6977"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>global2freeGlobal<sp/>--<sp/>an<sp/>integer<sp/>mapping<sp/>from<sp/>global<sp/>DOF<sp/>numbers</highlight></codeline>
<codeline lineno="6978"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>the<sp/>free<sp/>DOF<sp/>numbers.</highlight></codeline>
<codeline lineno="6979"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6980"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>constructor<sp/>requires<sp/>a<sp/>function<sp/>that<sp/>takes<sp/>a<sp/>point<sp/>as<sp/>input</highlight></codeline>
<codeline lineno="6981"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and,<sp/>if<sp/>the<sp/>point<sp/>is<sp/>on<sp/>a<sp/>part<sp/>of<sp/>the<sp/>boundary<sp/>where<sp/>values<sp/>are</highlight></codeline>
<codeline lineno="6982"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>specified,<sp/>then<sp/>it<sp/>returns<sp/>the<sp/>function<sp/>of<sp/>t,x,<sp/>and<sp/>the<sp/>unknown</highlight></codeline>
<codeline lineno="6983"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>that<sp/>computes<sp/>the<sp/>boundary<sp/>condition.</highlight></codeline>
<codeline lineno="6984"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6985"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>TODO</highlight></codeline>
<codeline lineno="6986"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>For<sp/>now<sp/>allow<sp/>for<sp/>flag<sp/>to<sp/>specify<sp/>type<sp/>of<sp/>dirichlet<sp/>condition<sp/>to<sp/>allow</highlight></codeline>
<codeline lineno="6987"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>say<sp/>nonlinear<sp/>function<sp/>of<sp/>solution<sp/>to<sp/>be<sp/>specified</highlight></codeline>
<codeline lineno="6988"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/>initially,<sp/>only<sp/>weak<sp/>bc&apos;s<sp/>will<sp/>allow<sp/>this<sp/>functionality<sp/>though</highlight></codeline>
<codeline lineno="6989"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="6990"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a7322606988c84d9d1159f6458105bec8" kindref="member">__init__</ref>(self,femSpace,getPointwiseBoundaryConditions=None,weakDirichletConditions=False,</highlight></codeline>
<codeline lineno="6992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getPeriodicBoundaryConditions=None,allowNodalMaterialBoundaryTypes=True):</highlight></codeline>
<codeline lineno="6993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a34f14ef5cd78ad9049a9347bd91e8c36" kindref="member">DOFBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="6994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a3e02a2fdaf58593f2a2aa9d3d7a7ec40" kindref="member">DOFBoundaryPointDict</ref>={}</highlight></codeline>
<codeline lineno="6995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1ae73d3241241c49e762a25da48607fd89" kindref="member">DOFBoundaryMaterialFlag</ref>={}</highlight></codeline>
<codeline lineno="6996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>={}</highlight></codeline>
<codeline lineno="6997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">ptuple(object):</highlight></codeline>
<codeline lineno="6998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6999"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>define<sp/>a<sp/>dictionary<sp/>key<sp/>that<sp/>defines<sp/>points<sp/>as<sp/>equal<sp/>if<sp/>they&apos;re<sp/>&quot;close&quot;</highlight></codeline>
<codeline lineno="7000"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>h=femSpace.mesh.hMin</highlight></codeline>
<codeline lineno="7002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a7322606988c84d9d1159f6458105bec8" kindref="member">__init__</ref>(self,p):</highlight></codeline>
<codeline lineno="7003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1ad41e3e40d58cd2d20cd4dd75ac9103f1" kindref="member">p</ref>=p</highlight></codeline>
<codeline lineno="7004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__hash__(self):</highlight></codeline>
<codeline lineno="7005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hash(tuple(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1ad41e3e40d58cd2d20cd4dd75ac9103f1" kindref="member">p</ref>))</highlight></codeline>
<codeline lineno="7006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">__eq__(self,other):</highlight></codeline>
<codeline lineno="7007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/><ref refid="d8/dd9/namespaceproteus_1abeaab5b02cfceb3c4c40bc6e088c0dfd" kindref="member">enorm</ref>(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1ad41e3e40d58cd2d20cd4dd75ac9103f1" kindref="member">p</ref><sp/>-<sp/>other.p)<sp/>&lt;<sp/>self.h</highlight></codeline>
<codeline lineno="7008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPointwiseBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>femSpace.strongDirichletConditions<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>weakDirichletConditions:</highlight></codeline>
<codeline lineno="7009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="7010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>mesh<sp/>=<sp/>femSpace.elementMaps.mesh</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>for<sp/>ebNE<sp/>in<sp/>range(mesh.nExteriorElementBoundaries_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>eN<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,0]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.referenceFiniteElement.interpolationConditions.nQuadraturePoints):</highlight></codeline>
<codeline lineno="7015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>femSpace.referenceFiniteElement.interpolationConditions.quadrature2DOF_element(k)</highlight></codeline>
<codeline lineno="7016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofN<sp/>=<sp/>femSpace.dofMap.l2g[eN,i]</highlight></codeline>
<codeline lineno="7017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>femSpace.interpolationPoints[eN,k]</highlight></codeline>
<codeline lineno="7018"><highlight class="normal"></highlight></codeline>
<codeline lineno="7019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#in<sp/>case<sp/>interpolation<sp/>is<sp/>wholly<sp/>in<sp/>element<sp/>interior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interiorInterpolationPoint<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN_element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(femSpace.elementMaps.mesh.nElementBoundaries_element):</highlight></codeline>
<codeline lineno="7022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>femSpace.referenceFiniteElement.interpolationConditions.definedOnLocalElementBoundary(k,ebN_element)<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interiorInterpolationPoint<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>femSpace.elementMaps.mesh.elementBoundariesArray[eN,ebN_element]</highlight></codeline>
<codeline lineno="7025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>femSpace.elementMaps.mesh.elementBoundaryMaterialTypes[ebN]</highlight></codeline>
<codeline lineno="7026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>allow<sp/>for<sp/>flag<sp/>to<sp/>specify<sp/>type<sp/>of<sp/>dirichlet<sp/>condition<sp/>to<sp/>allow</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#say<sp/>nonlinear<sp/>function<sp/>of<sp/>solution<sp/>to<sp/>be<sp/>specified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#initially,<sp/>only<sp/>weak<sp/>bc&apos;s<sp/>will<sp/>allow<sp/>this<sp/>functionality<sp/>though</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gReturn<sp/>=<sp/>getPointwiseBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="7030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn[0]</highlight></codeline>
<codeline lineno="7032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>gReturn[1]</highlight></codeline>
<codeline lineno="7033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="7034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>gReturn</highlight></codeline>
<codeline lineno="7035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gFlag<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="7036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>gFlag<sp/>!=<sp/>1:</highlight></codeline>
<codeline lineno="7037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;WARNING<sp/>strong<sp/>Dirichlet<sp/>conditions<sp/>do<sp/>not<sp/>enforce<sp/>nonlinear<sp/>bcs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getPeriodicBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>getPeriodicBoundaryConditions(x,materialFlag)</highlight></codeline>
<codeline lineno="7041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ptuple(p)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>:</highlight></codeline>
<codeline lineno="7043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>[ptuple(p)].add(dofN)</highlight></codeline>
<codeline lineno="7044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>[ptuple(p)]<sp/>=<sp/><ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>([dofN])</highlight></codeline>
<codeline lineno="7046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>g<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a34f14ef5cd78ad9049a9347bd91e8c36" kindref="member">DOFBoundaryConditionsDict</ref>[dofN]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a3e02a2fdaf58593f2a2aa9d3d7a7ec40" kindref="member">DOFBoundaryPointDict</ref>[dofN]=x</highlight></codeline>
<codeline lineno="7049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1ae73d3241241c49e762a25da48607fd89" kindref="member">DOFBoundaryMaterialFlag</ref>[dofN]<sp/>=<sp/>materialFlag</highlight></codeline>
<codeline lineno="7050"><highlight class="normal"></highlight></codeline>
<codeline lineno="7051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#has<sp/>Dirichlet<sp/>bc<sp/>set<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#on<sp/>ebN_element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#local<sp/>faces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#eN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af70ea129f3bdbe597251e669bb44c059" kindref="member">freeDOFSet</ref><sp/>=<sp/><ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>(range(femSpace.dim))</highlight></codeline>
<codeline lineno="7057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nodeSet<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>.values()):</highlight></codeline>
<codeline lineno="7058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList<sp/>=<sp/>list(nodeSet)</highlight></codeline>
<codeline lineno="7059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList.sort()</highlight></codeline>
<codeline lineno="7060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af70ea129f3bdbe597251e669bb44c059" kindref="member">freeDOFSet</ref>.add(nodeList[0])</highlight></codeline>
<codeline lineno="7061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>nodeList[1:]:</highlight></codeline>
<codeline lineno="7062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af70ea129f3bdbe597251e669bb44c059" kindref="member">freeDOFSet</ref>.discard(dofN)</highlight></codeline>
<codeline lineno="7063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1afdd4d05285283cf6a5d0ede77a63ccd6" kindref="member">nFreeDOF_global</ref><sp/>=<sp/>len(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af70ea129f3bdbe597251e669bb44c059" kindref="member">freeDOFSet</ref>)</highlight></codeline>
<codeline lineno="7064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>={}</highlight></codeline>
<codeline lineno="7065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a116484b9ad51abbba4b13449fd2efb8e" kindref="member">myFreeDOF</ref>={}</highlight></codeline>
<codeline lineno="7066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>free_dofN,<sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af70ea129f3bdbe597251e669bb44c059" kindref="member">freeDOFSet</ref>):</highlight></codeline>
<codeline lineno="7067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>[dofN]<sp/>=<sp/>free_dofN</highlight></codeline>
<codeline lineno="7068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a116484b9ad51abbba4b13449fd2efb8e" kindref="member">myFreeDOF</ref>[dofN]<sp/>=<sp/>dofN</highlight></codeline>
<codeline lineno="7069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nodeSet<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1aa5999317d61507f399234ae54ae573c0" kindref="member">periodicDOFDict</ref>.values()):</highlight></codeline>
<codeline lineno="7070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList<sp/>=<sp/>list(nodeSet)</highlight></codeline>
<codeline lineno="7071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodeList.sort()</highlight></codeline>
<codeline lineno="7072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free_dofN<sp/>=<sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>[nodeList[0]]</highlight></codeline>
<codeline lineno="7073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;node<sp/>list&quot;</highlight><highlight class="normal">,nodeList)</highlight></codeline>
<codeline lineno="7074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>nodeSet:</highlight></codeline>
<codeline lineno="7075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>[dofN]<sp/>=<sp/>free_dofN</highlight></codeline>
<codeline lineno="7076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a116484b9ad51abbba4b13449fd2efb8e" kindref="member">myFreeDOF</ref>[dofN]<sp/>=<sp/>nodeList[0]</highlight></codeline>
<codeline lineno="7077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#create<sp/>arrays<sp/>for<sp/>iterating<sp/>over<sp/>dofs<sp/>in<sp/>c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#not<sp/>necessarily<sp/>a<sp/>1-1<sp/>correspondence<sp/>between<sp/>free_dofN<sp/>and<sp/>dofN<sp/>because<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#periodic<sp/>bcs,<sp/>so<sp/>have<sp/>to<sp/>have<sp/>2<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nfree<sp/>=<sp/>len(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>)</highlight></codeline>
<codeline lineno="7081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af31518df084be93d45b125ac3a6c8cd9" kindref="member">global2freeGlobal_global_dofs</ref><sp/>=<sp/>numpy.zeros((nfree,),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a0f083128fa2ea219f889efe68695026f" kindref="member">global2freeGlobal_free_dofs</ref><sp/>=<sp/>numpy.zeros((nfree,),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test<sp/>=<sp/>numpy.array(list(range(nfree)),dtype=</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,dofN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>.keys()):</highlight></codeline>
<codeline lineno="7085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1af31518df084be93d45b125ac3a6c8cd9" kindref="member">global2freeGlobal_global_dofs</ref>[i]<sp/>=<sp/>dofN</highlight><highlight class="comment">#map<sp/>each<sp/>of<sp/>the<sp/>unknown<sp/>DOF&apos;s<sp/>to<sp/>the<sp/>original<sp/>node<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a0f083128fa2ea219f889efe68695026f" kindref="member">global2freeGlobal_free_dofs</ref>[i]<sp/>=<sp/>self.<ref refid="da/de4/classproteus_1_1FemTools_1_1DOFBoundaryConditions__alt_1a19d94aa2486a5099341b3d7460602e70" kindref="member">global2freeGlobal</ref>[dofN]</highlight><highlight class="comment">#map<sp/>each<sp/>of<sp/>the<sp/>unknown<sp/>DOF&apos;s<sp/>to<sp/>the<sp/>free<sp/>unknown<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7087"><highlight class="normal"></highlight></codeline>
<codeline lineno="7088"><highlight class="normal"></highlight></codeline>
<codeline lineno="7089"><highlight class="normal"></highlight></codeline>
<codeline lineno="7090" refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions" kindref="compound">FluxBoundaryConditions</ref>(object):</highlight></codeline>
<codeline lineno="7091"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Generating<sp/>class<sp/>for<sp/>the<sp/>fluxBoundaryConditions<sp/>dictionaries.</highlight></codeline>
<codeline lineno="7092"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7093"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>manages<sp/>the<sp/>generation<sp/>of<sp/>the<sp/>advective,<sp/>stress<sp/>and</highlight></codeline>
<codeline lineno="7094"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>diffusive<sp/>fluxBoundaryCondition<sp/>dictionaries.<sp/><sp/>These<sp/>dictionaries</highlight></codeline>
<codeline lineno="7095"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>store<sp/>lists<sp/>of<sp/>functions<sp/>that<sp/>describe<sp/>the<sp/>flux<sp/>conditions<sp/>along</highlight></codeline>
<codeline lineno="7096"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>finite<sp/>element<sp/>boundaries.</highlight></codeline>
<codeline lineno="7097"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7098"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Attributes</highlight></codeline>
<codeline lineno="7099"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>----------</highlight></codeline>
<codeline lineno="7100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>advectiveFluxBoundaryConditionsDict<sp/>:<sp/>:obj:`dict`</highlight></codeline>
<codeline lineno="7101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Stores<sp/>advective<sp/>flux<sp/>boundary<sp/>conditions<sp/>functions.</highlight></codeline>
<codeline lineno="7102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>stressFluxBoundaryConditionsDict<sp/>:<sp/>:obj:`dict`</highlight></codeline>
<codeline lineno="7103"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Stores<sp/>stress<sp/>flux<sp/>boundary<sp/>conditions<sp/>functions.</highlight></codeline>
<codeline lineno="7104"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>diffusiveFluxBoundaryConditionsDictDict<sp/>:<sp/>:obj:`dict`</highlight></codeline>
<codeline lineno="7105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Stores<sp/>diffusive<sp/>flux<sp/>boundary<sp/>conditions<sp/>functions.</highlight></codeline>
<codeline lineno="7106"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7107"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Notes</highlight></codeline>
<codeline lineno="7108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-----</highlight></codeline>
<codeline lineno="7109"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>boundary<sp/>condition<sp/>dictionaries<sp/>all<sp/>use<sp/>the<sp/>key<sp/>convention</highlight></codeline>
<codeline lineno="7110"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>(ebNE,k)<sp/>where<sp/>ebNE<sp/>is<sp/>the<sp/>global<sp/>edge<sp/>number<sp/>and<sp/>k<sp/>is<sp/>the<sp/>local</highlight></codeline>
<codeline lineno="7111"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>quadrature<sp/>point<sp/>number.</highlight></codeline>
<codeline lineno="7112"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a68ebc0c17198a016f964eb930b97dc2a" kindref="member">__init__</ref>(self,mesh,nElementBoundaryQuadraturePoints_elementBoundary,x,</highlight></codeline>
<codeline lineno="7114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getAdvectiveFluxBoundaryConditions=None,</highlight></codeline>
<codeline lineno="7115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getDiffusiveFluxBoundaryConditions={},</highlight></codeline>
<codeline lineno="7116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getStressFluxBoundaryConditions=None):</highlight></codeline>
<codeline lineno="7117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a7ad4df692f49e036de5b4891cd68f685" kindref="member">advectiveFluxBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="7118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a64317d0a2d82ed7c8722c8ed94d8e208" kindref="member">stressFluxBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="7119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1abc57ad69afbb474c747fed88588f6fca" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>=dict([(ck,{})<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys())])</highlight></codeline>
<codeline lineno="7120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="7121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="7122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>mesh.elementBoundaryMaterialTypes[ebN]</highlight></codeline>
<codeline lineno="7123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryQuadraturePoints_elementBoundary):</highlight></codeline>
<codeline lineno="7124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getAdvectiveFluxBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getAdvectiveFluxBoundaryConditions(x[ebNE,k],materialFlag)</highlight></codeline>
<codeline lineno="7127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a7ad4df692f49e036de5b4891cd68f685" kindref="member">advectiveFluxBoundaryConditionsDict</ref>[(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getStressFluxBoundaryConditions<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getStressFluxBoundaryConditions(x[ebNE,k],materialFlag)</highlight></codeline>
<codeline lineno="7131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a64317d0a2d82ed7c8722c8ed94d8e208" kindref="member">stressFluxBoundaryConditionsDict</ref>[(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys()):</highlight></codeline>
<codeline lineno="7134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getDiffusiveFluxBoundaryConditions[ck](x[ebNE,k],materialFlag)</highlight></codeline>
<codeline lineno="7135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1abc57ad69afbb474c747fed88588f6fca" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>[ck][(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="7138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>FluxBoundaryCondition<sp/>should<sp/>take<sp/>arguments<sp/>(x,flag)<sp/>now<sp/>trying<sp/>without<sp/>flag&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getAdvectiveFluxBoundaryConditions(x[ebNE,k])</highlight></codeline>
<codeline lineno="7140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1a7ad4df692f49e036de5b4891cd68f685" kindref="member">advectiveFluxBoundaryConditionsDict</ref>[(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys()):</highlight></codeline>
<codeline lineno="7143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getDiffusiveFluxBoundaryConditions[ck](x[ebNE,k])</highlight></codeline>
<codeline lineno="7144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d3/d08/classproteus_1_1FemTools_1_1FluxBoundaryConditions_1abc57ad69afbb474c747fed88588f6fca" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>[ck][(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#ebNE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7148" refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries" kindref="compound">FluxBoundaryConditionsGlobalElementBoundaries</ref>(object):</highlight></codeline>
<codeline lineno="7149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="7150"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>mwf<sp/>original<sp/>version<sp/>that<sp/>sets<sp/>indeces<sp/>based<sp/>on<sp/>all<sp/>element<sp/>boundaries</highlight></codeline>
<codeline lineno="7151"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>for<sp/>generating<sp/>the<sp/>list<sp/>of<sp/>element<sp/>boundaries</highlight></codeline>
<codeline lineno="7152"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>where<sp/>values<sp/>are<sp/>specified.</highlight></codeline>
<codeline lineno="7153"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a498d928ab3b23cb0f1cf8684ec1ccf03" kindref="member">__init__</ref>(self,mesh,nElementBoundaryQuadraturePoints_elementBoundary,x,getAdvectiveFluxBoundaryConditions=None,getDiffusiveFluxBoundaryConditions={}):</highlight></codeline>
<codeline lineno="7155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9b4b5856cf3059d94306c2175471f2bb" kindref="member">advectiveFluxBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="7156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9e5c20a70c85dd6caa3b9609ff4a73db" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>=dict([(ck,{})<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys())])</highlight></codeline>
<codeline lineno="7157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="7158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="7159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_global<sp/><sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="7160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="7161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>mesh.elementBoundaryMaterialTypes[ebN]</highlight></codeline>
<codeline lineno="7162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryQuadraturePoints_elementBoundary):</highlight></codeline>
<codeline lineno="7163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getAdvectiveFluxBoundaryConditions:</highlight></codeline>
<codeline lineno="7166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getAdvectiveFluxBoundaryConditions(x[ebN,k],materialFlag)</highlight></codeline>
<codeline lineno="7167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9b4b5856cf3059d94306c2175471f2bb" kindref="member">advectiveFluxBoundaryConditionsDict</ref>[(ebN,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys()):</highlight></codeline>
<codeline lineno="7170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getDiffusiveFluxBoundaryConditions[ck](x[ebN,k],materialFlag)</highlight></codeline>
<codeline lineno="7171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9e5c20a70c85dd6caa3b9609ff4a73db" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>[ck][(ebN,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="7174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>FluxBoundaryCondition<sp/>GlobalElement<sp/>should<sp/>take<sp/>arguments<sp/>(x,flag)<sp/>now<sp/>trying<sp/>without<sp/>flag&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>getAdvectiveFluxBoundaryConditions:</highlight></codeline>
<codeline lineno="7177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getAdvectiveFluxBoundaryConditions(x[ebN,k])</highlight></codeline>
<codeline lineno="7178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9b4b5856cf3059d94306c2175471f2bb" kindref="member">advectiveFluxBoundaryConditionsDict</ref>[(ebN,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ck<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(getDiffusiveFluxBoundaryConditions.keys()):</highlight></codeline>
<codeline lineno="7181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getDiffusiveFluxBoundaryConditions[ck](x[ebN,k])</highlight></codeline>
<codeline lineno="7182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d4/d84/classproteus_1_1FemTools_1_1FluxBoundaryConditionsGlobalElementBoundaries_1a9e5c20a70c85dd6caa3b9609ff4a73db" kindref="member">diffusiveFluxBoundaryConditionsDictDict</ref>[ck][(ebN,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7184" refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions" kindref="compound">StressBoundaryConditions</ref>(object):</highlight></codeline>
<codeline lineno="7185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="7186"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>for<sp/>generating<sp/>the<sp/>list<sp/>of<sp/>element<sp/>boundaries</highlight></codeline>
<codeline lineno="7187"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>where<sp/>values<sp/>are<sp/>specified.</highlight></codeline>
<codeline lineno="7188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions_1a5517f27c1b8ab1fc42d35f603e0ba9d7" kindref="member">__init__</ref>(self,mesh,nElementBoundaryQuadraturePoints_elementBoundary,x,getStressTraceBoundaryConditions=None):</highlight></codeline>
<codeline lineno="7190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions_1a398a897d5e954f7bb13db1e0c2d7e4e0" kindref="member">stressTraceBoundaryConditionsDict</ref>={}</highlight></codeline>
<codeline lineno="7191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="7192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="7193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>materialFlag<sp/>=<sp/>mesh.elementBoundaryMaterialTypes[ebN]</highlight></codeline>
<codeline lineno="7194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryQuadraturePoints_elementBoundary):</highlight></codeline>
<codeline lineno="7195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getStressTraceBoundaryConditions(x[ebNE,k],materialFlag)</highlight></codeline>
<codeline lineno="7197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions_1a398a897d5e954f7bb13db1e0c2d7e4e0" kindref="member">stressTraceBoundaryConditionsDict</ref>[(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="7200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>FluxBoundaryCondition<sp/>should<sp/>take<sp/>arguments<sp/>(x,flag)<sp/>now<sp/>trying<sp/>without<sp/>flag&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>g<sp/>=<sp/>getStressTraceBoundaryConditions(x[ebNE,k])</highlight></codeline>
<codeline lineno="7202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>g:</highlight></codeline>
<codeline lineno="7203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d8/d93/classproteus_1_1FemTools_1_1StressBoundaryConditions_1a398a897d5e954f7bb13db1e0c2d7e4e0" kindref="member">stressTraceBoundaryConditionsDict</ref>[(ebNE,k)]<sp/>=<sp/>g</highlight></codeline>
<codeline lineno="7204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#ebNE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7206" refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" kindref="compound">MultilevelProjectionOperators</ref>(object):</highlight></codeline>
<codeline lineno="7207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="7208"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>class<sp/>that<sp/>takes<sp/>a<sp/>hierarchical<sp/>(multiLevel)<sp/>mesh<sp/>and<sp/>generates</highlight></codeline>
<codeline lineno="7209"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>interpolation<sp/>and<sp/>restriction<sp/>operators.</highlight></codeline>
<codeline lineno="7210"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7211"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>restrictList/prolongList<sp/>--<sp/>projection<sp/>and<sp/>restriction<sp/>at<sp/>only<sp/>the<sp/>free<sp/>nodes</highlight></codeline>
<codeline lineno="7212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>restrict_bcList/prolong_bcList<sp/>--<sp/>includes<sp/>dirichlet<sp/>boundaries<sp/>as<sp/>well</highlight></codeline>
<codeline lineno="7213"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>By<sp/>default<sp/>this<sp/>is<sp/>set<sp/>up<sp/>for<sp/>conforming<sp/>spaces.<sp/>Since<sp/>the<sp/>spaces</highlight></codeline>
<codeline lineno="7215"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>are<sp/>conforming<sp/>the<sp/>coarse<sp/>basis<sp/>functions<sp/>are<sp/>in<sp/>the<sp/>fine<sp/>space<sp/>so<sp/>we</highlight></codeline>
<codeline lineno="7216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>need<sp/>only<sp/>find<sp/>the<sp/>coefficients<sp/>of<sp/>the<sp/>fine<sp/>space<sp/>basis<sp/>functions<sp/>that</highlight></codeline>
<codeline lineno="7217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>yield<sp/>the<sp/>coarse<sp/>space<sp/>basis<sp/>functions.<sp/>This<sp/>is<sp/>the<sp/>matrix<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="7218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>trivial<sp/>injection<sp/>from<sp/>coarse<sp/>to<sp/>fine<sp/>and<sp/>it<sp/>is<sp/>used<sp/>as<sp/>the<sp/>projection</highlight></codeline>
<codeline lineno="7219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>operator.<sp/>Restriction<sp/>is<sp/>taken<sp/>as<sp/>the<sp/>matrix<sp/>of<sp/>the<sp/>adjoint<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="7220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>injection,<sp/>which<sp/>is<sp/>simply<sp/>the<sp/>transpose<sp/>of<sp/>the<sp/>projection<sp/>matrix.<sp/>These</highlight></codeline>
<codeline lineno="7221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>operators<sp/>fall<sp/>out<sp/>if<sp/>you<sp/>try<sp/>to<sp/>solve<sp/>for<sp/>the<sp/>error<sp/>on<sp/>the<sp/>coarse<sp/>grid:</highlight></codeline>
<codeline lineno="7222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Starting<sp/>with<sp/>u_f<sp/>we<sp/>have<sp/>a(u_f+e_f,w_f)<sp/>=<sp/>&lt;f,w_f&gt;,<sp/>and<sp/>we<sp/>want<sp/>to</highlight></codeline>
<codeline lineno="7223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>solve<sp/>instead<sp/><sp/>a(e_c,w_c)<sp/>=<sp/>&lt;f<sp/>-<sp/>a(u_f,w_f),w_c&gt;<sp/>on<sp/>the<sp/>coarse<sp/>grid</highlight></codeline>
<codeline lineno="7224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Using<sp/>the<sp/>injection<sp/>i<sp/>we<sp/>can<sp/>express<sp/>this<sp/>in<sp/>the<sp/>fine<sp/>space<sp/>as</highlight></codeline>
<codeline lineno="7225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a(i<sp/>e_c,<sp/>i<sp/>w_c)<sp/>=<sp/>&lt;f<sp/>-<sp/>a(u_f,w_f),i<sp/>w_c&gt;<sp/>writing</highlight></codeline>
<codeline lineno="7226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>this<sp/>in<sp/>matrix<sp/>form<sp/>yields<sp/>p^t<sp/>A_f<sp/>p<sp/>E<sp/>=<sp/>p^t<sp/>R_f</highlight></codeline>
<codeline lineno="7227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>---<sp/>P1<sp/>nonconforming<sp/>space<sp/>----</highlight></codeline>
<codeline lineno="7228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Try<sp/>to<sp/>set<sp/>up<sp/>now<sp/>for<sp/>nonconforming<sp/>P1<sp/>approximation<sp/>following<sp/>Chen_96b.</highlight></codeline>
<codeline lineno="7229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Setup<sp/>prolongation<sp/>by<sp/>evaluating<sp/>coarse<sp/>grid<sp/>basis<sp/>functions<sp/>at</highlight></codeline>
<codeline lineno="7230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>fine<sp/>grid<sp/>interpolation<sp/>condition<sp/>points<sp/>(face<sp/>barycenters).</highlight></codeline>
<codeline lineno="7231"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7232"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Then,<sp/>just<sp/>need<sp/>to<sp/>know<sp/>if<sp/>fine<sp/>grid<sp/>interpolationCondition<sp/>point<sp/>falls<sp/>on</highlight></codeline>
<codeline lineno="7233"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>interface<sp/>of<sp/>coarse<sp/>grid<sp/>elements<sp/>or<sp/>not.<sp/>If<sp/>so,<sp/>use<sp/>average<sp/>value<sp/>of<sp/>coarse</highlight></codeline>
<codeline lineno="7234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>grid<sp/>quantity<sp/>on<sp/>fine<sp/>grid.<sp/>Otherwise<sp/>just<sp/>evaluate<sp/>it</highlight></codeline>
<codeline lineno="7235"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7236"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Use<sp/>this<sp/>simple<sp/>interpolation<sp/>from<sp/>coarse<sp/>to<sp/>fine<sp/>as<sp/>the<sp/>projection<sp/>operator.</highlight></codeline>
<codeline lineno="7237"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Restriction<sp/>is<sp/>taken<sp/>as<sp/>the<sp/>matrix<sp/>of<sp/>the<sp/>adjoint<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="7238"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>injection,<sp/>which<sp/>is<sp/>simply<sp/>the<sp/>transpose<sp/>of<sp/>the<sp/>projection<sp/>matrix.</highlight></codeline>
<codeline lineno="7239"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7240"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>I<sp/>don&apos;t<sp/>think<sp/>these<sp/>fall<sp/>out<sp/>as<sp/>nicely<sp/>since<sp/>they&apos;re<sp/>nonconforming.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="7242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a6c0959c86ba5c0e6b7b074c3a9cacb28" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="7243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multilevelMesh,</highlight></codeline>
<codeline lineno="7244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpaceDictList,</highlight></codeline>
<codeline lineno="7245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offsetListList,</highlight></codeline>
<codeline lineno="7246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strideListList,</highlight></codeline>
<codeline lineno="7247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dofBoundaryConditionsDictList):</highlight></codeline>
<codeline lineno="7248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref><sp/>=<sp/>len(offsetListList[0])</highlight></codeline>
<codeline lineno="7249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a4a5f56ae75c26c9fa7dea5a356471514" kindref="member">restrictList</ref><sp/>=<sp/>[[]]</highlight></codeline>
<codeline lineno="7250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a30a0f54d4f7c9e6d070489aa2c37e7fd" kindref="member">rzvalList</ref><sp/>=<sp/>[[]]</highlight></codeline>
<codeline lineno="7251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ac84366e2bc6ac9bd2e1b036014c35d3b" kindref="member">restrictSumList</ref>=[[]]</highlight></codeline>
<codeline lineno="7252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aa28a6bfc46e68e6cce759f1084b9635d" kindref="member">prolongList</ref><sp/>=<sp/>[[]]</highlight></codeline>
<codeline lineno="7253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a23bb9e81b94e781a18ab59b9a79c1906" kindref="member">pzvalList</ref><sp/>=<sp/>[[]]</highlight></codeline>
<codeline lineno="7254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a7783d83b9b9f647920e8e6d1db593800" kindref="member">restrict_bcListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a855e6c02bcb61d2c07f47401191413b5" kindref="member">rbczvalListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aadce10125c29a8c4766974c24f2e2af7" kindref="member">restrict_bcSumListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a8cd5f237cca2810fceba11783c1f2986" kindref="member">prolong_bcListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aac6e0e8554706af6ba4b49c571d91a72" kindref="member">pbczvalListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a5ec083465f841349fc008bb86232f937" kindref="member">scaled_restrict_bcListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1adfda4466956600a84aa3c3f205b23ce9" kindref="member">scaled_rbczvalListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ab31133ec1a72ccbfd29592e058aca5d6" kindref="member">interp_bcListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ad3bafa28260084b1381ce79849b0967f" kindref="member">interp_bczvalListDict</ref><sp/>=<sp/>dict([(cj,[[]])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>)])</highlight></codeline>
<codeline lineno="7263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a4e2cab7c5bb9b001d0b3d9c9177cbcb4" kindref="member">femSpaceDictList</ref>=femSpaceDictList</highlight></codeline>
<codeline lineno="7264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a3c3ec727892c8a2b9ceae84f5aa69724" kindref="member">dof_bc_DictList</ref><sp/>=<sp/>dofBoundaryConditionsDictList</highlight></codeline>
<codeline lineno="7265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>usingAtLeastOneNCproj<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>l<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(multilevelMesh.meshList)-1):</highlight></codeline>
<codeline lineno="7267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarse_nFreeDOF_global<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fine_nFreeDOF_global=0</highlight></codeline>
<codeline lineno="7271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>):</highlight></codeline>
<codeline lineno="7272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarse_nFreeDOF_global<sp/>+=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a3c3ec727892c8a2b9ceae84f5aa69724" kindref="member">dof_bc_DictList</ref>[l][cj].nFreeDOF_global</highlight></codeline>
<codeline lineno="7273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fine_nFreeDOF_global<sp/><sp/><sp/>+=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a3c3ec727892c8a2b9ceae84f5aa69724" kindref="member">dof_bc_DictList</ref>[l+1][cj].nFreeDOF_global</highlight></codeline>
<codeline lineno="7274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rSum<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a9d435081f13773ea83cc7a810ee1aff1" kindref="member">Vec</ref>(coarse_nFreeDOF_global)</highlight></codeline>
<codeline lineno="7275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rColumnIndeces=[<ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarse_nFreeDOF_global)]</highlight></codeline>
<codeline lineno="7276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cj<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aeacb2bd2055c041d1bae4b77d124b309" kindref="member">nc</ref>):</highlight></codeline>
<codeline lineno="7277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseSpace<sp/>=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a4e2cab7c5bb9b001d0b3d9c9177cbcb4" kindref="member">femSpaceDictList</ref>[l][cj]</highlight></codeline>
<codeline lineno="7278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseMesh<sp/><sp/>=<sp/>multilevelMesh.meshList[l]</highlight></codeline>
<codeline lineno="7279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseDOFBoundaryConditions<sp/>=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a3c3ec727892c8a2b9ceae84f5aa69724" kindref="member">dof_bc_DictList</ref>[l][cj]</highlight></codeline>
<codeline lineno="7280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#children<sp/>=<sp/>multilevelMesh.elementChildren[l]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#new<sp/>mesh<sp/>interface<sp/>uses<sp/>packed<sp/>arrays,<sp/>basically<sp/>a<sp/>sparse<sp/>matrix</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>children<sp/>=<sp/>multilevelMesh.elementChildrenArrayList[l]</highlight></codeline>
<codeline lineno="7284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>childrenOffsets<sp/>=<sp/>multilevelMesh.elementChildrenOffsetsList[l]</highlight></codeline>
<codeline lineno="7285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7286"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>coarse_eN<sp/>in<sp/>range(coarseMesh.nElements_global):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7287"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element<sp/>=<sp/>max(nChildrenMax_element,len(children[coarse_eN]))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element<sp/>=<sp/><ref refid="d7/daa/group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(childrenOffsets[1:]<sp/>-<sp/>childrenOffsets[:-1])</highlight></codeline>
<codeline lineno="7289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fineSpace<sp/>=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a4e2cab7c5bb9b001d0b3d9c9177cbcb4" kindref="member">femSpaceDictList</ref>[l+1][cj]</highlight></codeline>
<codeline lineno="7290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fineMesh<sp/><sp/>=<sp/>multilevelMesh.meshList[l+1]</highlight></codeline>
<codeline lineno="7291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fineDOFBoundaryConditions<sp/>=<sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a3c3ec727892c8a2b9ceae84f5aa69724" kindref="member">dof_bc_DictList</ref>[l+1][cj]</highlight></codeline>
<codeline lineno="7292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fineSpaceInterpolationFunctionals<sp/>=<sp/>fineSpace.referenceFiniteElement.interpolationConditions.functionalsQuadrature</highlight></codeline>
<codeline lineno="7293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolationPointsOnFineElement_reference<sp/>=<sp/>fineSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nInterpolationPoints<sp/>=<sp/>fineSpace.referenceFiniteElement.interpolationConditions.nQuadraturePoints</highlight></codeline>
<codeline lineno="7295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>range_nInterpolationPoints<sp/>=<sp/>list(range(nInterpolationPoints))</highlight></codeline>
<codeline lineno="7296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement<sp/>=<sp/>fineSpace.referenceFiniteElement.referenceElement</highlight></codeline>
<codeline lineno="7297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbcSum<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a9d435081f13773ea83cc7a810ee1aff1" kindref="member">Vec</ref>(coarseSpace.dim)</highlight></codeline>
<codeline lineno="7298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbcColumnIndeces=[<ref refid="d0/d93/namespaceproteus_1_1Context_1a5966a755fc5ade13023e4c265d76d131" kindref="member">set</ref>()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarseSpace.dim)]</highlight></codeline>
<codeline lineno="7299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbc<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pbc<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scaled_rbc<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interp_bc<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="7303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>should<sp/>tell<sp/>us<sp/>if<sp/>interpolation<sp/>condition<sp/>is<sp/>at<sp/>coarse<sp/>element<sp/>interface<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>aka<sp/>(nonconforming<sp/>on<sp/>coarse<sp/>grid?)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#check<sp/>typecode<sp/>if<sp/>go<sp/>to<sp/>c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isNonConformingOnCoarseGrid<sp/>=<sp/>numpy.zeros((fineMesh.nElements_global,nInterpolationPoints),</highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>referenceElement.dim<sp/><sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>isinstance(fineSpace,NC_AffineLinearOnSimplexWithNodalBasis):</highlight></codeline>
<codeline lineno="7308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>old<sp/>mesh<sp/>interface<sp/>multilevelMesh.calculateElementParents()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parentsArray<sp/>=<sp/>multilevelMesh.elementParentsArrayList[l+1]</highlight></codeline>
<codeline lineno="7310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>usingAtLeastOneNCproj<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#need<sp/>to<sp/>care<sp/>about<sp/>interpolation<sp/>conditions<sp/>being<sp/>conforming<sp/>on<sp/>coarse<sp/>grid<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNI<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(fineMesh.nInteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="7313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>fineMesh.interiorElementBoundariesArray[ebNI]</highlight></codeline>
<codeline lineno="7314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_left<sp/><sp/>=<sp/>fineMesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="7315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_right<sp/>=<sp/>fineMesh.elementBoundaryElementsArray[ebN,1]</highlight></codeline>
<codeline lineno="7316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebn_left<sp/>=<sp/>fineMesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="7317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebn_right=<sp/>fineMesh.elementBoundaryLocalElementBoundariesArray[ebN,1]</highlight></codeline>
<codeline lineno="7318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>old<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#PeN_left<sp/>=<sp/>multilevelMesh.elementParents[l+1][eN_left]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#PeN_right=<sp/>multilevelMesh.elementParents[l+1][eN_right]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PeN_left<sp/>=<sp/>parentsArray[eN_left]</highlight></codeline>
<codeline lineno="7322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PeN_right=<sp/>parentsArray[eN_right]</highlight></codeline>
<codeline lineno="7323"><highlight class="normal"></highlight></codeline>
<codeline lineno="7324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>PeN_left<sp/>!=<sp/>PeN_right:</highlight></codeline>
<codeline lineno="7325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#assumes<sp/>a<sp/>unique<sp/>correspondence<sp/>interpCondition<sp/>&lt;--&gt;<sp/>local<sp/>element<sp/>boundary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isNonConformingOnCoarseGrid[eN_left,ebn_left]<sp/><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="7327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isNonConformingOnCoarseGrid[eN_right,ebn_right]=<sp/>1</highlight></codeline>
<codeline lineno="7328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>debug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>&quot;&quot;&quot;MultilevelProjNC<sp/>nc<sp/>IP<sp/>ebN=<sp/>%d<sp/>eN_left=%d<sp/>PeN_left=%d<sp/>eN_right=%d<sp/>PeN_right=%d<sp/>&quot;&quot;&quot;<sp/>%<sp/>(ebN,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_left,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PeN_left,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_right,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PeN_right)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#different<sp/>parents</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interior<sp/>element<sp/>boundaries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#what<sp/>about<sp/>exterior<sp/>ones?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(fineMesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="7338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>fineMesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="7339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_left<sp/>=<sp/>fineMesh.elementBoundaryElementsArray[ebN,0]</highlight></codeline>
<codeline lineno="7340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebn_left<sp/>=<sp/>fineMesh.elementBoundaryLocalElementBoundariesArray[ebN,0]</highlight></codeline>
<codeline lineno="7341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isNonConformingOnCoarseGrid[eN_left,ebn_left]<sp/><sp/>=<sp/>-1</highlight></codeline>
<codeline lineno="7342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>exterior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#need<sp/>to<sp/>care<sp/>about<sp/>nonconforming<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(fineSpace,NC_AffineLinearOnSimplexWithNodalBasis)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement.dim<sp/>&gt;<sp/>1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>usingAtLeastOneNCproj):</highlight></codeline>
<codeline lineno="7346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d2/d0f/namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;&quot;&quot;WARNING<sp/>testStuff.MultiLevelProjectionOperatorsNC<sp/>mixing<sp/>NC<sp/>and<sp/>C0<sp/>projection<sp/>operators!!!&quot;&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#map<sp/>reference<sp/>interpolation<sp/>points<sp/>of<sp/>fine<sp/>elements<sp/>to<sp/>physical<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnFineElement_physical<sp/>=<sp/><sp/>fineSpace.updateInterpolationPoints()</highlight></codeline>
<codeline lineno="7349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#copy<sp/>physical<sp/>space<sp/>reference<sp/>points<sp/>on<sp/>fine<sp/>elements<sp/>to<sp/>an<sp/>array<sp/>for<sp/>their<sp/>parents</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_physical<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3),</highlight></codeline>
<codeline lineno="7353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>child_N_global=0<sp/></highlight><highlight class="comment">#cek<sp/>new<sp/>mesh<sp/>interface,<sp/>keep<sp/>track<sp/>of<sp/>position<sp/>in<sp/>children<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>coarse_eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarseMesh.nElements_global):</highlight></codeline>
<codeline lineno="7356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>child_N,fine_e<sp/>in<sp/>enumerate(children[coarse_eN]):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#new<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child_N,offset<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(range(childrenOffsets[coarse_eN],childrenOffsets[coarse_eN+1])):</highlight></codeline>
<codeline lineno="7360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fine_eN<sp/>=<sp/>children[offset]<sp/></highlight><highlight class="comment">#new</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>pN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range_nInterpolationPoints:</highlight></codeline>
<codeline lineno="7362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#interpolationPointsOnCoarseElement_physical[coarse_eN,child_N*nInterpolationPoints<sp/>+<sp/>pN,:]<sp/>=<sp/>interpolationPointsOnFineElement_physical[fine_e.N,pN]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_physical[coarse_eN,child_N*nInterpolationPoints<sp/>+<sp/>pN,:]<sp/>=<sp/>interpolationPointsOnFineElement_physical[fine_eN,pN]</highlight></codeline>
<codeline lineno="7365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#map<sp/>physical<sp/>interpolation<sp/>points<sp/>on<sp/>coarse<sp/>elements<sp/>to<sp/>coarse<sp/>reference<sp/>coordinates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_reference<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3),</highlight></codeline>
<codeline lineno="7369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement.dim,</highlight></codeline>
<codeline lineno="7373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement.dim),</highlight></codeline>
<codeline lineno="7374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invJ<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement.dim,</highlight></codeline>
<codeline lineno="7378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>referenceElement.dim),</highlight></codeline>
<codeline lineno="7379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>detJ<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints),</highlight></codeline>
<codeline lineno="7382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_reference_dummy<sp/>=<sp/>numpy.zeros((nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3),</highlight></codeline>
<codeline lineno="7385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseSpace.elementMaps.getJacobianValues(interpolationPointsOnCoarseElement_reference_dummy,</highlight></codeline>
<codeline lineno="7387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J,</highlight></codeline>
<codeline lineno="7388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invJ,</highlight></codeline>
<codeline lineno="7389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>detJ)</highlight></codeline>
<codeline lineno="7390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseSpace.elementMaps.getInverseValues(invJ,</highlight></codeline>
<codeline lineno="7391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_physical,</highlight></codeline>
<codeline lineno="7392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interpolationPointsOnCoarseElement_reference)</highlight></codeline>
<codeline lineno="7393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#get<sp/>coarse<sp/>scale<sp/>basis<sp/>function<sp/>values<sp/>at<sp/>these<sp/>reference<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi<sp/>=<sp/>numpy.zeros((coarseMesh.nElements_global,</highlight></codeline>
<codeline lineno="7395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nChildrenMax_element*nInterpolationPoints,</highlight></codeline>
<codeline lineno="7396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseSpace.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="7397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coarseSpace.getBasisValuesAtArray(interpolationPointsOnCoarseElement_reference,</highlight></codeline>
<codeline lineno="7399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi)</highlight></codeline>
<codeline lineno="7400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>new<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>child_N_global=0</highlight></codeline>
<codeline lineno="7402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>coarse_eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarseMesh.nElements_global):</highlight></codeline>
<codeline lineno="7403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#for<sp/>fine_eN,fine_e<sp/>in<sp/>enumerate(children[coarse_eN]):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>new<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fine_eN,offset<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(range(childrenOffsets[coarse_eN],childrenOffsets[coarse_eN+1])):</highlight></codeline>
<codeline lineno="7407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fine_eN_global<sp/>=<sp/>children[offset]<sp/></highlight><highlight class="comment">#new</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fineSpace.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="7409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#I<sp/>=<sp/>fineSpace.dofMap.l2g[fine_e.N,i]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>I<sp/>=<sp/>fineSpace.dofMap.l2g[fine_eN_global,i]</highlight></codeline>
<codeline lineno="7411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>coarseSpace.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="7412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>J<sp/>=<sp/>coarseSpace.dofMap.l2g[coarse_eN,j]</highlight></codeline>
<codeline lineno="7413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi_j<sp/>=<sp/>psi[coarse_eN,fine_eN*nInterpolationPoints:(fine_eN+1)*nInterpolationPoints,j]</highlight></codeline>
<codeline lineno="7414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F_ij<sp/>=<sp/>fineSpaceInterpolationFunctionals[i](psi_j)</highlight></codeline>
<codeline lineno="7415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>abs(F_ij<sp/>)<sp/>&gt;<sp/>1.0e-16:</highlight></codeline>
<codeline lineno="7416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>orig<sp/>F_ij<sp/>&gt;<sp/>1.e-16<sp/>changed<sp/>to<sp/>abs(F_ij)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#mwf<sp/>now<sp/>account<sp/>for<sp/>nonconforming<sp/>points?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>old<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if<sp/>usingAtLeastOneNCproj<sp/>and<sp/>isNonConformingOnCoarseGrid[fine_e.N,i]<sp/>&gt;<sp/>0:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek<sp/>new<sp/>mesh<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>usingAtLeastOneNCproj<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>isNonConformingOnCoarseGrid[fine_eN_global,i]<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="7422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>F_ij<sp/>*=<sp/>0.5</highlight></codeline>
<codeline lineno="7423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#have<sp/>to<sp/>allow<sp/>for<sp/>summing<sp/>up<sp/>values<sp/>hit<sp/>multiple<sp/>times</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#only<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(J,I)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rbc:</highlight></codeline>
<codeline lineno="7426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbc[(J,I)]<sp/>+=<sp/>F_ij</highlight></codeline>
<codeline lineno="7427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pbc[(I,J)]<sp/>+=<sp/>F_ij</highlight></codeline>
<codeline lineno="7428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbc[(J,I)]<sp/>=<sp/>F_ij</highlight></codeline>
<codeline lineno="7430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pbc[(I,J)]<sp/>=<sp/>F_ij</highlight></codeline>
<codeline lineno="7431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbc[(J,I)]<sp/>=<sp/>F_ij</highlight></codeline>
<codeline lineno="7433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pbc[(I,J)]<sp/>=<sp/>F_ij</highlight></codeline>
<codeline lineno="7434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbcColumnIndeces[J].add(I)</highlight></codeline>
<codeline lineno="7435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#check<sp/>why<sp/>this<sp/>is<sp/>being<sp/>called,<sp/>todo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fineDOFBoundaryConditions.global2freeGlobal:</highlight></codeline>
<codeline lineno="7437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>II<sp/>=<sp/>fineDOFBoundaryConditions.global2freeGlobal[I]*strideListList[l+1][cj]+offsetListList[l+1][cj]</highlight></codeline>
<codeline lineno="7438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>J<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>coarseDOFBoundaryConditions.global2freeGlobal:</highlight></codeline>
<codeline lineno="7439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>JJ<sp/>=<sp/>coarseDOFBoundaryConditions.global2freeGlobal[J]*strideListList[l][cj]+offsetListList[l][cj]</highlight></codeline>
<codeline lineno="7440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rColumnIndeces[JJ].add(II)</highlight></codeline>
<codeline lineno="7441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r[(JJ,II)]<sp/>=<sp/>rbc[(J,I)]</highlight></codeline>
<codeline lineno="7442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p[(II,JJ)]<sp/>=<sp/>pbc[(I,J)]</highlight></codeline>
<codeline lineno="7443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>coarse_eN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarseSpace.dim):</highlight></codeline>
<codeline lineno="7445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>J<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rbcColumnIndeces[I]:</highlight></codeline>
<codeline lineno="7446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rbcSum[I]<sp/>+=<sp/>abs(rbc[(I,J)])</highlight></codeline>
<codeline lineno="7447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rbc[(I,J)]<sp/>&gt;<sp/>1.0-1.0e-8<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>rbc[(I,J)]<sp/>&lt;<sp/>1.0<sp/>+<sp/>1.0e-8:</highlight></codeline>
<codeline lineno="7448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interp_bc[(I,J)]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="7449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(offsetListList[l][cj],offsetListList[l][cj]+coarseDOFBoundaryConditions.nFreeDOF_global,strideListList[l][cj]):</highlight></codeline>
<codeline lineno="7450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>J<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rColumnIndeces[I]:</highlight></codeline>
<codeline lineno="7451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rSum[I]<sp/>+=<sp/>r[(I,J)]</highlight></codeline>
<codeline lineno="7452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>I<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(coarseSpace.dim):</highlight></codeline>
<codeline lineno="7453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>J<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rbcColumnIndeces[I]:</highlight></codeline>
<codeline lineno="7454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rbc[(I,J)]<sp/>&gt;<sp/>0.0<sp/>-<sp/>1.0e-8<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>rbc[(I,J)]<sp/>&lt;<sp/>0.0<sp/>+<sp/>1.0e-8:</highlight></codeline>
<codeline lineno="7455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scaled_rbc[(I,J)]<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="7456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scaled_rbc[(I,J)]<sp/>=<sp/>old_div(rbc[(I,J)],rbcSum[I])</highlight></codeline>
<codeline lineno="7458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#now<sp/>make<sp/>real<sp/>sparse<sp/>matrices</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(rbc,rbczval)<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(coarseSpace.dim,fineSpace.dim,rbc)</highlight></codeline>
<codeline lineno="7460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(scaled_rbc,scaled_rbczval)<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(coarseSpace.dim,fineSpace.dim,scaled_rbc)</highlight></codeline>
<codeline lineno="7461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(pbc,pbczval)<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(fineSpace.dim,coarseSpace.dim,pbc)</highlight></codeline>
<codeline lineno="7462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(interp_bc,interp_bczval)<sp/>=<ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(coarseSpace.dim,fineSpace.dim,interp_bc)</highlight></codeline>
<codeline lineno="7463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aadce10125c29a8c4766974c24f2e2af7" kindref="member">restrict_bcSumListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(rbcSum)</highlight></codeline>
<codeline lineno="7464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a7783d83b9b9f647920e8e6d1db593800" kindref="member">restrict_bcListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(rbc)</highlight></codeline>
<codeline lineno="7465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a5ec083465f841349fc008bb86232f937" kindref="member">scaled_restrict_bcListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(scaled_rbc)</highlight></codeline>
<codeline lineno="7466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ab31133ec1a72ccbfd29592e058aca5d6" kindref="member">interp_bcListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(interp_bc)</highlight></codeline>
<codeline lineno="7467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a855e6c02bcb61d2c07f47401191413b5" kindref="member">rbczvalListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(rbczval)</highlight></codeline>
<codeline lineno="7468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1adfda4466956600a84aa3c3f205b23ce9" kindref="member">scaled_rbczvalListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(scaled_rbczval)</highlight></codeline>
<codeline lineno="7469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ad3bafa28260084b1381ce79849b0967f" kindref="member">interp_bczvalListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(interp_bczval)</highlight></codeline>
<codeline lineno="7470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a8cd5f237cca2810fceba11783c1f2986" kindref="member">prolong_bcListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(pbc)</highlight></codeline>
<codeline lineno="7471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aac6e0e8554706af6ba4b49c571d91a72" kindref="member">pbczvalListDict</ref>[cj].<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(pbczval)</highlight></codeline>
<codeline lineno="7472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(r,rzval)<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(coarse_nFreeDOF_global,fine_nFreeDOF_global,r)</highlight></codeline>
<codeline lineno="7473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(p,pzval)<sp/>=<sp/><ref refid="d9/dca/namespaceproteus_1_1LinearAlgebraTools_1a83d4380d20b040f6fddde5d173bae547" kindref="member">SparseMatFromDict</ref>(fine_nFreeDOF_global,coarse_nFreeDOF_global,p)</highlight></codeline>
<codeline lineno="7474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1ac84366e2bc6ac9bd2e1b036014c35d3b" kindref="member">restrictSumList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(rSum)</highlight></codeline>
<codeline lineno="7475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a4a5f56ae75c26c9fa7dea5a356471514" kindref="member">restrictList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(r)</highlight></codeline>
<codeline lineno="7476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a30a0f54d4f7c9e6d070489aa2c37e7fd" kindref="member">rzvalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(rzval)</highlight></codeline>
<codeline lineno="7477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1aa28a6bfc46e68e6cce759f1084b9635d" kindref="member">prolongList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(p)</highlight></codeline>
<codeline lineno="7478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators_1a23bb9e81b94e781a18ab59b9a79c1906" kindref="member">pzvalList</ref>.<ref refid="da/dd2/namespaceproteus_1_1FemTools_1a019de708f4345899e87a80cb8e6b0778" kindref="member">append</ref>(pzval)</highlight></codeline>
<codeline lineno="7479"><highlight class="normal"></highlight></codeline>
<codeline lineno="7480"><highlight class="normal"></highlight></codeline>
<codeline lineno="7481"><highlight class="normal"></highlight></codeline>
<codeline lineno="7482"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7483"><highlight class="normal"><sp/><sp/><sp/><sp/>nq1Db=1</highlight></codeline>
<codeline lineno="7484"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray0D<sp/>=<sp/>numpy.zeros((nq1Db,1),<sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7485"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray0D[0]<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="7486"><highlight class="normal"><sp/><sp/><sp/><sp/>nq1D=3</highlight></codeline>
<codeline lineno="7487"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray1D<sp/>=<sp/>numpy.zeros((nq1D,1),<sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7488"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray1D[0]<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="7489"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray1D[1]<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="7490"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray1D[2]<sp/>=<sp/>0.5</highlight></codeline>
<codeline lineno="7491"><highlight class="normal"><sp/><sp/><sp/><sp/>nq2D<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="7492"><highlight class="normal"><sp/><sp/><sp/><sp/>nq2Db<sp/>=<sp/>nq1D</highlight></codeline>
<codeline lineno="7493"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2D<sp/>=<sp/>numpy.zeros((nq2D,2),<sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7494"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2D[0,:]<sp/>=<sp/>[0.0,0.0]</highlight></codeline>
<codeline lineno="7495"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2D[1,:]<sp/>=<sp/>[1.0,0.0]</highlight></codeline>
<codeline lineno="7496"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2D[2,:]<sp/>=<sp/>[0.0,1.0]</highlight></codeline>
<codeline lineno="7497"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2D[3,:]<sp/>=<sp/>[0.33,0.33]</highlight></codeline>
<codeline lineno="7498"><highlight class="normal"><sp/><sp/><sp/><sp/>nq3Db<sp/>=<sp/>nq2D</highlight></codeline>
<codeline lineno="7499"><highlight class="normal"><sp/><sp/><sp/><sp/>nq3D<sp/>=<sp/>5</highlight></codeline>
<codeline lineno="7500"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D<sp/>=<sp/>numpy.zeros((nq3D,3),<sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7501"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D[0,:]<sp/>=<sp/>[0.0,0.0,0.0]</highlight></codeline>
<codeline lineno="7502"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D[1,:]<sp/>=<sp/>[1.0,0.0,0.0]</highlight></codeline>
<codeline lineno="7503"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D[2,:]<sp/>=<sp/>[0.0,1.0,0.0]</highlight></codeline>
<codeline lineno="7504"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D[3,:]<sp/>=<sp/>[0.0,0.0,1.0]</highlight></codeline>
<codeline lineno="7505"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3D[4,:]<sp/>=<sp/>[0.25,0.25,0.25]</highlight></codeline>
<codeline lineno="7506"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceSimplex(1)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7507"><highlight class="normal"><sp/><sp/><sp/><sp/>unitInterval<sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(1)</highlight></codeline>
<codeline lineno="7508"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.dim))</highlight></codeline>
<codeline lineno="7509"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nNodes<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.nNodes))</highlight></codeline>
<codeline lineno="7510"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nElementBoundaries<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.nElementBoundaries))</highlight></codeline>
<codeline lineno="7511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitInterval.range_nNodes:</highlight></codeline>
<codeline lineno="7512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.nodeList[nN]))</highlight></codeline>
<codeline lineno="7513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitInterval.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;JHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.boundaryJacobianList[ebN]))</highlight></codeline>
<codeline lineno="7516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.boundaryUnitNormalList[ebN]))</highlight></codeline>
<codeline lineno="7517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="7518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray0D[k]))</highlight></codeline>
<codeline lineno="7519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat(xBar)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitInterval.boundaryMapList[ebN](xiArray0D[k])))</highlight></codeline>
<codeline lineno="7520"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************LinearOnSimplexWithNodalBasis(1)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7521"><highlight class="normal"><sp/><sp/><sp/><sp/>localFunctionSpace1D<sp/>=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(1)</highlight></codeline>
<codeline lineno="7522"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace1D.dim))</highlight></codeline>
<codeline lineno="7523"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>and<sp/>grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.range_dim:</highlight></codeline>
<codeline lineno="7525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1D):</highlight></codeline>
<codeline lineno="7527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray1D[k]))</highlight></codeline>
<codeline lineno="7528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace1D.basis[j](xiArray1D[k])))</highlight></codeline>
<codeline lineno="7529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace1D.basisGradients[j](xiArray1D[k])))</highlight></codeline>
<codeline lineno="7530"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>and<sp/>trace(grad(v))&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.range_dim:</highlight></codeline>
<codeline lineno="7532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="7536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray0D[k]))</highlight></codeline>
<codeline lineno="7537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace1D.basisTrace[ebN][j](xiArray0D[k])))</highlight></codeline>
<codeline lineno="7538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(grad(v))<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace1D.basisGradientsTrace[ebN][j](xiArray0D[k])))</highlight></codeline>
<codeline lineno="7539"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalInterpolationConditions(unitInterval)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7540"><highlight class="normal"><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(unitInterval)</highlight></codeline>
<codeline lineno="7541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.range_dim:</highlight></codeline>
<codeline lineno="7542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.range_dim:</highlight></codeline>
<codeline lineno="7543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F(i=&quot;</highlight><highlight class="normal">+repr(i)+</highlight><highlight class="stringliteral">&quot;,v(j=&quot;</highlight><highlight class="normal">+repr(j)+</highlight><highlight class="stringliteral">&quot;))=&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionals[i](localFunctionSpace1D.basis[j])))</highlight></codeline>
<codeline lineno="7544"><highlight class="normal"><sp/><sp/><sp/><sp/>fListList<sp/>=<sp/>[[1.0,0.0],[0.0,1.0]]</highlight></codeline>
<codeline lineno="7545"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;fListList<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(fListList))</highlight></codeline>
<codeline lineno="7546"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace1D.range_dim:</highlight></codeline>
<codeline lineno="7547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fList<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fListList:</highlight></codeline>
<codeline lineno="7548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F(i=&quot;</highlight><highlight class="normal">+repr(i)+</highlight><highlight class="stringliteral">&quot;,fList=&quot;</highlight><highlight class="normal">+repr(fList)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionalsQuadrature[i](fList)))</highlight></codeline>
<codeline lineno="7549"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceFiniteElement*********************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7550"><highlight class="normal"><sp/><sp/><sp/><sp/>referenceFiniteElement<sp/>=<sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace1D,interpolationConditions)</highlight></codeline>
<codeline lineno="7551"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceSimplex(2)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7552"><highlight class="normal"><sp/><sp/><sp/><sp/>unitTriangle<sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(2)</highlight></codeline>
<codeline lineno="7553"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.dim))</highlight></codeline>
<codeline lineno="7554"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nNodes<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.nNodes))</highlight></codeline>
<codeline lineno="7555"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nElementBoundaries<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.nElementBoundaries))</highlight></codeline>
<codeline lineno="7556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitTriangle.range_nNodes:</highlight></codeline>
<codeline lineno="7557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.nodeList[nN]))</highlight></codeline>
<codeline lineno="7558"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitTriangle.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;JHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.boundaryJacobianList[ebN]))</highlight></codeline>
<codeline lineno="7561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.boundaryUnitNormalList[ebN]))</highlight></codeline>
<codeline lineno="7562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="7563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray1D[k]))</highlight></codeline>
<codeline lineno="7564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat(xBar)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTriangle.boundaryMapList[ebN](xiArray1D[k])))</highlight></codeline>
<codeline lineno="7565"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************LinearOnSimplexWithNodalBasis(2)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7566"><highlight class="normal"><sp/><sp/><sp/><sp/>localFunctionSpace2D<sp/>=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(2)</highlight></codeline>
<codeline lineno="7567"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace2D.dim))</highlight></codeline>
<codeline lineno="7568"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>and<sp/>grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.range_dim:</highlight></codeline>
<codeline lineno="7570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2D):</highlight></codeline>
<codeline lineno="7572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray2D[k]))</highlight></codeline>
<codeline lineno="7573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace2D.basis[j](xiArray2D[k])))</highlight></codeline>
<codeline lineno="7574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace2D.basisGradients[j](xiArray2D[k])))</highlight></codeline>
<codeline lineno="7575"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>and<sp/>trace(grad(v))&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.range_dim:</highlight></codeline>
<codeline lineno="7577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="7581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray1D[k]))</highlight></codeline>
<codeline lineno="7582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace2D.basisTrace[ebN][j](xiArray1D[k])))</highlight></codeline>
<codeline lineno="7583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(grad(v))<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace2D.basisGradientsTrace[ebN][j](xiArray1D[k])))</highlight></codeline>
<codeline lineno="7584"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalInterpolationConditions(unitTriangle)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7585"><highlight class="normal"><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(unitTriangle)</highlight></codeline>
<codeline lineno="7586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.range_dim:</highlight></codeline>
<codeline lineno="7587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.range_dim:</highlight></codeline>
<codeline lineno="7588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F(i=&quot;</highlight><highlight class="normal">+repr(i)+</highlight><highlight class="stringliteral">&quot;,j=&quot;</highlight><highlight class="normal">+repr(j)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionals[i](localFunctionSpace2D.basis[j])))</highlight></codeline>
<codeline lineno="7589"><highlight class="normal"><sp/><sp/><sp/><sp/>fListList<sp/>=<sp/>[[1.0,0.0,0.0],[0.0,1.0,0.0],[0.0,0.0,1.0]]</highlight></codeline>
<codeline lineno="7590"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(fListList)</highlight></codeline>
<codeline lineno="7591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace2D.range_dim:</highlight></codeline>
<codeline lineno="7592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fList<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fListList:</highlight></codeline>
<codeline lineno="7593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F(i=&quot;</highlight><highlight class="normal">+repr(i)+</highlight><highlight class="stringliteral">&quot;,fList=&quot;</highlight><highlight class="normal">+repr(fList)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionalsQuadrature[i](fList)))</highlight></codeline>
<codeline lineno="7594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceFiniteElement*********************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7595"><highlight class="normal"><sp/><sp/><sp/><sp/>referenceFiniteElement<sp/>=<sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace2D,interpolationConditions)</highlight></codeline>
<codeline lineno="7596"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceSimplex(3)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7597"><highlight class="normal"><sp/><sp/><sp/><sp/>unitTetrahedron<sp/>=<sp/><ref refid="db/d40/classproteus_1_1FemTools_1_1ReferenceSimplex" kindref="compound">ReferenceSimplex</ref>(3)</highlight></codeline>
<codeline lineno="7598"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.dim))</highlight></codeline>
<codeline lineno="7599"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nNodes<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.nNodes))</highlight></codeline>
<codeline lineno="7600"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nElementBoundaries<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.nElementBoundaries))</highlight></codeline>
<codeline lineno="7601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitTetrahedron.range_nNodes:</highlight></codeline>
<codeline lineno="7602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.nodeList[nN]))</highlight></codeline>
<codeline lineno="7603"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;boundary<sp/>maps&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>unitTetrahedron.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;JHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.boundaryJacobianList[ebN]))</highlight></codeline>
<codeline lineno="7607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.boundaryUnitNormalList[ebN]))</highlight></codeline>
<codeline lineno="7608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="7609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray2D[k]))</highlight></codeline>
<codeline lineno="7610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat(xBar)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(unitTetrahedron.boundaryMapList[ebN](xiArray2D[k])))</highlight></codeline>
<codeline lineno="7611"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************LinearOnSimplexWithNodalBasis(3)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7612"><highlight class="normal"><sp/><sp/><sp/><sp/>localFunctionSpace3D<sp/>=<sp/><ref refid="de/da6/classproteus_1_1FemTools_1_1LinearOnSimplexWithNodalBasis" kindref="compound">LinearOnSimplexWithNodalBasis</ref>(3)</highlight></codeline>
<codeline lineno="7613"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;dim<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace3D.dim))</highlight></codeline>
<codeline lineno="7614"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>and<sp/>grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7615"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.range_dim:</highlight></codeline>
<codeline lineno="7616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3D):</highlight></codeline>
<codeline lineno="7618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray3D[k]))</highlight></codeline>
<codeline lineno="7619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace3D.basis[j](xiArray3D[k])))</highlight></codeline>
<codeline lineno="7620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace3D.basisGradients[j](xiArray3D[k])))</highlight></codeline>
<codeline lineno="7621"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>and<sp/>trace(grad(v))&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.range_dim:</highlight></codeline>
<codeline lineno="7623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j))</highlight></codeline>
<codeline lineno="7624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(ebN))</highlight></codeline>
<codeline lineno="7626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="7627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(xiArray2D[k]))</highlight></codeline>
<codeline lineno="7628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(v)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(localFunctionSpace3D.basisTrace[ebN][j](xiArray2D[k])))</highlight></codeline>
<codeline lineno="7629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;trace(grad(v))&quot;</highlight><highlight class="normal">+repr(localFunctionSpace3D.basisGradientsTrace[ebN][j](xiArray2D[k])))</highlight></codeline>
<codeline lineno="7630"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalInterpolationConditions(unitTetrahedron)****************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7631"><highlight class="normal"><sp/><sp/><sp/><sp/>interpolationConditions<sp/>=<sp/><ref refid="d9/d28/classproteus_1_1FemTools_1_1NodalInterpolationConditions" kindref="compound">NodalInterpolationConditions</ref>(unitTetrahedron)</highlight></codeline>
<codeline lineno="7632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.range_dim:</highlight></codeline>
<codeline lineno="7633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.range_dim:</highlight></codeline>
<codeline lineno="7634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F(i<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(i)+</highlight><highlight class="stringliteral">&quot;,<sp/>j<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(j)+</highlight><highlight class="stringliteral">&quot;)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionals[i](localFunctionSpace3D.basis[j])))</highlight></codeline>
<codeline lineno="7635"><highlight class="normal"><sp/><sp/><sp/><sp/>fListList<sp/>=<sp/>[[1.0,<sp/>0.0,<sp/>0.0,<sp/>0.0],[0.0,<sp/>1.0,<sp/>0.0,<sp/>0.0],[0.0,<sp/>0.0,<sp/>1.0,<sp/>0.0],[0.0,<sp/>0.0,<sp/>0.0,<sp/>1.0]]</highlight></codeline>
<codeline lineno="7636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>localFunctionSpace3D.range_dim:</highlight></codeline>
<codeline lineno="7637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>fList<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fListList:</highlight></codeline>
<codeline lineno="7638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(fList)</highlight></codeline>
<codeline lineno="7639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;F_i(fList)<sp/>=<sp/>&quot;</highlight><highlight class="normal">+repr(interpolationConditions.functionalsQuadrature[i](fList)))</highlight></codeline>
<codeline lineno="7640"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************ReferenceFiniteElement*********************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7641"><highlight class="normal"><sp/><sp/><sp/><sp/>referenceFiniteElement<sp/>=<sp/><ref refid="da/d9b/classproteus_1_1FemTools_1_1ReferenceFiniteElement" kindref="compound">ReferenceFiniteElement</ref>(localFunctionSpace3D,interpolationConditions)</highlight></codeline>
<codeline lineno="7642"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalDOFMap-1D************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7643"><highlight class="normal"><sp/><sp/><sp/><sp/>nnDim<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="7644"><highlight class="normal"><sp/><sp/><sp/><sp/>grid1d<sp/>=<sp/><ref refid="d1/d5b/classproteus_1_1MeshTools_1_1RectangularGrid" kindref="compound">RectangularGrid</ref>(nnDim,1,1,1.0,1.0,1.0)</highlight></codeline>
<codeline lineno="7645"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh1d<sp/>=<sp/><ref refid="d6/d38/classproteus_1_1MeshTools_1_1EdgeMesh" kindref="compound">EdgeMesh</ref>()</highlight></codeline>
<codeline lineno="7646"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh1d.rectangularToEdge(grid1d)</highlight></codeline>
<codeline lineno="7647"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh1d.writeMeshEnsight(</highlight><highlight class="stringliteral">&quot;mesh1d&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;1D<sp/>test<sp/>mesh&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7648"><highlight class="normal"><sp/><sp/><sp/><sp/>dofMap<sp/>=<sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh1d)</highlight></codeline>
<codeline lineno="7649"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nDOF&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7650"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(dofMap.nDOF)</highlight></codeline>
<codeline lineno="7651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="7652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nNodes_element):</highlight></codeline>
<codeline lineno="7653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;l2g(eN=&quot;</highlight><highlight class="normal">+repr(eN)+</highlight><highlight class="stringliteral">&quot;,nN_element=&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(dofMap.l2g[eN,nN]))</highlight></codeline>
<codeline lineno="7654"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalDOFMap-2D************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7655"><highlight class="normal"><sp/><sp/><sp/><sp/>grid2d<sp/>=<sp/><ref refid="d1/d5b/classproteus_1_1MeshTools_1_1RectangularGrid" kindref="compound">RectangularGrid</ref>(nnDim,nnDim,1,1.0,1.0,1.0)</highlight></codeline>
<codeline lineno="7656"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh2d<sp/>=<sp/><ref refid="d4/dfc/classproteus_1_1MeshTools_1_1TriangularMesh" kindref="compound">TriangularMesh</ref>()</highlight></codeline>
<codeline lineno="7657"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh2d.rectangularToTriangular(grid2d)</highlight></codeline>
<codeline lineno="7658"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh2d.writeMeshEnsight(</highlight><highlight class="stringliteral">&quot;mesh2d&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;2D<sp/>test<sp/>mesh&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7659"><highlight class="normal"><sp/><sp/><sp/><sp/>dofMap<sp/>=<sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh2d)</highlight></codeline>
<codeline lineno="7660"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nDOF&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7661"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(dofMap.nDOF)</highlight></codeline>
<codeline lineno="7662"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nNodes_element):</highlight></codeline>
<codeline lineno="7664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;l2g(eN=&quot;</highlight><highlight class="normal">+repr(eN)+</highlight><highlight class="stringliteral">&quot;,nN_element=&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(dofMap.l2g[eN,nN]))</highlight></codeline>
<codeline lineno="7665"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;****************************************NodalDOFMap-3D************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7666"><highlight class="normal"><sp/><sp/><sp/><sp/>grid3d<sp/>=<sp/><ref refid="d1/d5b/classproteus_1_1MeshTools_1_1RectangularGrid" kindref="compound">RectangularGrid</ref>(nnDim,nnDim,nnDim,1.0,1.0,1.0)</highlight></codeline>
<codeline lineno="7667"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh3d<sp/>=<sp/><ref refid="d3/d3a/classproteus_1_1MeshTools_1_1TetrahedralMesh" kindref="compound">TetrahedralMesh</ref>()</highlight></codeline>
<codeline lineno="7668"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh3d.rectangularToTetrahedral(grid3d)</highlight></codeline>
<codeline lineno="7669"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh3d.writeMeshEnsight(</highlight><highlight class="stringliteral">&quot;mesh3d&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;3D<sp/>test<sp/>mesh&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7670"><highlight class="normal"><sp/><sp/><sp/><sp/>dofMap<sp/>=<sp/><ref refid="d5/d46/classproteus_1_1FemTools_1_1NodalDOFMap" kindref="compound">NodalDOFMap</ref>(mesh3d)</highlight></codeline>
<codeline lineno="7671"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;nDOF&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7672"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(dofMap.nDOF)</highlight></codeline>
<codeline lineno="7673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="7674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nNodes_element):</highlight></codeline>
<codeline lineno="7675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;l2g(eN=&quot;</highlight><highlight class="normal">+repr(eN)+</highlight><highlight class="stringliteral">&quot;,nN_element=&quot;</highlight><highlight class="normal">+repr(nN)+</highlight><highlight class="stringliteral">&quot;)=&quot;</highlight><highlight class="normal">+repr(dofMap.l2g[eN,nN]))</highlight></codeline>
<codeline lineno="7676"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;**************************************AffineMaps-1D**************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7677"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D<sp/>=<sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh1d,unitInterval,localFunctionSpace1D)</highlight></codeline>
<codeline lineno="7678"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D,1),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7679"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray1DNew<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D,1),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7680"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D,1,1),</highlight></codeline>
<codeline lineno="7681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7682"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D,1,1),</highlight></codeline>
<codeline lineno="7683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7684"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianDeterminantArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D),</highlight></codeline>
<codeline lineno="7685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7686"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D.getValues(xiArray1D,</highlight></codeline>
<codeline lineno="7687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray1D)</highlight></codeline>
<codeline lineno="7688"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D.getJacobianValues(xiArray1D,</highlight></codeline>
<codeline lineno="7689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray1D,</highlight></codeline>
<codeline lineno="7690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray1D,</highlight></codeline>
<codeline lineno="7691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray1D)</highlight></codeline>
<codeline lineno="7692"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="7693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1D):</highlight></codeline>
<codeline lineno="7694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray1D[k])</highlight></codeline>
<codeline lineno="7696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray1D[eN,k])</highlight></codeline>
<codeline lineno="7698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobian&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianArray1D[eN,k])</highlight></codeline>
<codeline lineno="7700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobianInverse&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianInverseArray1D[eN,k])</highlight></codeline>
<codeline lineno="7702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;determinant&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianDeterminantArray1D[eN,k])</highlight></codeline>
<codeline lineno="7704"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;inverse<sp/>map&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7705"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D.getInverseValues(jacobianInverseArray1D,xArray1D,xiArray1DNew)</highlight></codeline>
<codeline lineno="7706"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="7707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1D):</highlight></codeline>
<codeline lineno="7708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray1D[k])</highlight></codeline>
<codeline lineno="7710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray1D[eN,k])</highlight></codeline>
<codeline lineno="7712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray1DNew[eN,k])</highlight></codeline>
<codeline lineno="7714"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,elementMaps1D.referenceElement.nElementBoundaries,nq1Db,elementMaps1D.referenceElement.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>metric<sp/>tensor<sp/>only<sp/>makes<sp/>sense<sp/>in<sp/>dim<sp/>&gt;<sp/>1<sp/>so<sp/>we<sp/>use<sp/>dim<sp/>here<sp/>but<sp/>dim-1<sp/>for<sp/>2<sp/>and<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7716"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="7717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps1D.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="7718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1Db,</highlight></codeline>
<codeline lineno="7719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps1D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps1D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7722"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,elementMaps1D.referenceElement.nElementBoundaries,nq1Db,elementMaps1D.referenceElement.dim,elementMaps1D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7724"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,elementMaps1D.referenceElement.nElementBoundaries,nq1Db),</highlight></codeline>
<codeline lineno="7725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7726"><highlight class="normal"><sp/><sp/><sp/><sp/>unitNormalArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,elementMaps1D.referenceElement.nElementBoundaries,nq1Db,elementMaps1D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7728"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D.getValuesTrace(xiArray0D,</highlight></codeline>
<codeline lineno="7729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray1DTrace)</highlight></codeline>
<codeline lineno="7730"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps1D.getJacobianValuesTrace(xiArray0D,</highlight></codeline>
<codeline lineno="7731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray1DTrace,</highlight></codeline>
<codeline lineno="7732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray1D,</highlight></codeline>
<codeline lineno="7733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray1D,</highlight></codeline>
<codeline lineno="7734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray1D)</highlight></codeline>
<codeline lineno="7735"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="7736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="7738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps1D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="7741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="7742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray1DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="7744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobian<sp/>inverse&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianInverseArray1DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="7746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray1D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7758"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh1d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7759"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;measured:<sp/>mesh1dFaceQuadrature.geo\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7760"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7761"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>unitNormal<sp/>unitNormal1d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7762"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="7763"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut=open(</highlight><highlight class="stringliteral">&apos;mesh1dFaceQuadrature.geo&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7764"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;quadrature<sp/>points\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;particle<sp/>coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7765"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(mesh1d.nElements_global*elementMaps1D.referenceElement.nElementBoundaries*nq1Db,))</highlight></codeline>
<codeline lineno="7766"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;unitNormal1d.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7767"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>boundary<sp/>unit<sp/>normal\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7768"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="7770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps1D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="7772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qN<sp/>=<sp/>eN*elementMaps1D.referenceElement.nElementBoundaries*nq1Db+ebN*nq1Db+k<sp/>+1</highlight></codeline>
<codeline lineno="7773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i%12.5e%12.5e%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(qN,xArray1DTrace[eN,ebN,k,0],0.0,0.0))</highlight></codeline>
<codeline lineno="7774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(unitNormalArray1D[eN,ebN,k,0],0.0,0.0))</highlight></codeline>
<codeline lineno="7775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns+=3</highlight></codeline>
<codeline lineno="7776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumns<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="7777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7779"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7780"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.close()</highlight></codeline>
<codeline lineno="7781"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.close()</highlight></codeline>
<codeline lineno="7782"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;**************************************AffineMaps-2D**************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7783"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D<sp/>=<sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh2d,unitTriangle,localFunctionSpace2D)</highlight></codeline>
<codeline lineno="7784"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="7785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="7786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7788"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray2DNew<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="7789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="7790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7792"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="7793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="7794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7797"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="7798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="7799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7802"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianDeterminantArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,nq2D),</highlight></codeline>
<codeline lineno="7803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7804"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D.getValues(xiArray2D,</highlight></codeline>
<codeline lineno="7805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray2D)</highlight></codeline>
<codeline lineno="7806"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D.getJacobianValues(xiArray2D,</highlight></codeline>
<codeline lineno="7807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray2D,</highlight></codeline>
<codeline lineno="7808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray2D,</highlight></codeline>
<codeline lineno="7809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray2D)</highlight></codeline>
<codeline lineno="7810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2D):</highlight></codeline>
<codeline lineno="7812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray2D[eN,k])</highlight></codeline>
<codeline lineno="7814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobian&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianArray2D[eN,k])</highlight></codeline>
<codeline lineno="7816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobianInverse&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianInverseArray2D[eN,k])</highlight></codeline>
<codeline lineno="7818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;determinant&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianDeterminantArray2D[eN,k])</highlight></codeline>
<codeline lineno="7820"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;inverse<sp/>map&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7821"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D.getInverseValues(jacobianInverseArray2D,xArray2D,xiArray2DNew)</highlight></codeline>
<codeline lineno="7822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2D):</highlight></codeline>
<codeline lineno="7824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray2D[k])</highlight></codeline>
<codeline lineno="7826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray2D[eN,k])</highlight></codeline>
<codeline lineno="7828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray2DNew[eN,k])</highlight></codeline>
<codeline lineno="7830"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,elementMaps2D.referenceElement.nElementBoundaries,nq2Db,elementMaps2D.referenceElement.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>metric<sp/>tensor<sp/>only<sp/>makes<sp/>sense<sp/>in<sp/>dim<sp/>&gt;<sp/>1<sp/>so<sp/>we<sp/>use<sp/>dim<sp/>here<sp/>but<sp/>dim-1<sp/>for<sp/>2<sp/>and<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7832"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="7833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="7834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2Db,</highlight></codeline>
<codeline lineno="7835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7838"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,elementMaps2D.referenceElement.nElementBoundaries,nq2Db,elementMaps2D.referenceElement.dim-1,elementMaps2D.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="7839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7840"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,elementMaps2D.referenceElement.nElementBoundaries,nq2Db),</highlight></codeline>
<codeline lineno="7841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7842"><highlight class="normal"><sp/><sp/><sp/><sp/>unitNormalArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,elementMaps2D.referenceElement.nElementBoundaries,nq2Db,elementMaps2D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7844"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D.getValuesTrace(xiArray1D,</highlight></codeline>
<codeline lineno="7845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray2DTrace)</highlight></codeline>
<codeline lineno="7846"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps2D.getJacobianValuesTrace(xiArray1D,</highlight></codeline>
<codeline lineno="7847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray2DTrace,</highlight></codeline>
<codeline lineno="7848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray2D,</highlight></codeline>
<codeline lineno="7849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray2D,</highlight></codeline>
<codeline lineno="7850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray2D)</highlight></codeline>
<codeline lineno="7851"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="7854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps2D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="7857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="7858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray2DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="7860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobian<sp/>inverse&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianInverseArray2DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="7862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray2D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7874"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh2d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7875"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;measured:<sp/>mesh2dFaceQuadrature.geo\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7876"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7877"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>unitNormal<sp/>unitNormal2d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7878"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="7879"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut=open(</highlight><highlight class="stringliteral">&apos;mesh2dFaceQuadrature.geo&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7880"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;quadrature<sp/>points\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;particle<sp/>coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7881"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(mesh2d.nElements_global*elementMaps2D.referenceElement.nElementBoundaries*nq2Db,))</highlight></codeline>
<codeline lineno="7882"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;unitNormal2d.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7883"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>boundary<sp/>unit<sp/>normal\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7884"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps2D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="7888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qN<sp/>=<sp/>eN*elementMaps2D.referenceElement.nElementBoundaries*nq2Db+ebN*nq2Db+k<sp/>+1</highlight></codeline>
<codeline lineno="7889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i%12.5e%12.5e%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(qN,xArray2DTrace[eN,ebN,k,0],xArray2DTrace[eN,ebN,k,1],0.0))</highlight></codeline>
<codeline lineno="7890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(unitNormalArray2D[eN,ebN,k,0],unitNormalArray2D[eN,ebN,k,1],0.0))</highlight></codeline>
<codeline lineno="7891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns+=3</highlight></codeline>
<codeline lineno="7892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumns<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="7893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7895"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7896"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.close()</highlight></codeline>
<codeline lineno="7897"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.close()</highlight></codeline>
<codeline lineno="7898"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;**************************************AffineMaps-3D**************************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7899"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D<sp/>=<sp/><ref refid="da/dd4/classproteus_1_1FemTools_1_1AffineMaps" kindref="compound">AffineMaps</ref>(mesh3d,unitTetrahedron,localFunctionSpace3D)</highlight></codeline>
<codeline lineno="7900"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="7901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="7902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7904"><highlight class="normal"><sp/><sp/><sp/><sp/>xiArray3DNew<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="7905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="7906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7908"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="7909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="7910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7913"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="7914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="7915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7918"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianDeterminantArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,nq3D),</highlight></codeline>
<codeline lineno="7919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7920"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D.getValues(xiArray3D,</highlight></codeline>
<codeline lineno="7921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray3D)</highlight></codeline>
<codeline lineno="7922"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D.getJacobianValues(xiArray3D,</highlight></codeline>
<codeline lineno="7923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianArray3D,</highlight></codeline>
<codeline lineno="7924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray3D,</highlight></codeline>
<codeline lineno="7925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianDeterminantArray3D)</highlight></codeline>
<codeline lineno="7926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="7927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3D):</highlight></codeline>
<codeline lineno="7928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray3D[eN,k])</highlight></codeline>
<codeline lineno="7930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobian&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianArray3D[eN,k])</highlight></codeline>
<codeline lineno="7932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;jacobianInverse&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianInverseArray3D[eN,k])</highlight></codeline>
<codeline lineno="7934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;determinant&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(jacobianDeterminantArray3D[eN,k])</highlight></codeline>
<codeline lineno="7936"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;inverse<sp/>map&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7937"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D.getInverseValues(jacobianInverseArray3D,xArray3D,xiArray3DNew)</highlight></codeline>
<codeline lineno="7938"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="7939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3D):</highlight></codeline>
<codeline lineno="7940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray3D[k])</highlight></codeline>
<codeline lineno="7942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray3D[eN,k])</highlight></codeline>
<codeline lineno="7944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;hat(x)(x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray3DNew[eN,k])</highlight></codeline>
<codeline lineno="7946"><highlight class="normal"><sp/><sp/><sp/><sp/>xArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,elementMaps3D.referenceElement.nElementBoundaries,nq3Db,elementMaps3D.referenceElement.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7947"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#the<sp/>metric<sp/>tensor<sp/>only<sp/>makes<sp/>sense<sp/>in<sp/>dim<sp/>&gt;<sp/>1<sp/>so<sp/>we<sp/>use<sp/>dim<sp/>here<sp/>but<sp/>dim-1<sp/>for<sp/>2<sp/>and<sp/>3d</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7948"><highlight class="normal"><sp/><sp/><sp/><sp/>jacobianInverseArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="7949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="7950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3Db,</highlight></codeline>
<codeline lineno="7951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim,</highlight></codeline>
<codeline lineno="7952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7954"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,elementMaps3D.referenceElement.nElementBoundaries,nq3Db,elementMaps3D.referenceElement.dim-1,elementMaps3D.referenceElement.dim-1),</highlight></codeline>
<codeline lineno="7955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7956"><highlight class="normal"><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,elementMaps3D.referenceElement.nElementBoundaries,nq3Db),</highlight></codeline>
<codeline lineno="7957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7958"><highlight class="normal"><sp/><sp/><sp/><sp/>unitNormalArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,elementMaps3D.referenceElement.nElementBoundaries,nq3Db,elementMaps3D.referenceElement.dim),</highlight></codeline>
<codeline lineno="7959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7960"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D.getValuesTrace(xiArray2D,</highlight></codeline>
<codeline lineno="7961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xArray3DTrace)</highlight></codeline>
<codeline lineno="7962"><highlight class="normal"><sp/><sp/><sp/><sp/>elementMaps3D.getJacobianValuesTrace(xiArray2D,</highlight></codeline>
<codeline lineno="7963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jacobianInverseArray3DTrace,</highlight></codeline>
<codeline lineno="7964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorArray3D,</highlight></codeline>
<codeline lineno="7965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metricTensorDeterminantSqrtArray3D,</highlight></codeline>
<codeline lineno="7966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unitNormalArray3D)</highlight></codeline>
<codeline lineno="7967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="7968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="7970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps3D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="7971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="7973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="7974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray3DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="7976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;metric<sp/>tensor<sp/>determinant<sp/>sqrt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(metricTensorDeterminantSqrtArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;unit<sp/>normal&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(unitNormalArray3D[eN,ebN,k])</highlight></codeline>
<codeline lineno="7988"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh3d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7989"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;measured:<sp/>mesh3dFaceQuadrature.geo\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7990"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;VARIABLE\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7991"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>unitNormal<sp/>unitNormal3d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7992"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="7993"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut=open(</highlight><highlight class="stringliteral">&apos;mesh3dFaceQuadrature.geo&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7994"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;quadrature<sp/>points\n&apos;</highlight><highlight class="normal">+</highlight><highlight class="stringliteral">&apos;particle<sp/>coordinates\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7995"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(mesh3d.nElements_global*elementMaps3D.referenceElement.nElementBoundaries*nq3Db,))</highlight></codeline>
<codeline lineno="7996"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;unitNormal3d.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7997"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;element<sp/>boundary<sp/>unit<sp/>normal\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7998"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="7999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="8000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps3D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="8002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qN<sp/>=<sp/>eN*elementMaps3D.referenceElement.nElementBoundaries*nq3Db+ebN*nq3Db+k<sp/>+1</highlight></codeline>
<codeline lineno="8003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quadratureOut.write(</highlight><highlight class="stringliteral">&apos;%8i%12.5e%12.5e%12.5e\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(qN,xArray3DTrace[eN,ebN,k,0],xArray3DTrace[eN,ebN,k,1],xArray3DTrace[eN,ebN,k,2]))</highlight></codeline>
<codeline lineno="8004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(unitNormalArray3D[eN,ebN,k,0],unitNormalArray3D[eN,ebN,k,1],unitNormalArray3D[eN,ebN,k,2]))</highlight></codeline>
<codeline lineno="8005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns+=3</highlight></codeline>
<codeline lineno="8006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumns<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumns<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8009"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8010"><highlight class="normal"><sp/><sp/><sp/><sp/>normalOut.close()</highlight></codeline>
<codeline lineno="8011"><highlight class="normal"><sp/><sp/><sp/><sp/>quadratureOut.close()</highlight></codeline>
<codeline lineno="8012"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*********************************C0_AffineLinearOnSimplexWithNodalBasis-1D******************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8013"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace1D<sp/>=<sp/><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>(mesh1d,1)</highlight></codeline>
<codeline lineno="8014"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,nq1D,femSpace1D.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="8015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8016"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1D,</highlight></codeline>
<codeline lineno="8018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8021"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace1D.getBasisValues(xiArray1D,vArray1D)</highlight></codeline>
<codeline lineno="8022"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace1D.getBasisGradientValues(xiArray1D,jacobianInverseArray1D,grad_vArray1D)</highlight></codeline>
<codeline lineno="8023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="8024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1D):</highlight></codeline>
<codeline lineno="8027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray1D[k])</highlight></codeline>
<codeline lineno="8031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray1D[eN,k])</highlight></codeline>
<codeline lineno="8033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace1D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray1D[eN,k,j])</highlight></codeline>
<codeline lineno="8038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray1D[eN,k,j])</highlight></codeline>
<codeline lineno="8040"><highlight class="normal"><sp/><sp/><sp/><sp/>nq1Db<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="8041"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1Db,</highlight></codeline>
<codeline lineno="8044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="8045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8046"><highlight class="normal"></highlight></codeline>
<codeline lineno="8047"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1Db,</highlight></codeline>
<codeline lineno="8050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8053"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace1D.getBasisValuesTrace(xiArray0D,vArray1DTrace)</highlight></codeline>
<codeline lineno="8054"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace1D.getBasisGradientValuesTrace(xiArray0D,jacobianInverseArray1DTrace,grad_vArray1DTrace)</highlight></codeline>
<codeline lineno="8055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="8056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace1D.referenceFiniteElement.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="8061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="8062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray0D[k])</highlight></codeline>
<codeline lineno="8066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray1DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="8068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace1D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray1DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray1DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8075"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*********************************C0_AffineLinearOnSimplexWithNodalBasis-2D******************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8076"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace2D<sp/>=<sp/><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>(mesh2d,2)</highlight></codeline>
<codeline lineno="8077"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,nq2D,femSpace2D.referenceFiniteElement.localFunctionSpace.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8078"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="8080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8083"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace2D.getBasisValues(xiArray2D,vArray2D)</highlight></codeline>
<codeline lineno="8084"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace2D.getBasisGradientValues(xiArray2D,jacobianInverseArray2D,grad_vArray2D)</highlight></codeline>
<codeline lineno="8085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="8086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2D):</highlight></codeline>
<codeline lineno="8089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray2D[k])</highlight></codeline>
<codeline lineno="8093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray2D[eN,k])</highlight></codeline>
<codeline lineno="8095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace2D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray2D[eN,k,j])</highlight></codeline>
<codeline lineno="8100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray2D[eN,k,j])</highlight></codeline>
<codeline lineno="8102"><highlight class="normal"><sp/><sp/><sp/><sp/>nq2Db<sp/>=<sp/>nq1D</highlight></codeline>
<codeline lineno="8103"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2Db,</highlight></codeline>
<codeline lineno="8106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.localFunctionSpace.dim),</highlight></codeline>
<codeline lineno="8107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8108"><highlight class="normal"></highlight></codeline>
<codeline lineno="8109"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2Db,</highlight></codeline>
<codeline lineno="8112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8115"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace2D.getBasisValuesTrace(xiArray1D,vArray2DTrace)</highlight></codeline>
<codeline lineno="8116"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace2D.getBasisGradientValuesTrace(xiArray1D,jacobianInverseArray2DTrace,grad_vArray2DTrace)</highlight></codeline>
<codeline lineno="8117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="8118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace2D.referenceFiniteElement.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="8123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="8124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray1D[k])</highlight></codeline>
<codeline lineno="8128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray2DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="8130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace2D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray2DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray2DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8137"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*********************************C0_AffineLinearOnSimplexWithNodalBasis-3D******************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8138"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace3D<sp/>=<sp/><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>(mesh3d,3)</highlight></codeline>
<codeline lineno="8139"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,nq3D,femSpace3D.referenceFiniteElement.localFunctionSpace.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8140"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="8142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8145"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace3D.getBasisValues(xiArray3D,vArray3D)</highlight></codeline>
<codeline lineno="8146"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace3D.getBasisGradientValues(xiArray3D,jacobianInverseArray3D,grad_vArray3D)</highlight></codeline>
<codeline lineno="8147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="8148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3D):</highlight></codeline>
<codeline lineno="8151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xHat&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray3D[k])</highlight></codeline>
<codeline lineno="8155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray3D[eN,k])</highlight></codeline>
<codeline lineno="8157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace3D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray3D[eN,k,j])</highlight></codeline>
<codeline lineno="8162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray3D[eN,k,j])</highlight></codeline>
<codeline lineno="8164"><highlight class="normal"><sp/><sp/><sp/><sp/>nq3Db<sp/>=<sp/>nq2D</highlight></codeline>
<codeline lineno="8165"><highlight class="normal"><sp/><sp/><sp/><sp/>vArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3Db,</highlight></codeline>
<codeline lineno="8168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.localFunctionSpace.dim),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8169"><highlight class="normal"></highlight></codeline>
<codeline lineno="8170"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3Db,</highlight></codeline>
<codeline lineno="8173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.localFunctionSpace.dim,</highlight></codeline>
<codeline lineno="8174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8176"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace3D.getBasisValuesTrace(xiArray2D,vArray3DTrace)</highlight></codeline>
<codeline lineno="8177"><highlight class="normal"><sp/><sp/><sp/><sp/>femSpace3D.getBasisGradientValuesTrace(xiArray2D,jacobianInverseArray3DTrace,grad_vArray3DTrace)</highlight></codeline>
<codeline lineno="8178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="8179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;eN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(eN)</highlight></codeline>
<codeline lineno="8181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace3D.referenceFiniteElement.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;ebN&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(ebN)</highlight></codeline>
<codeline lineno="8184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="8185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(k)</highlight></codeline>
<codeline lineno="8187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;xBar&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xiArray2D[k])</highlight></codeline>
<codeline lineno="8189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;x&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(xArray3DTrace[eN,ebN,k])</highlight></codeline>
<codeline lineno="8191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>femSpace3D.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;j&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(j)</highlight></codeline>
<codeline lineno="8194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;v&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(vArray3DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;grad(v)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(grad_vArray3DTrace[eN,ebN,k,j])</highlight></codeline>
<codeline lineno="8198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*************************************************FiniteElementFunction-1D-Scalar************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8199"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace1D,name=</highlight><highlight class="stringliteral">&quot;dist0.5&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nNodes_global):</highlight></codeline>
<codeline lineno="8201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u1ds.dof[nN]<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>((mesh1d.nodeArray[nN,0]-0.5)**2)</highlight></codeline>
<codeline lineno="8202"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh1d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8203"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1D),</highlight></codeline>
<codeline lineno="8205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8206"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray1D<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1D,</highlight></codeline>
<codeline lineno="8208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,</highlight></codeline>
<codeline lineno="8209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8211"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds.getValues(vArray1D,uArray1D)</highlight></codeline>
<codeline lineno="8212"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds.getGradientValues(grad_vArray1D,grad_uArray1D)</highlight></codeline>
<codeline lineno="8213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#read<sp/>the<sp/>values<sp/>and<sp/>gradients<sp/>back<sp/>into<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>verify<sp/>that<sp/>they<sp/>match<sp/>the<sp/>original</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8214"><highlight class="normal"><sp/><sp/><sp/><sp/>vDOF1D<sp/>=<sp/>numpy.zeros((u1ds.femSpace.dim*u1ds.dim_dof),</highlight></codeline>
<codeline lineno="8215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8216"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vDOF1D<sp/>=<sp/>numpy.zeros((u1ds.femSpace.dim*u1ds.femSpace.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(u1ds.femSpace.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="8219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u1ds.femSpace.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vDOF1D[u1ds.femSpace.dofMap.l2g[eN,nN]]<sp/>=<sp/>uArray1D[eN,nN]</highlight></codeline>
<codeline lineno="8221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF1D[u1ds.femSpace.dofMap.l2g[eN,nN]]<sp/>=<sp/>grad_uArray1D[eN,nN,0]</highlight></codeline>
<codeline lineno="8222"><highlight class="normal"><sp/><sp/><sp/><sp/>u1dsNew<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace1D,dof<sp/>=<sp/>vDOF1D,name=</highlight><highlight class="stringliteral">&quot;newdist0.5&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8223"><highlight class="normal"><sp/><sp/><sp/><sp/>u1dsNew.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh1d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8224"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u1ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace1D,dof<sp/>=<sp/>grad_vDOF1D,dim_dof=u1ds.femSpace.referenceFiniteElement.referenceElement.dim,name=</highlight><highlight class="stringliteral">&quot;graddist0.5&quot;</highlight><highlight class="normal">,isVector=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8225"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u1ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh1d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8226"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1Db),</highlight></codeline>
<codeline lineno="8229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8230"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray1DTrace<sp/>=<sp/>numpy.zeros((mesh1d.nElements_global,</highlight></codeline>
<codeline lineno="8231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq1Db,</highlight></codeline>
<codeline lineno="8233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace1D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8235"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds.getValuesTrace(vArray1DTrace,uArray1DTrace)</highlight></codeline>
<codeline lineno="8236"><highlight class="normal"><sp/><sp/><sp/><sp/>u1ds.getGradientValuesTrace(grad_vArray1DTrace,grad_uArray1DTrace)</highlight></codeline>
<codeline lineno="8237"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh1d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8238"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>measured<sp/>node:<sp/>distBoundary<sp/>distBoundary1d.scl\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8239"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>gradDistBoundary<sp/>gradDistBoundary1d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8240"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="8241"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;distBoundary1D.scl&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8242"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;distance<sp/>function<sp/>on<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8243"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;gradDistBoundary1D.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8244"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;gradient<sp/>of<sp/>distance<sp/>functionon<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8245"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8246"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh1d.nElements_global):</highlight></codeline>
<codeline lineno="8248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps1D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq1Db):</highlight></codeline>
<codeline lineno="8250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e&apos;</highlight><highlight class="normal"><sp/>%(uArray1DTrace[eN,ebN,k],))</highlight></codeline>
<codeline lineno="8251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl+=1</highlight></codeline>
<codeline lineno="8252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsScl<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(grad_uArray1DTrace[eN,ebN,k,0],0.0,0.0))</highlight></codeline>
<codeline lineno="8256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec+=3</highlight></codeline>
<codeline lineno="8257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsVec<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8260"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8261"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.close()</highlight></codeline>
<codeline lineno="8262"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8263"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.close()</highlight></codeline>
<codeline lineno="8264"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*************************************************FiniteElementFunction-2D-Scalar************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8265"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace2D,name=</highlight><highlight class="stringliteral">&quot;dist(0.5,x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nNodes_global):</highlight></codeline>
<codeline lineno="8267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u2ds.dof[nN]<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>((mesh2d.nodeArray[nN,0]<sp/>-<sp/>0.5)**2+(mesh2d.nodeArray[nN,1]-0.5)**2)</highlight></codeline>
<codeline lineno="8268"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh2d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8269"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,nq2D),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8270"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray2D<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2D,</highlight></codeline>
<codeline lineno="8272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8274"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds.getValues(vArray2D,uArray2D)</highlight></codeline>
<codeline lineno="8275"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds.getGradientValues(grad_vArray2D,grad_uArray2D)</highlight></codeline>
<codeline lineno="8276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#read<sp/>the<sp/>values<sp/>and<sp/>gradients<sp/>back<sp/>into<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>verify<sp/>that<sp/>they<sp/>match<sp/>the<sp/>original</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8277"><highlight class="normal"><sp/><sp/><sp/><sp/>vDOF2D<sp/>=<sp/>numpy.zeros((u2ds.femSpace.dim*u2ds.dim_dof),</highlight></codeline>
<codeline lineno="8278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8279"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vDOF2D<sp/>=<sp/>numpy.zeros((u2ds.femSpace.dim*u2ds.femSpace.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(u2ds.femSpace.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="8282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u2ds.femSpace.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vDOF2D[u2ds.femSpace.dofMap.l2g[eN,nN]]<sp/>=<sp/>uArray2D[eN,nN]</highlight></codeline>
<codeline lineno="8284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF2D[u2ds.femSpace.dofMap.l2g[eN,nN]*2+0]<sp/>=<sp/>grad_uArray2D[eN,nN,0]</highlight></codeline>
<codeline lineno="8285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF2D[u2ds.femSpace.dofMap.l2g[eN,nN]*2+1]<sp/>=<sp/>grad_uArray2D[eN,nN,1]</highlight></codeline>
<codeline lineno="8286"><highlight class="normal"><sp/><sp/><sp/><sp/>u2dsNew<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace2D,dof<sp/>=<sp/>vDOF2D,name=</highlight><highlight class="stringliteral">&quot;newdist0.5&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8287"><highlight class="normal"><sp/><sp/><sp/><sp/>u2dsNew.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh2d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8288"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u2ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace2D,dof<sp/>=<sp/>grad_vDOF2D,dim_dof=u2ds.femSpace.referenceFiniteElement.referenceElement.dim,name=</highlight><highlight class="stringliteral">&quot;graddist0.5&quot;</highlight><highlight class="normal">,isVector=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8289"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u2ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh2d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8290"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2Db),</highlight></codeline>
<codeline lineno="8293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8294"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray2DTrace<sp/>=<sp/>numpy.zeros((mesh2d.nElements_global,</highlight></codeline>
<codeline lineno="8295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq2Db,</highlight></codeline>
<codeline lineno="8297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace2D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8299"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds.getValuesTrace(vArray2DTrace,uArray2DTrace)</highlight></codeline>
<codeline lineno="8300"><highlight class="normal"><sp/><sp/><sp/><sp/>u2ds.getGradientValuesTrace(grad_vArray2DTrace,grad_uArray2DTrace)</highlight></codeline>
<codeline lineno="8301"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh2d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8302"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>measured<sp/>node:<sp/>distBoundary<sp/>distBoundary2d.scl\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8303"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>gradDistBoundary<sp/>gradDistBoundary2d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8304"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="8305"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;distBoundary2D.scl&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8306"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;distance<sp/>function<sp/>on<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8307"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;gradDistBoundary2D.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8308"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;gradient<sp/>of<sp/>distance<sp/>functionon<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8309"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8310"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh2d.nElements_global):</highlight></codeline>
<codeline lineno="8312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps2D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq2Db):</highlight></codeline>
<codeline lineno="8314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e&apos;</highlight><highlight class="normal"><sp/>%(uArray2DTrace[eN,ebN,k],))</highlight></codeline>
<codeline lineno="8315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl+=1</highlight></codeline>
<codeline lineno="8316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsScl<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(grad_uArray2DTrace[eN,ebN,k,0],grad_uArray2DTrace[eN,ebN,k,1],0.0))</highlight></codeline>
<codeline lineno="8320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec+=3</highlight></codeline>
<codeline lineno="8321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsVec<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8324"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8325"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.close()</highlight></codeline>
<codeline lineno="8326"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8327"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.close()</highlight></codeline>
<codeline lineno="8328"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;*************************************************FiniteElementFunction-3D-Scalar************************************************&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8329"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace3D,name=</highlight><highlight class="stringliteral">&quot;dist(0.5,x)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nNodes_global):</highlight></codeline>
<codeline lineno="8331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u3ds.dof[nN]<sp/>=<sp/><ref refid="d7/df2/namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>((mesh3d.nodeArray[nN,0]-0.5)**2+(mesh3d.nodeArray[nN,1]-0.5)**2+(mesh3d.nodeArray[nN,2]-0.5)**2)</highlight></codeline>
<codeline lineno="8332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(u3ds.dof[nN])</highlight></codeline>
<codeline lineno="8333"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh3d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8334"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,nq3D),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8335"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray3D<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3D,</highlight></codeline>
<codeline lineno="8337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8339"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds.getValues(vArray3D,uArray3D)</highlight></codeline>
<codeline lineno="8340"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds.getGradientValues(grad_vArray3D,grad_uArray3D)</highlight></codeline>
<codeline lineno="8341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#read<sp/>the<sp/>values<sp/>and<sp/>gradients<sp/>back<sp/>into<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>verify<sp/>that<sp/>they<sp/>match<sp/>the<sp/>original</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8342"><highlight class="normal"><sp/><sp/><sp/><sp/>vDOF3D<sp/>=<sp/>numpy.zeros((u3ds.femSpace.dim*u3ds.dim_dof),</highlight></codeline>
<codeline lineno="8343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8344"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_vDOF3D<sp/>=<sp/>numpy.zeros((u3ds.femSpace.dim*u3ds.femSpace.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(u3ds.femSpace.elementMaps.mesh.nElements_global):</highlight></codeline>
<codeline lineno="8347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>nN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>u3ds.femSpace.referenceFiniteElement.localFunctionSpace.range_dim:</highlight></codeline>
<codeline lineno="8348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vDOF3D[u3ds.femSpace.dofMap.l2g[eN,nN]]<sp/>=<sp/>uArray3D[eN,nN]</highlight></codeline>
<codeline lineno="8349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF3D[u3ds.femSpace.dofMap.l2g[eN,nN]*3+0]<sp/>=<sp/>grad_uArray3D[eN,nN,0]</highlight></codeline>
<codeline lineno="8350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF3D[u3ds.femSpace.dofMap.l2g[eN,nN]*3+1]<sp/>=<sp/>grad_uArray3D[eN,nN,1]</highlight></codeline>
<codeline lineno="8351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_vDOF3D[u3ds.femSpace.dofMap.l2g[eN,nN]*3+2]<sp/>=<sp/>grad_uArray3D[eN,nN,2]</highlight></codeline>
<codeline lineno="8352"><highlight class="normal"><sp/><sp/><sp/><sp/>u3dsNew<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace3D,dof<sp/>=<sp/>vDOF3D,name=</highlight><highlight class="stringliteral">&quot;newdist0.5&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8353"><highlight class="normal"><sp/><sp/><sp/><sp/>u3dsNew.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh3d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8354"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u3ds<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(femSpace3D,dof<sp/>=<sp/>grad_vDOF3D,dim_dof=u3ds.femSpace.referenceFiniteElement.referenceElement.dim,name=</highlight><highlight class="stringliteral">&quot;graddist0.5&quot;</highlight><highlight class="normal">,isVector=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8355"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_u3ds.writeFunctionEnsight(</highlight><highlight class="stringliteral">&quot;mesh3d&quot;</highlight><highlight class="normal">,append=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8356"><highlight class="normal"><sp/><sp/><sp/><sp/>uArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3Db),</highlight></codeline>
<codeline lineno="8359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8360"><highlight class="normal"><sp/><sp/><sp/><sp/>grad_uArray3DTrace<sp/>=<sp/>numpy.zeros((mesh3d.nElements_global,</highlight></codeline>
<codeline lineno="8361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.nElementBoundaries,</highlight></codeline>
<codeline lineno="8362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nq3Db,</highlight></codeline>
<codeline lineno="8363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>femSpace3D.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8365"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds.getValuesTrace(vArray3DTrace,uArray3DTrace)</highlight></codeline>
<codeline lineno="8366"><highlight class="normal"><sp/><sp/><sp/><sp/>u3ds.getGradientValuesTrace(grad_vArray3DTrace,grad_uArray3DTrace)</highlight></codeline>
<codeline lineno="8367"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut=open(</highlight><highlight class="stringliteral">&apos;mesh3d.case&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8368"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;scalar<sp/>per<sp/>measured<sp/>node:<sp/>distBoundary<sp/>distBoundary3d.scl\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8369"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.write(</highlight><highlight class="stringliteral">&apos;vector<sp/>per<sp/>measured<sp/>node:<sp/>gradDistBoundary<sp/>gradDistBoundary3d.vec\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8370"><highlight class="normal"><sp/><sp/><sp/><sp/>caseOut.close()</highlight></codeline>
<codeline lineno="8371"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;distBoundary3D.scl&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8372"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;distance<sp/>function<sp/>on<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8373"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut<sp/>=<sp/>open(</highlight><highlight class="stringliteral">&apos;gradDistBoundary3D.vec&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8374"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;gradient<sp/>of<sp/>distance<sp/>functionon<sp/>element<sp/>boundary\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8375"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8376"><highlight class="normal"><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh3d.nElements_global):</highlight></codeline>
<codeline lineno="8378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elementMaps3D.referenceElement.range_nElementBoundaries:</highlight></codeline>
<codeline lineno="8379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nq3Db):</highlight></codeline>
<codeline lineno="8380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e&apos;</highlight><highlight class="normal"><sp/>%(uArray3DTrace[eN,ebN,k],))</highlight></codeline>
<codeline lineno="8381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl+=1</highlight></codeline>
<codeline lineno="8382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsScl<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsScl<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;%12.5e%12.5e%12.5e&apos;</highlight><highlight class="normal"><sp/>%(grad_uArray3DTrace[eN,ebN,k,0],grad_uArray3DTrace[eN,ebN,k,1],grad_uArray3DTrace[eN,ebN,k,2]))</highlight></codeline>
<codeline lineno="8386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec+=3</highlight></codeline>
<codeline lineno="8387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>nColumnsVec<sp/>==<sp/>6:</highlight></codeline>
<codeline lineno="8388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nColumnsVec<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="8389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8390"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8391"><highlight class="normal"><sp/><sp/><sp/><sp/>distOut.close()</highlight></codeline>
<codeline lineno="8392"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.write(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8393"><highlight class="normal"><sp/><sp/><sp/><sp/>gradDistOut.close()</highlight></codeline>
<codeline lineno="8394"><highlight class="normal"><sp/><sp/><sp/><sp/>mlMesh1D<sp/>=<sp/><ref refid="da/def/classproteus_1_1MeshTools_1_1MultilevelEdgeMesh" kindref="compound">MultilevelEdgeMesh</ref>(3,1,1,refinementLevels=3)</highlight></codeline>
<codeline lineno="8395"><highlight class="normal"><sp/><sp/><sp/><sp/>meshTransfers1D<sp/>=<sp/><ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" kindref="compound">MultilevelProjectionOperators</ref>(mlMesh1D,C0_AffineLinearOnSimplexWithNodalBasis,1)</highlight></codeline>
<codeline lineno="8396"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers1D.prolongList)</highlight></codeline>
<codeline lineno="8397"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers1D.restrictList)</highlight></codeline>
<codeline lineno="8398"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers1D.prolong_bcList)</highlight></codeline>
<codeline lineno="8399"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers1D.restrict_bcList)</highlight></codeline>
<codeline lineno="8400"><highlight class="normal"><sp/><sp/><sp/><sp/>mlMesh2D<sp/>=<sp/><ref refid="d7/d32/classproteus_1_1MeshTools_1_1MultilevelTriangularMesh" kindref="compound">MultilevelTriangularMesh</ref>(3,3,1,refinementLevels=3)</highlight></codeline>
<codeline lineno="8401"><highlight class="normal"><sp/><sp/><sp/><sp/>meshTransfers2D<sp/>=<sp/><ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" kindref="compound">MultilevelProjectionOperators</ref>(mlMesh2D,C0_AffineLinearOnSimplexWithNodalBasis,2)</highlight></codeline>
<codeline lineno="8402"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers2D.prolongList)</highlight></codeline>
<codeline lineno="8403"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers2D.restrictList)</highlight></codeline>
<codeline lineno="8404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers2D.prolong_bcList)</highlight></codeline>
<codeline lineno="8405"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers2D.restrict_bcList)</highlight></codeline>
<codeline lineno="8406"><highlight class="normal"><sp/><sp/><sp/><sp/>mlMesh3D<sp/>=<sp/><ref refid="d2/da4/classproteus_1_1MeshTools_1_1MultilevelTetrahedralMesh" kindref="compound">MultilevelTetrahedralMesh</ref>(3,3,3,refinementLevels=3)</highlight></codeline>
<codeline lineno="8407"><highlight class="normal"><sp/><sp/><sp/><sp/>meshTransfers3D<sp/>=<sp/><ref refid="d9/db8/classproteus_1_1FemTools_1_1MultilevelProjectionOperators" kindref="compound">MultilevelProjectionOperators</ref>(mlMesh3D,C0_AffineLinearOnSimplexWithNodalBasis,3)</highlight></codeline>
<codeline lineno="8408"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers3D.prolongList)</highlight></codeline>
<codeline lineno="8409"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers3D.restrictList)</highlight></codeline>
<codeline lineno="8410"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers3D.prolong_bcList)</highlight></codeline>
<codeline lineno="8411"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(meshTransfers3D.restrict_bcList)</highlight></codeline>
<codeline lineno="8412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>mwf<sp/>tests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8415"><highlight class="normal"><sp/><sp/><sp/><sp/>verboseLevel<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="8416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#first<sp/>just<sp/>create<sp/>a<sp/>simple<sp/>triangular<sp/>mesh<sp/>and<sp/>look<sp/>at<sp/>it<sp/>in<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#couple<sp/>of<sp/>different<sp/>ways</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8418"><highlight class="normal"><sp/><sp/><sp/><sp/>Lx<sp/>=<sp/>1.0<sp/><sp/><sp/></highlight><highlight class="comment">#domain<sp/>length<sp/>in<sp/>x<sp/>and<sp/>y</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8419"><highlight class="normal"><sp/><sp/><sp/><sp/>Ly<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="8420"><highlight class="normal"></highlight></codeline>
<codeline lineno="8421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#number<sp/>of<sp/>nodes<sp/>for<sp/>rectangular<sp/>grid<sp/>upon<sp/>which<sp/>triangular<sp/>mesh</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#will<sp/>be<sp/>built<sp/>should<sp/>get<sp/>2<sp/>triangles<sp/>for<sp/>each<sp/>rectangle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#(nx-1)(ny-1)<sp/>in<sp/>the<sp/>original<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8424"><highlight class="normal"><sp/><sp/><sp/><sp/>nx<sp/>=<sp/>21</highlight></codeline>
<codeline lineno="8425"><highlight class="normal"><sp/><sp/><sp/><sp/>ny<sp/>=<sp/>21</highlight></codeline>
<codeline lineno="8426"><highlight class="normal"></highlight></codeline>
<codeline lineno="8427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#flag<sp/>for<sp/>viewing<sp/>mesh<sp/>in<sp/>construction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#0<sp/>--<sp/>do<sp/>nothing<sp/>(default)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#1<sp/>--<sp/>gnuplot</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#2<sp/>--<sp/>matlab</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8431"><highlight class="normal"><sp/><sp/><sp/><sp/>viewMesh<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="8432"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh<sp/>=<sp/><ref refid="d4/dfc/classproteus_1_1MeshTools_1_1TriangularMesh" kindref="compound">TriangularMesh</ref>()</highlight></codeline>
<codeline lineno="8433"><highlight class="normal"><sp/><sp/><sp/><sp/>mesh.constructTriangularMeshOnRectangle(Lx,Ly,nx,ny,viewMesh)</highlight></codeline>
<codeline lineno="8434"><highlight class="normal"></highlight></codeline>
<codeline lineno="8435"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;mesh<sp/>Info<sp/>says<sp/>\n&apos;</highlight><highlight class="normal">,mesh.meshInfo())</highlight></codeline>
<codeline lineno="8436"><highlight class="normal"></highlight></codeline>
<codeline lineno="8437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#now<sp/>create<sp/>a<sp/>DG1<sp/>finite<sp/>element<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8438"><highlight class="normal"><sp/><sp/><sp/><sp/>globalDGspace<sp/>=<sp/><ref refid="d7/d60/classproteus_1_1FemTools_1_1DG__AffineLinearOnSimplexWithNodalBasis" kindref="compound">DG_AffineLinearOnSimplexWithNodalBasis</ref>(mesh,2)</highlight></codeline>
<codeline lineno="8439"><highlight class="normal"><sp/><sp/><sp/><sp/>globalCGspace<sp/>=<sp/><ref refid="d3/dbf/classproteus_1_1FemTools_1_1C0__AffineLinearOnSimplexWithNodalBasis" kindref="compound">C0_AffineLinearOnSimplexWithNodalBasis</ref>(mesh,2)</highlight></codeline>
<codeline lineno="8440"><highlight class="normal"><sp/><sp/><sp/><sp/>dgDofMap<sp/>=<sp/>globalDGspace.dofMap</highlight></codeline>
<codeline lineno="8441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>verboseLevel<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="8442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&quot;DG1<sp/>dofMap<sp/>l2g<sp/>is<sp/>&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>eN<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="8444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sn<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;\t<sp/>%i<sp/>%i<sp/>%i&apos;</highlight><highlight class="normal"><sp/>%<sp/>tuple(dgDofMap.l2g[eN,:])</highlight></codeline>
<codeline lineno="8445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(sn)</highlight></codeline>
<codeline lineno="8446"><highlight class="normal"><sp/><sp/><sp/><sp/>ngdim<sp/>=<sp/>globalDGspace.dim</highlight></codeline>
<codeline lineno="8447"><highlight class="normal"><sp/><sp/><sp/><sp/>nelem<sp/>=<sp/>mesh.nElements_global</highlight></codeline>
<codeline lineno="8448"><highlight class="normal"><sp/><sp/><sp/><sp/>polydim<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="8449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#what<sp/>about<sp/>a<sp/>member<sp/>of<sp/>the<sp/>DG1<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8450"><highlight class="normal"><sp/><sp/><sp/><sp/>u<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(globalDGspace)</highlight></codeline>
<codeline lineno="8451"><highlight class="normal"><sp/><sp/><sp/><sp/>ucg<sp/>=<sp/><ref refid="db/d0a/classproteus_1_1FemTools_1_1FiniteElementFunction" kindref="compound">FiniteElementFunction</ref>(globalCGspace)</highlight></codeline>
<codeline lineno="8452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#try<sp/>to<sp/>just<sp/>calculate<sp/>u<sp/>as<sp/>an<sp/>analytical<sp/>function<sp/>of<sp/>x</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodalRefPoints<sp/>=<sp/>numpy.zeros((polydim,3),&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodalRefPoints[0,:]<sp/>=<sp/>(0.0,0.0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodalRefPoints[1,:]<sp/>=<sp/>(1.0,0.0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#nodalRefPoints[2,:]<sp/>=<sp/>(0.0,1.0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8457"><highlight class="normal"><sp/><sp/><sp/><sp/>nodalRefPoints<sp/>=<sp/>u.femSpace.referenceFiniteElement.interpolationConditions.quadraturePointArray</highlight></codeline>
<codeline lineno="8458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>verboseLevel<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="8459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;nodalRefPoints<sp/>=<sp/>\n&apos;</highlight><highlight class="normal">,nodalRefPoints)</highlight></codeline>
<codeline lineno="8460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>verbose<sp/>check</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8461"><highlight class="normal"></highlight></codeline>
<codeline lineno="8462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#physNodes<sp/>=<sp/>numpy.zeros((nelem,polydim,2),&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8463"><highlight class="normal"><sp/><sp/><sp/><sp/>physNodes<sp/>=<sp/>numpy.zeros((mesh.nElements_global,</highlight></codeline>
<codeline lineno="8464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.interpolationConditions.nQuadraturePoints,</highlight></codeline>
<codeline lineno="8465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.femSpace.referenceFiniteElement.referenceElement.dim),</highlight></codeline>
<codeline lineno="8466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8467"><highlight class="normal"></highlight></codeline>
<codeline lineno="8468"><highlight class="normal"><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.getValues(nodalRefPoints,physNodes)</highlight></codeline>
<codeline lineno="8469"><highlight class="normal"></highlight></codeline>
<codeline lineno="8470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>verboseLevel<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="8471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;physical<sp/>Nodes<sp/>=<sp/>\n&apos;</highlight><highlight class="normal">,physNodes)</highlight></codeline>
<codeline lineno="8472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>verbose<sp/>check</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8473"><highlight class="normal"></highlight></codeline>
<codeline lineno="8474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#set<sp/>value<sp/>of<sp/>u<sp/>manually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ie<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nElements_global):</highlight></codeline>
<codeline lineno="8476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>iv<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(u.femSpace.referenceFiniteElement.localFunctionSpace.dim):</highlight></codeline>
<codeline lineno="8477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>px<sp/>=<sp/>physNodes[ie,iv,0]</highlight></codeline>
<codeline lineno="8478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>py<sp/>=<sp/>physNodes[ie,iv,1]</highlight></codeline>
<codeline lineno="8479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ig<sp/>=<sp/>u.femSpace.dofMap.l2g[ie,iv]</highlight></codeline>
<codeline lineno="8480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u.dof[ig]<sp/>=<sp/>math.sin(0.5*math.pi*px)*math.cos(0.5*math.pi*py)</highlight></codeline>
<codeline lineno="8481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ucg.dof[ucg.femSpace.dofMap.l2g[ie,iv]]<sp/>=<sp/>u.dof[ig]</highlight></codeline>
<codeline lineno="8482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>local<sp/>shape<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>element<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8484"><highlight class="normal"></highlight></codeline>
<codeline lineno="8485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>verboseLevel<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="8486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;u<sp/>dof<sp/>values<sp/>=<sp/>\n&apos;</highlight><highlight class="normal">,u.dof)</highlight></codeline>
<codeline lineno="8487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>verbose<sp/>check</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8488"><highlight class="normal"></highlight></codeline>
<codeline lineno="8489"><highlight class="normal"><sp/><sp/><sp/><sp/>u.writeFunctionMatlab(</highlight><highlight class="stringliteral">&apos;sol&apos;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&apos;mesh&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8490"><highlight class="normal"></highlight></codeline>
<codeline lineno="8491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#moved<sp/><sp/>to<sp/>MeshTools.py<sp/>cek</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if<sp/>verboseLevel<sp/>&gt;<sp/>0:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>#now<sp/>look<sp/>at<sp/>edge<sp/>--&gt;<sp/>element<sp/>loops<sp/>for<sp/>dg<sp/>algorithms</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>testEdgeToElementMapping(mesh)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#end<sp/>verbose</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#try<sp/>to<sp/>build<sp/>trace<sp/>operators<sp/>in<sp/>crude<sp/>way</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#traceOp<sp/>=<sp/>buildTraceOpArray(mesh,globalDGspace,verboseLevel)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def<sp/>checkFunctionTrace(u,mesh,dgspace,traceArray,jumpTol=1.0e-8):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#cek</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Changing<sp/>this<sp/>to<sp/>the<sp/>way<sp/>one<sp/>would<sp/>do<sp/>it<sp/>with<sp/>FemTools</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8503"><highlight class="normal"><sp/><sp/><sp/><sp/>jumpTol=1.0e-8</highlight></codeline>
<codeline lineno="8504"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8505"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>take<sp/>a<sp/>dg<sp/>finite<sp/>element<sp/>function<sp/>and<sp/>see<sp/>if<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8506"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>differ<sp/>from<sp/>left<sp/>and<sp/>right<sp/>neighbors<sp/>on<sp/>an<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8507"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>Basically,<sp/>it&apos;s<sp/>computing<sp/>a<sp/>jump<sp/>term.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8508"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>a<sp/>continuous<sp/>solution,<sp/>should<sp/>get<sp/>no<sp/>difference.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8509"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8510"><highlight class="normal"></highlight></codeline>
<codeline lineno="8511"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>#global<sp/>number<sp/>of<sp/>edges<sp/>and<sp/>elements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8512"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>ngEdges<sp/>=<sp/>mesh.nElementBoundaries_global</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8513"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>ngElems<sp/>=<sp/>mesh.nElements_global</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8514"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8515"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>polyOrder<sp/><sp/>=<sp/>dgspace.polyOrder</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8516"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>edgeDim<sp/><sp/><sp/><sp/>=<sp/>polyOrder+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8517"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>elemDim<sp/><sp/><sp/><sp/>=<sp/>dgspace.localDim</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8518"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>#hold<sp/>local<sp/>element<sp/>dofs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8519"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>locDofValues<sp/>=<sp/>numpy.zeros((elemDim),&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8520"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>globedge<sp/>in<sp/>range(ngEdges):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8521"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jumpValues<sp/><sp/><sp/>=<sp/>numpy.zeros((edgeDim),&apos;d&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8522"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>neig<sp/>in<sp/>range(2):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8523"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elid<sp/>=<sp/>mesh.elementBoundaryElementsArray[globedge,neig]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8524"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>elid<sp/>&gt;<sp/>-1:<sp/>#element<sp/>neighbor<sp/>exists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8525"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>k<sp/>in<sp/>range(elemDim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8526"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ig<sp/>=<sp/>u.femSpace.dofMap.l2g[elid,k]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8527"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>locDofValues[k]<sp/>=<sp/>u.dof[ig]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8528"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8529"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>j<sp/>in<sp/>range(edgeDim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8530"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>k<sp/>in<sp/>range(elemDim):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8531"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jumpValues[j]<sp/>+=<sp/>(1.0-2.*neig)*traceArray[globedge,neig,j,k]*locDofValues[k]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8532"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>k</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8533"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>j</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8534"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else:<sp/>#what<sp/>to<sp/>do<sp/>about<sp/>edges<sp/>on<sp/>bounary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8535"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jumpValues<sp/>*=<sp/>0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8536"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8537"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>neig<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8538"><highlight class="normal"><sp/><sp/><sp/><sp/>nElementBoundaryPoints<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="8539"><highlight class="normal"><sp/><sp/><sp/><sp/>elementBoundaryPoints<sp/>=<sp/>numpy.array([[0.0],[1.0]])</highlight></codeline>
<codeline lineno="8540"><highlight class="normal"><sp/><sp/><sp/><sp/>jumps<sp/>=<sp/>numpy.zeros((mesh.nInteriorElementBoundaries_global,nElementBoundaryPoints),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8541"><highlight class="normal"><sp/><sp/><sp/><sp/>physTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,2),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8542"><highlight class="normal"><sp/><sp/><sp/><sp/>refTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,2),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8543"><highlight class="normal"><sp/><sp/><sp/><sp/>invjArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,2,2),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8544"><highlight class="normal"><sp/><sp/><sp/><sp/>gArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,2,1),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8545"><highlight class="normal"><sp/><sp/><sp/><sp/>sqrt_det_gArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8546"><highlight class="normal"><sp/><sp/><sp/><sp/>nArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,2),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8547"><highlight class="normal"><sp/><sp/><sp/><sp/>elementBoundaryPointsArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,1),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8548"><highlight class="normal"><sp/><sp/><sp/><sp/>vTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,u.femSpace.max_nDOF_element),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8549"><highlight class="normal"><sp/><sp/><sp/><sp/>vcgTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints,u.femSpace.max_nDOF_element),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8550"><highlight class="normal"><sp/><sp/><sp/><sp/>uTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8551"><highlight class="normal"><sp/><sp/><sp/><sp/>ucgTraceArray<sp/>=<sp/>numpy.zeros((mesh.nElements_global,mesh.nElementBoundaries_element,nElementBoundaryPoints),</highlight><highlight class="stringliteral">&apos;d&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8552"><highlight class="normal"><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.getValuesTrace(elementBoundaryPoints,physTraceArray)</highlight></codeline>
<codeline lineno="8553"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNI<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nInteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="8554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.interiorElementBoundariesArray[ebNI]</highlight></codeline>
<codeline lineno="8555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_eN_global<sp/><sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][0]</highlight></codeline>
<codeline lineno="8556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_eN_global<sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][1]</highlight></codeline>
<codeline lineno="8557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_ebN_element<sp/><sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][0]</highlight></codeline>
<codeline lineno="8558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][1]</highlight></codeline>
<codeline lineno="8559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryPoints):</highlight></codeline>
<codeline lineno="8560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>physTraceArray[right_eN_global,right_ebN_element,n,:]<sp/>=<sp/>physTraceArray[left_eN_global,left_ebN_element,n]</highlight></codeline>
<codeline lineno="8561"><highlight class="normal"><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.getJacobianValuesTrace(refTraceArray,invjArray,gArray,sqrt_det_gArray,nArray)</highlight></codeline>
<codeline lineno="8562"><highlight class="normal"><sp/><sp/><sp/><sp/>u.femSpace.elementMaps.getInverseValuesTrace(physTraceArray,refTraceArray)</highlight></codeline>
<codeline lineno="8563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNI<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nInteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="8564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.interiorElementBoundariesArray[ebNI]</highlight></codeline>
<codeline lineno="8565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_eN_global<sp/><sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][0]</highlight></codeline>
<codeline lineno="8566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_eN_global<sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][1]</highlight></codeline>
<codeline lineno="8567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_ebN_element<sp/><sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][0]</highlight></codeline>
<codeline lineno="8568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][1]</highlight></codeline>
<codeline lineno="8569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryPoints):</highlight></codeline>
<codeline lineno="8570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryPointsArray[left_eN_global,left_ebN_element,n,:]=elementBoundaryPoints[n]</highlight></codeline>
<codeline lineno="8571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryPointsArray[right_eN_global,right_ebN_element,n,:]=<sp/>u.femSpace.referenceFiniteElement.referenceElement.boundaryMapInverseList[right_ebN_element](refTraceArray[right_eN_global,right_ebN_element,n])</highlight></codeline>
<codeline lineno="8572"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNE<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nExteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="8573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.exteriorElementBoundariesArray[ebNE]</highlight></codeline>
<codeline lineno="8574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eN_global<sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][0]</highlight></codeline>
<codeline lineno="8575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][0]</highlight></codeline>
<codeline lineno="8576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryPoints):</highlight></codeline>
<codeline lineno="8577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elementBoundaryPointsArray[eN_global,ebN_element,n,:]<sp/>=<sp/>elementBoundaryPoints[n]</highlight></codeline>
<codeline lineno="8578"><highlight class="normal"><sp/><sp/><sp/><sp/>u.femSpace.getBasisValuesTraceAtArray(elementBoundaryPointsArray,vTraceArray)</highlight></codeline>
<codeline lineno="8579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#u.femSpace.getBasisValuesTrace(elementBoundaryPoints,vTraceArray)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8580"><highlight class="normal"><sp/><sp/><sp/><sp/>u.getValuesTrace(vTraceArray,uTraceArray)</highlight></codeline>
<codeline lineno="8581"><highlight class="normal"><sp/><sp/><sp/><sp/>ucg.femSpace.getBasisValuesTrace(elementBoundaryPoints,vcgTraceArray)</highlight></codeline>
<codeline lineno="8582"><highlight class="normal"><sp/><sp/><sp/><sp/>ucg.getValuesTrace(vcgTraceArray,ucgTraceArray)</highlight></codeline>
<codeline lineno="8583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ebNI<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(mesh.nInteriorElementBoundaries_global):</highlight></codeline>
<codeline lineno="8584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ebN<sp/>=<sp/>mesh.interiorElementBoundariesArray[ebNI]</highlight></codeline>
<codeline lineno="8585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_eN_global<sp/><sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][0]</highlight></codeline>
<codeline lineno="8586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_eN_global<sp/><sp/>=<sp/>mesh.elementBoundaryElementsArray[ebN][1]</highlight></codeline>
<codeline lineno="8587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_ebN_element<sp/><sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][0]</highlight></codeline>
<codeline lineno="8588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_ebN_element<sp/>=<sp/>mesh.elementBoundaryLocalElementBoundariesArray[ebN][1]</highlight></codeline>
<codeline lineno="8589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nElementBoundaryPoints):</highlight></codeline>
<codeline lineno="8590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jumps[ebNI,n]<sp/>=<sp/>uTraceArray[left_eN_global,left_ebN_element,n]<sp/>-<sp/>uTraceArray[right_eN_global,right_ebN_element,n]</highlight></codeline>
<codeline lineno="8591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>abs(jumps[ebNI,n])<sp/>&gt;<sp/>jumpTol:</highlight></codeline>
<codeline lineno="8592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;Warning<sp/>edge<sp/>&apos;</highlight><highlight class="normal">,ebN,</highlight><highlight class="stringliteral">&apos;<sp/>jumpValues<sp/>big=<sp/>\n&apos;</highlight><highlight class="normal">,jumps[ebNI,n])</highlight></codeline>
<codeline lineno="8593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;left<sp/>element<sp/>&apos;</highlight><highlight class="normal">,left_eN_global,</highlight><highlight class="stringliteral">&apos;left<sp/>edge<sp/>&apos;</highlight><highlight class="normal">,left_ebN_element,</highlight><highlight class="stringliteral">&apos;<sp/>value<sp/>=<sp/>&apos;</highlight><highlight class="normal">,uTraceArray[left_eN_global,left_ebN_element,n])</highlight></codeline>
<codeline lineno="8594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;right<sp/>element<sp/>&apos;</highlight><highlight class="normal">,right_eN_global,</highlight><highlight class="stringliteral">&apos;right<sp/>edge<sp/>&apos;</highlight><highlight class="normal">,<sp/>right_eN_global,</highlight><highlight class="stringliteral">&apos;<sp/>value<sp/>=<sp/>&apos;</highlight><highlight class="normal">,uTraceArray[right_eN_global,right_ebN_element,n])</highlight></codeline>
<codeline lineno="8595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;left<sp/>element<sp/>&apos;</highlight><highlight class="normal">,left_eN_global,</highlight><highlight class="stringliteral">&apos;left<sp/>edge<sp/>&apos;</highlight><highlight class="normal">,left_ebN_element,</highlight><highlight class="stringliteral">&apos;<sp/>value<sp/>=<sp/>&apos;</highlight><highlight class="normal">,ucgTraceArray[left_eN_global,left_ebN_element,n])</highlight></codeline>
<codeline lineno="8596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(</highlight><highlight class="stringliteral">&apos;right<sp/>element<sp/>&apos;</highlight><highlight class="normal">,right_eN_global,</highlight><highlight class="stringliteral">&apos;right<sp/>edge<sp/>&apos;</highlight><highlight class="normal">,<sp/>right_eN_global,</highlight><highlight class="stringliteral">&apos;<sp/>value<sp/>=<sp/>&apos;</highlight><highlight class="normal">,ucgTraceArray[right_eN_global,right_ebN_element,n])</highlight></codeline>
<codeline lineno="8597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(physTraceArray[left_eN_global,left_ebN_element,n])</highlight></codeline>
<codeline lineno="8598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(physTraceArray[right_eN_global,right_ebN_element,n])</highlight></codeline>
<codeline lineno="8599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(math.sin(0.5*math.pi*physTraceArray[left_eN_global,left_ebN_element,n,0])*math.cos(0.5*math.pi*physTraceArray[left_eN_global,left_ebN_element,n,1]))</highlight></codeline>
<codeline lineno="8600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/dcc/jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(math.sin(0.5*math.pi*physTraceArray[right_eN_global,right_ebN_element,n,0])*math.cos(0.5*math.pi*physTraceArray[right_eN_global,right_ebN_element,n,1]))</highlight></codeline>
<codeline lineno="8601"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>if<sp/>big<sp/>jump</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8602"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>#end<sp/>for<sp/>loop<sp/>on<sp/>edges</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8603"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/>#end<sp/>checkFunctionTrace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#check<sp/>if<sp/>contiuous<sp/>solution<sp/>has<sp/>no<sp/>jumps?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#checkFunctionTrace(u,mesh,globalDGspace,traceOp)</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="FemTools.py"/>
  </compounddef>
</doxygen>
