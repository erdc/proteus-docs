<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="AnalyticalSolutions_8py" kind="file" language="Python">
    <compoundname>AnalyticalSolutions.py</compoundname>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" prot="public">proteus::AnalyticalSolutions::AS_base</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base" prot="public">proteus::AnalyticalSolutions::DAE_base</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearDAE" prot="public">proteus::AnalyticalSolutions::NonlinearDAE</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" prot="public">proteus::AnalyticalSolutions::SteadyState</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState" prot="public">proteus::AnalyticalSolutions::LinearAD_SteadyState</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState" prot="public">proteus::AnalyticalSolutions::NonlinearAD_SteadyState</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine" prot="public">proteus::AnalyticalSolutions::LinearADR_Sine</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation" prot="public">proteus::AnalyticalSolutions::PoissonsEquation</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC" prot="public">proteus::AnalyticalSolutions::LinearAD_DiracIC</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC" prot="public">proteus::AnalyticalSolutions::LinearADR_Decay_DiracIC</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC" prot="public">proteus::AnalyticalSolutions::NonlinearADR_Decay_DiracIC</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u" prot="public">proteus::AnalyticalSolutions::PlaneCouetteFlow_u</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__v" prot="public">proteus::AnalyticalSolutions::PlaneCouetteFlow_v</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__p" prot="public">proteus::AnalyticalSolutions::PlaneCouetteFlow_p</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_u</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_v</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_p</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln" prot="public">proteus::AnalyticalSolutions::Buckley_Leverett_RiemannSoln</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" prot="public">proteus::AnalyticalSolutions::PlaneBase</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u2" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_u2</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v2" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_v2</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__w2" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_w2</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p2" prot="public">proteus::AnalyticalSolutions::PlanePoiseuilleFlow_p2</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u" prot="public">proteus::AnalyticalSolutions::VortexDecay_u</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v" prot="public">proteus::AnalyticalSolutions::VortexDecay_v</innerclass>
    <innerclass refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p" prot="public">proteus::AnalyticalSolutions::VortexDecay_p</innerclass>
    <innernamespace refid="namespaceproteus_1_1AnalyticalSolutions">proteus::AnalyticalSolutions</innernamespace>
    <innernamespace refid="namespacemath">math</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespaceproteus_1_1AnalyticalSolutions" refkind="compound"><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="2"><highlight class="stringliteral">Classes<sp/>representing<sp/>analytical<sp/>solutions<sp/>of<sp/>differential<sp/>and<sp/>partial<sp/>differential<sp/>equations.</highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral">..<sp/>inheritance-diagram::<sp/>proteus.AnalyticalSolutions</highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral"><sp/><sp/><sp/>:parts:<sp/>1</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_function</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>absolute_import</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>division</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>range</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>past.utils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>old_div</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>object</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>math<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.EGeometry<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.LinearAlgebraTools<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.Profiling<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logEvent</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>(object):</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="21"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>base<sp/>class<sp/>for<sp/>general<sp/>analytical<sp/>solutions,<sp/>u(x,y,z,t)</highlight></codeline>
<codeline lineno="22"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="23"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>basic<sp/>error<sp/>calculations<sp/>only<sp/>the<sp/>:func:`uOfXT`<sp/>member<sp/>need<sp/>be</highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>overridden.<sp/>The<sp/>vectorized<sp/>member<sp/>functions<sp/>such<sp/>as</highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>:func:`getUOfXT`<sp/>are<sp/>provided<sp/>for<sp/>future<sp/>optimizations<sp/>but<sp/>are</highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>implemented<sp/>in<sp/>:class:`AS_base`<sp/>in<sp/>a<sp/>simple,<sp/>inefficient<sp/>way.</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a5dc41319985a76409271c0436fe3c413" kindref="member">uOfXT</ref>(self,<sp/>X,<sp/>T):</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>solution<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a30f91e1a99d5862a2d06798a455885ee" kindref="member">duOfXT</ref>(self,<sp/>X,<sp/>T):</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="37"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>gradient<sp/>of<sp/>the<sp/>solution<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="38"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>..<sp/>todo::<sp/>Change<sp/>du<sp/>to<sp/>Du</highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a622fef9f7039bbc91b55dd8ea53843c5" kindref="member">rOfUX</ref>(self,<sp/>u,<sp/>x):</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="45"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>reaction<sp/>term<sp/>for<sp/>the<sp/>(manufactured)<sp/>solution<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="46"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a33a42d1d93af0085631bba375dabd7c0" kindref="member">drOfUX</ref>(self,<sp/>u,<sp/>x):</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>derivative<sp/>of<sp/>the<sp/>reaction<sp/>term<sp/>for<sp/>the<sp/>(manufactured)<sp/>solution<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a22b903d5b333a2befda635614f47be58" kindref="member">advectiveFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="57"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>advective<sp/>flux<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X</highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="59"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>..<sp/>todo::<sp/>Change<sp/>advective<sp/>flux<sp/>to<sp/>depend<sp/>on<sp/>T</highlight></codeline>
<codeline lineno="60"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a6d3dc510ef4df570b055a1fe562909d1" kindref="member">diffusiveFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="65"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>diffusive<sp/>flux<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X</highlight></codeline>
<codeline lineno="66"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="67"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>..<sp/>todo::<sp/>Change<sp/>advective<sp/>flux<sp/>to<sp/>depend<sp/>on<sp/>T</highlight></codeline>
<codeline lineno="68"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a29bac67fcf3c6aa9959b462435d4ebac" kindref="member">totalFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="73"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>the<sp/>total<sp/>flux<sp/>at<sp/>a<sp/>3D<sp/>point,<sp/>X</highlight></codeline>
<codeline lineno="74"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="75"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>..<sp/>todo::<sp/>Decide<sp/>if<sp/>we<sp/>need<sp/>total<sp/>flux</highlight></codeline>
<codeline lineno="76"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1abe255ce68f23130d43ec6c4de440d744" kindref="member">getUOfXT</ref>(self,<sp/>X,<sp/>T,<sp/>U):</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="81"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>solution,<sp/>U,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="82"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_to_v(self.uOfXT,<sp/>X,<sp/>T,<sp/>U)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a365a00503f20227a20d40c74bcc5e698" kindref="member">getDUOfXT</ref>(self,<sp/>X,<sp/>T,<sp/>DU):</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="87"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>gradient<sp/>of<sp/>the<sp/>solution,<sp/>DU,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="88"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_to_v(self.duOfXT,<sp/>X,<sp/>T,<sp/>DU)</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a2a906f5042d48c78d0b1395187768618" kindref="member">getROfUX</ref>(self,<sp/>X,<sp/>T,<sp/>R):</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="93"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>reaction<sp/>term,<sp/>R,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="94"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.coeff_p_to_v(self.rOfXT,<sp/>U,<sp/>X,<sp/>T,<sp/>R)</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a90ffc7d88e2780f1299fe82a45843068" kindref="member">getDROfUX</ref>(self,<sp/>X,<sp/>T,<sp/>DR):</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="99"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>derivative<sp/>of<sp/>the<sp/>reaction<sp/>term,<sp/>DR,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.coeff_p_to_v(self.drOfXT,<sp/>U,<sp/>X,<sp/>T,<sp/>DR)</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1ad7bdfa12176c2289d2171ea65a9363c8" kindref="member">getAdvectiveFluxOfXT</ref>(self,<sp/>X,<sp/>T,<sp/>F):</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>advective<sp/>flux,<sp/>F,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="106"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_to_v(self.advectiveFluxOfXT,<sp/>X,<sp/>T,<sp/>F)</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a04e2b37f2f3bbbcd217f1f95d8080343" kindref="member">getDiffusiveFluxOfX</ref>(self,<sp/>X,<sp/>T,<sp/>F):</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="111"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>diffusive<sp/>flux,<sp/>F,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="112"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_to_v(self.diffusiveFluxOfXT,<sp/>X,<sp/>T,<sp/>F)</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a0312acdb70fd906b90d2716225718af3" kindref="member">getTotalFluxOfX</ref>(self,<sp/>X,<sp/>T,<sp/>F):</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="117"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>total<sp/>flux,<sp/>F,<sp/>at<sp/>an<sp/>array<sp/>of<sp/>3D<sp/>points,<sp/>X,<sp/>and<sp/>a<sp/>time,<sp/>T</highlight></codeline>
<codeline lineno="118"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_to_v(self.totalFluxOfXT,<sp/>X,<sp/>T,<sp/>F)</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a3295a58fdbe36c5a1f512cac200506b8" kindref="member">p_to_v</ref>(self,<sp/>func,<sp/>X,<sp/>T,<sp/>funcValVec):</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="123"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculate<sp/>a<sp/>point-wise<sp/>function<sp/>over<sp/>and<sp/>array<sp/>of<sp/>points.</highlight></codeline>
<codeline lineno="124"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nPoints<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>d<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>X.shape[:-1]:</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nPoints<sp/>*=<sp/>d</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nPoints):</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>funcValVec[i]<sp/>=<sp/>funcValVec(X.flat[i*3:i*3+3],<sp/>T)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base" kindref="compound">DAE_base</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>base<sp/>class<sp/>for<sp/>differential-algebraic<sp/>equation<sp/>solutions</highlight></codeline>
<codeline lineno="135"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="136"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>To<sp/>use<sp/>this<sp/>class<sp/>override<sp/>:func:`uOfT`</highlight></codeline>
<codeline lineno="137"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base_1aa001b81ce6c97b8dd7bfd22d9fb6f70c" kindref="member">uOfXT</ref>(self,<sp/>X,<sp/>T):</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base_1a91ee7de9556014e10fec8aaaa773f8ea" kindref="member">uOfT</ref>(self,<sp/>T)</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1DAE__base_1a91ee7de9556014e10fec8aaaa773f8ea" kindref="member">uOfT</ref>(self,<sp/>T):</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146" refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearDAE" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="group__analyticalSolutions_1ga13ce042045a861bce7a66c85b00d55bf" kindref="member">NonlinearDAE</ref>(DAE_base):</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="148"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>of<sp/>the<sp/>simple<sp/>nonlinear<sp/>DAE</highlight></codeline>
<codeline lineno="149"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="150"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math:<sp/>u_t<sp/><sp/>=<sp/>-<sp/>a<sp/>\max(u,0)^p<sp/>\quad<sp/>u(0)<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="151"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearDAE_1a3bcea2774e15e2d8687c78b666c8ee86" kindref="member">__init__</ref>(self,<sp/>a,<sp/>p):</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="155"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>coefficients<sp/>a<sp/>and<sp/>p</highlight></codeline>
<codeline lineno="156"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.a_<sp/>=<sp/>a</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.p_<sp/>=<sp/>p</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.p_<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.func<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>t:<sp/>exp(-self.a_*t)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q<sp/>=<sp/>old_div(1.0,<sp/>(1.0<sp/>-<sp/>self.p_))</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.func<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>t:<sp/><ref refid="group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(1.0<sp/>-<sp/>(1.0<sp/>-<sp/>self.p_)*self.a_*t,<sp/>0.0)**q</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearDAE_1a50a65a4a9eba14186d8baa64dbf59aa4" kindref="member">uOfT</ref>(self,<sp/>t):</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.func(t)</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearDAE_1a39048d05afdf8d5eb359bf6581cc5efb" kindref="member">fOfUT</ref>(self,<sp/>u,<sp/>t):</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-self.a_*<ref refid="group__analyticalSolutions_1gaffe776513b24d84b39af8ab0930fef7f" kindref="member">max</ref>(u,<sp/>0.0)**self.p_</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172" refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="174"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Based<sp/>class<sp/>for<sp/>steady-state<sp/>solutions<sp/>u(x)</highlight></codeline>
<codeline lineno="175"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="176"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Override<sp/>:func:`uOfX`<sp/>to<sp/>define<sp/>steady<sp/>state<sp/>solutions.</highlight></codeline>
<codeline lineno="177"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState_1a88403968033fbb9c43cb6591db183e21" kindref="member">uOfX</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState_1a36d2ee872f436b60761cb5e8d3d0f166" kindref="member">uOfXT</ref>(self,<sp/>X,<sp/>T=None):</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.uOfX(X)</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186" refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState" kindref="compound">LinearAD_SteadyState</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>solution<sp/>of<sp/>the<sp/>steady<sp/>linear<sp/>advection-diffusion<sp/>equation</highlight></codeline>
<codeline lineno="189"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>boundary<sp/>value<sp/>problem<sp/>is</highlight></codeline>
<codeline lineno="191"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="192"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math:<sp/>(bu<sp/>-<sp/>au_x)_x<sp/>=<sp/>0<sp/>\quad<sp/>u(0)<sp/>=<sp/>1<sp/>\quad<sp/>u(1)<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="193"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1ac427fe4bba5294a81a73341d867a07a5" kindref="member">__init__</ref>(self,<sp/>b=1.0,<sp/>a=5.0e-1):</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref><sp/>=<sp/>b</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref><sp/>=<sp/>a</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>b<sp/>!=<sp/>0.0:</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a77394138932b9e9c92a10aa45e6dd1b5" kindref="member">D_</ref><sp/>=<sp/>(old_div(1.0,<sp/>(exp(old_div(b,<sp/>a))-1.0)))</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a77394138932b9e9c92a10aa45e6dd1b5" kindref="member">D_</ref><sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a8322bb3d9f00f0b369f95e69c5c5c948" kindref="member">C_</ref><sp/>=<sp/>-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a77394138932b9e9c92a10aa45e6dd1b5" kindref="member">D_</ref>*exp(old_div(b,<sp/>a))</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a20429c5b6afad3f554731f82c1c1fe01" kindref="member">uOfX</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a77394138932b9e9c92a10aa45e6dd1b5" kindref="member">D_</ref><sp/>!=<sp/>0.0:</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a77394138932b9e9c92a10aa45e6dd1b5" kindref="member">D_</ref>*exp(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref>*x/self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref>)<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a8322bb3d9f00f0b369f95e69c5c5c948" kindref="member">C_</ref></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1.0-x</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212" refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState" kindref="compound">NonlinearAD_SteadyState</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState" kindref="compound">LinearAD_SteadyState</ref>):</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>solution<sp/>of<sp/>a<sp/>steady<sp/>nonlinear<sp/>advection-diffusion<sp/>equation</highlight></codeline>
<codeline lineno="215"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>boundary<sp/>value<sp/>problem<sp/>is</highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math:<sp/>(bu^q<sp/>-<sp/>a(u^r)_x)_x<sp/>=<sp/>0<sp/>\quad<sp/>u(0)<sp/>=<sp/>1<sp/>\quad<sp/>u(1)<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Currently<sp/>:math:`q=1,r=2`,<sp/>and<sp/>:math:`r=2,q=1`<sp/>are<sp/>implemented</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a9b6f5c20894e989d5c7340914fa73d83" kindref="member">__init__</ref>(self,<sp/>b=1.0,<sp/>q=2,<sp/>a=5.0e-1,<sp/>r=1):</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LinearAD_SteadyState.__init__(self,<sp/>b,<sp/>a)</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1ad768adb27fc93a26dc7888ccaab559ed" kindref="member">r_</ref><sp/>=<sp/>r</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a31abe409fb3a624bf5491f07f7eb5d69" kindref="member">q_</ref><sp/>=<sp/>q</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(q<sp/>==<sp/>2<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>r<sp/>==<sp/>1):</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>b<sp/>!=<sp/>0.0:</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(rtmC):</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rtmC*tanh(b*rtmC/a)<sp/>-<sp/>1.0</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(rtmC):</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rtmC*(old_div(1.0,<sp/>cosh(b*rtmC/a)**2))*(old_div(b,<sp/>a))<sp/>+<sp/>tanh(b*rtmC/a)</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;Solving<sp/>for<sp/>sqrt(-C)<sp/>for<sp/>q=2,r=1&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rtmC<sp/>=<sp/><ref refid="namespaceproteus_1_1AnalysisTools_1a1b0cb6ec0a08405728cb648dd4589f26" kindref="member">sqrt</ref>(1.5)</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>abs(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(rtmC))<sp/>&gt;<sp/>1.0e-8:</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rtmC<sp/>-=<sp/>old_div(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(rtmC),<sp/><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(rtmC))</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;sqrt(-C)=&quot;</highlight><highlight class="normal">+repr(rtmC))</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a737bd37d77a7f1ef90c43b79a1b84be9" kindref="member">rtmC_</ref><sp/>=<sp/>rtmC</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a0d56e3ff5f93d2fcd9dffb889c9ca7ec" kindref="member">sol_</ref><sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a737bd37d77a7f1ef90c43b79a1b84be9" kindref="member">rtmC_</ref><sp/>*<sp/>\</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tanh((-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a737bd37d77a7f1ef90c43b79a1b84be9" kindref="member">rtmC_</ref>/self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref>)*(x<sp/>-<sp/>1.0))</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a0d56e3ff5f93d2fcd9dffb889c9ca7ec" kindref="member">sol_</ref><sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>1.0<sp/>-<sp/>x</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>(q<sp/>==<sp/>1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>r<sp/>==<sp/>2):</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;Solving<sp/>for<sp/>C<sp/>in<sp/>q=1,r=2&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C):</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>2.0*C*(<ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(C-1.0)<sp/>-<sp/><ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(C))<sp/>+<sp/>2.0<sp/>+<sp/>old_div(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref>)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(C):</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>2.0*(<ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(C-1.0)<sp/>-<sp/><ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(C))<sp/>+<sp/>2.0*C*(old_div(1.0,<sp/>(C-1.0))<sp/>-<sp/>old_div(1.0,<sp/>C))</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>=<sp/>1.0<sp/>+<sp/>1.0e-10</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f0<sp/>=<sp/><ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C)</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(f0)</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>abs(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C))<sp/>&gt;<sp/>(1.0e-7*abs(f0)<sp/>+<sp/>1.0e-7):</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dC<sp/>=<sp/>old_div(-<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C),<sp/><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(C))</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;dc&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(dC)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ctmp<sp/>=<sp/>C<sp/>+<sp/>dC</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(abs(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(Ctmp))<sp/>&gt;<sp/>0.99*abs(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C))</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>Ctmp<sp/>&lt;=<sp/>1.0):</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(Ctmp))</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(C))</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;ls&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dC<sp/>*=<sp/>0.9</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ctmp<sp/>=<sp/>C<sp/>+<sp/>dC</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;out&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(Ctmp)</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(Ctmp))</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="jf_8h_1a665602667543592b4547008b72a9631b" kindref="member">print</ref>(<ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(Ctmp))</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>=<sp/>Ctmp</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;C=&quot;</highlight><highlight class="normal">+repr(C))</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref><sp/>=<sp/>C</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a3bf133ab2df0ea6379ec79e1f7e76972" kindref="member">nlD_</ref><sp/>=<sp/>0.5*(2.0*C*<ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(C*(C-1))<sp/>-</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4.0*C<sp/>+<sp/>2.0<sp/>-<sp/>old_div(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref>))</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;D=&quot;</highlight><highlight class="normal">+repr(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a3bf133ab2df0ea6379ec79e1f7e76972" kindref="member">nlD_</ref>))</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>f(C):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(2.0*self.a_/self.b_)*(1.0<sp/>+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C*log((C-1.0)/C))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>df(C):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>(2.0*self.a_/self.b_)*(log((C-1.0)/C)<sp/>+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0/(C-1.0))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>=<sp/>1.8*self.b_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f0<sp/>=<sp/>f(C)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print<sp/>f0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>abs(f(C))<sp/>&gt;<sp/>1.0e-8*f0<sp/>+<sp/>1.0e-8:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C<sp/>-=<sp/>f(C)/df(C)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print<sp/>C</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print<sp/>f(C)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nlC_<sp/>=<sp/>C</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;q,r<sp/>not<sp/>implemented&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1aae950cc47008b49a71a4daae0724bb22" kindref="member">uOfX</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a31abe409fb3a624bf5491f07f7eb5d69" kindref="member">q_</ref><sp/>==<sp/>2<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1ad768adb27fc93a26dc7888ccaab559ed" kindref="member">r_</ref><sp/>==<sp/>1):</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a0d56e3ff5f93d2fcd9dffb889c9ca7ec" kindref="member">sol_</ref>(x)</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a31abe409fb3a624bf5491f07f7eb5d69" kindref="member">q_</ref><sp/>==<sp/>1<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1ad768adb27fc93a26dc7888ccaab559ed" kindref="member">r_</ref><sp/>==<sp/>2):</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(u):</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(2.0*(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref>*<ref refid="namespaceproteus_1_1iproteus_1a14d952654ce3f13565e6160fb52ae8a1" kindref="member">log</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref>-u)<sp/>-</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref>-u))<sp/>-</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a3bf133ab2df0ea6379ec79e1f7e76972" kindref="member">nlD_</ref>)<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a60cb76cbb761c8a9a0927944d6ace43e" kindref="member">b_</ref>*x/self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__SteadyState_1a25abb25efa122493140589e0768d5a06" kindref="member">a_</ref></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(u):</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(2.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref>/(u-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearAD__SteadyState_1a25618d736e037af385ec12f8b862603f" kindref="member">nlC_</ref>)+2.0)</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>=<sp/>LinearAD_SteadyState.uOfX(self,<sp/>X)</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f0<sp/>=<sp/><ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(u)</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>abs(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(u))<sp/>&gt;<sp/>1.0e-6*abs(f0)<sp/>+<sp/>1.0e-6:</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>-=<sp/>old_div(<ref refid="namespaceproteus_1af05ccedae3a5249ffcee18ba28860db4" kindref="member">f</ref>(u),<sp/><ref refid="group__analyticalSolutions_1ga31fe0a5e02da8c2ed2761f3aabf86e0d" kindref="member">df</ref>(u))</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>u</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>f(u):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>((2.0*self.a_/self.b_**2)*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.nlC*log(self.nlC-self.b_*u)<sp/>-</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.nlC<sp/>-<sp/>self.b_*u)<sp/>-</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.nlD)<sp/>-<sp/>x)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>def<sp/>df(u):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>((2.0*self.a_/self.b_**2)*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(-self.nlC*self.b_/(self.nlC-self.b_*u)<sp/>+</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.b_))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u=LinearAD_SteadyState.uOfX(self,X)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f0<sp/>=<sp/>abs(f(u))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>while<sp/>abs(f(u))<sp/>&gt;<sp/>1.0e-10*f0<sp/>+1.0e-10:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>-=<sp/>f(u)/df(u)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>u</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;q,r<sp/>not<sp/>implemented&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329" refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine" kindref="compound">LinearADR_Sine</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="331"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>An<sp/>exact<sp/>solution<sp/>and<sp/>source<sp/>term<sp/>for</highlight></codeline>
<codeline lineno="332"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="333"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>\nabla<sp/>\cdot<sp/>(\mathbf{b}<sp/>u<sp/>-<sp/>\mathbf{a}<sp/>\nabla<sp/>u)<sp/>+<sp/>c<sp/>u<sp/>+<sp/>d<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="334"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="335"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>solution<sp/>and<sp/>source<sp/>are</highlight></codeline>
<codeline lineno="336"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="337"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="338"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:nowrap:</highlight></codeline>
<codeline lineno="339"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="340"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\begin{eqnarray}</highlight></codeline>
<codeline lineno="341"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u(x)<sp/><sp/><sp/>&amp;=&amp;<sp/>\sin[\mathbf{\omega}<sp/>\cdot<sp/>\mathbf{x}<sp/>+<sp/>\omega_0)<sp/>]<sp/>=<sp/>\sin(Ax<sp/>-<sp/>b)<sp/>\\</highlight></codeline>
<codeline lineno="342"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r(u,x)<sp/>&amp;=&amp;<sp/>-<sp/>((\mathbf{a}<sp/>\mathbf{\omega})<sp/>\cdot<sp/>\mathbf{\omega})<sp/>u<sp/>\\</highlight></codeline>
<codeline lineno="343"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<sp/>&amp;<sp/>-<sp/>(\mathbf{b}<sp/>\cdot<sp/>\omega)<sp/>\cos(Ax<sp/>-<sp/>b)<sp/>\\</highlight></codeline>
<codeline lineno="344"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;=&amp;<sp/>c<sp/>u<sp/>+<sp/>D<sp/>\cos(Ax<sp/>-<sp/>b)<sp/>\\</highlight></codeline>
<codeline lineno="345"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;=&amp;<sp/>cu<sp/>+<sp/>d</highlight></codeline>
<codeline lineno="346"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\end{eqnarray}</highlight></codeline>
<codeline lineno="347"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="348"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>also<sp/>returns<sp/>the<sp/>advective,<sp/>diffusive,<sp/>and<sp/>total<sp/>flux<sp/>at<sp/>a<sp/>point.</highlight></codeline>
<codeline lineno="349"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a675206cde5c685cd31d42072b51ed7d5" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b=numpy.array((1.0,<sp/>0.0,<sp/>0.0)),</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a=numpy.array(((1.0e-2,<sp/>0.0,<sp/>0.0),</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0.0,<sp/>1.0e-2,<sp/>0.0),</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(0.0,<sp/>0.0,<sp/>1.0e-2))),</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c=1.0,</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>omega=numpy.array((2*pi,<sp/>0.0,<sp/>0.0)),</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>omega0=0.0):</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="360"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set<sp/>the<sp/>coefficients<sp/>a,b,c,omega,<sp/>and<sp/>omega0</highlight></codeline>
<codeline lineno="361"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a755eb18c3f77651bffc2f623c400b4cd" kindref="member">b_</ref><sp/>=<sp/>b</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a24d59911630dcd527cdb8004fffb1950" kindref="member">a_</ref><sp/>=<sp/>a</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aeaf0c1f0ae92ab8343d9e58e507d72a7" kindref="member">c_</ref><sp/>=<sp/>c</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref><sp/>=<sp/>omega</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a129f07a2c5f77c9ca9fa060c630463f9" kindref="member">omega0_</ref><sp/>=<sp/>omega0</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a42019ad2184f5a395ff5699f4b0ce52c" kindref="member">D_</ref><sp/>=<sp/>-<sp/>numpy.dot(b,<sp/>omega)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1ae55f71d991981e922a15d4d04c5988f6" kindref="member">E_</ref><sp/>=<sp/>-<sp/>numpy.dot(numpy.dot(a,<sp/>omega),<sp/>omega)<sp/>-<sp/>c</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1ad67168462189c576b6840373eb1de97f" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(numpy.dot(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>,<sp/>x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>.shape[0]])<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a129f07a2c5f77c9ca9fa060c630463f9" kindref="member">omega0_</ref>)</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a881cbbdfc68ff3ba17c214fcd92106c6" kindref="member">duOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref><sp/>*<sp/><ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(numpy.dot(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>,<sp/>x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>.shape[0]])+self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a129f07a2c5f77c9ca9fa060c630463f9" kindref="member">omega0_</ref>)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aceb8a4d22d4594fa0ccbe1f4fbd8d886" kindref="member">rOfUX</ref>(self,<sp/>u,<sp/>x):</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aeaf0c1f0ae92ab8343d9e58e507d72a7" kindref="member">c_</ref>*u<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a42019ad2184f5a395ff5699f4b0ce52c" kindref="member">D_</ref>*<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(numpy.dot(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>,<sp/>x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>.shape[0]])+self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a129f07a2c5f77c9ca9fa060c630463f9" kindref="member">omega0_</ref>)<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1ae55f71d991981e922a15d4d04c5988f6" kindref="member">E_</ref>*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(numpy.dot(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>,<sp/>x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aa4f878bb78116b02282f98b7074a5afd" kindref="member">omega_</ref>.shape[0]])<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a129f07a2c5f77c9ca9fa060c630463f9" kindref="member">omega0_</ref>)</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a9f19a4029bfc280a6585dd56d8d7848e" kindref="member">drOfUX</ref>(self,<sp/>u,<sp/>x):</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1aeaf0c1f0ae92ab8343d9e58e507d72a7" kindref="member">c_</ref></highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a5084e14fd3ec60ae2668917e11151fe0" kindref="member">advectiveFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a755eb18c3f77651bffc2f623c400b4cd" kindref="member">b_</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState_1a88403968033fbb9c43cb6591db183e21" kindref="member">uOfX</ref>(x)</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1ab8a2e80f1bf432ae1c7b8e916e4c03c4" kindref="member">diffusiveFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-numpy.dot(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a24d59911630dcd527cdb8004fffb1950" kindref="member">a_</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1a881cbbdfc68ff3ba17c214fcd92106c6" kindref="member">duOfX</ref>(x))</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Sine_1ad426b6a1bf99f15e1bbb7495218dac8b" kindref="member">totalFluxOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a22b903d5b333a2befda635614f47be58" kindref="member">advectiveFluxOfX</ref>(x)<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a6d3dc510ef4df570b055a1fe562909d1" kindref="member">diffusiveFluxOfX</ref>(x)</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392" refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation" kindref="compound">PoissonsEquation</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="394"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Manufactured<sp/>solution<sp/>of<sp/>Poisson&apos;s<sp/>equation</highlight></codeline>
<codeline lineno="395"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="396"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>-<sp/>\Delta<sp/>u<sp/>-<sp/>f<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="397"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="398"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>where<sp/>u<sp/>and<sp/>f<sp/>are<sp/>given<sp/>by</highlight></codeline>
<codeline lineno="399"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="400"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::</highlight></codeline>
<codeline lineno="401"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:nowrap:</highlight></codeline>
<codeline lineno="402"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="403"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\begin{eqnarray}</highlight></codeline>
<codeline lineno="404"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>&amp;=&amp;<sp/>K<sp/>x(1-x)y(1-y)z(1-z)e^{x^2<sp/>+<sp/>y^2<sp/>+<sp/>z^2}<sp/>\\</highlight></codeline>
<codeline lineno="405"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>&amp;=&amp;<sp/>-K\{[y(1-y)z(1-z)][4x^3<sp/>-<sp/>4x^2<sp/>+<sp/>6x<sp/>-<sp/>2]+<sp/>\\</highlight></codeline>
<codeline lineno="406"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;[x(1-x)z(1-z)][4y^3<sp/>-<sp/>4y^2<sp/>+<sp/>6y<sp/>-<sp/>2]+<sp/>\\</highlight></codeline>
<codeline lineno="407"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;[x(1-x)y(1-y)][4z^3<sp/>-<sp/>4z^2<sp/>+<sp/>6z<sp/>-<sp/>2]\}e^{x^2<sp/>+<sp/>y^2<sp/>+<sp/>z^2}</highlight></codeline>
<codeline lineno="408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>\end{eqnarray}</highlight></codeline>
<codeline lineno="409"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a2b7e8a5dba06415bf57148d7867c6a56" kindref="member">__init__</ref>(self,<sp/>K=10.0,<sp/>nd=3):</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref><sp/>=<sp/>K</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a32ff4e9feb9f2ee635c448f7b05adb80" kindref="member">nd_</ref><sp/>=<sp/>nd</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1ad1cdaa96466df3a1c5f5b561e32063a4" kindref="member">uOfX</ref>(self,<sp/>X):</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a32ff4e9feb9f2ee635c448f7b05adb80" kindref="member">nd_</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*x*(1.0-x)*exp(x**2)</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a32ff4e9feb9f2ee635c448f7b05adb80" kindref="member">nd_</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>X[1]</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*x*(1.0-x)*y*(1.0-y)*exp(x**2<sp/>+<sp/>y**2)</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>X[1]</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>=<sp/>X[2]</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*x*(1.0-x)*y*(1.0-y)*z*(1.0-z)*exp(x**2<sp/>+<sp/>y**2<sp/>+<sp/>z**2)</highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a479ef6f2ee11e728579c3c8eddba55b1" kindref="member">rOfUX</ref>(self,<sp/>u,<sp/>X):</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a32ff4e9feb9f2ee635c448f7b05adb80" kindref="member">nd_</ref><sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*(4.0*(1.0-x)*x**3<sp/>-<sp/>4.0*x**2<sp/>+<sp/>6.0*(1.0-x)*x<sp/>-<sp/>2.0)*exp(x**2)</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a32ff4e9feb9f2ee635c448f7b05adb80" kindref="member">nd_</ref><sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>X[1]</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*(y*(1.0-y)*(4.0*(1.0-x)*x**3<sp/>-<sp/>4.0*x**2<sp/>+<sp/>6.0*x*(1.0-x)<sp/>-<sp/>2.0)<sp/>+</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x*(1.0-x)*(4.0*(1.0-y)*y**3<sp/>-<sp/>4.0*y**2<sp/>+<sp/>6.0*y*(1.0-y)<sp/>-<sp/>2.0))*exp(x**2<sp/>+<sp/>y**2)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>X[0]</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>X[1]</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>z<sp/>=<sp/>X[2]</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a69f7a7bb5230df11147b884c60797121" kindref="member">K_</ref>*(y*(1.0-y)*z*(1.0-z)*(4.0*(1.0-x)*x**3<sp/>-<sp/>4.0*x**2<sp/>+<sp/>6.0*x*(1.0-x)<sp/>-<sp/>2.0)<sp/>+</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x*(1.0-x)*z*(1.0-z)*(4.0*(1.0-y)*y**3<sp/>-<sp/>4.0*y**2<sp/>+<sp/>6.0*y*(1.0-y)<sp/>-<sp/>2.0)<sp/>+</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x*(1.0-x)*y*(1.0-y)*(4.0*(1.0-z)*z**3<sp/>-<sp/>4.0*z**2<sp/>+<sp/>6.0*z*(1.0-z)<sp/>-<sp/>2.0))*exp(x**2<sp/>+<sp/>y**2<sp/>+<sp/>z**2)</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PoissonsEquation_1a92f08099f3a561334b2fbc40fb38abfc" kindref="member">drOfUX</ref>(self,<sp/>u,<sp/>x):</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="450" refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC" kindref="compound">LinearAD_DiracIC</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="452"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>of</highlight></codeline>
<codeline lineno="453"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="454"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>u_t<sp/>+<sp/>\nabla<sp/>\cdot<sp/>(b<sp/>u<sp/>-<sp/>a<sp/>\nabla<sp/>u)<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="455"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="456"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>on<sp/>an<sp/>infinite<sp/>domain<sp/>with<sp/>dirac<sp/>initial<sp/>data</highlight></codeline>
<codeline lineno="457"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="458"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>u0<sp/>=<sp/>\int<sp/>u0<sp/>\delta(x<sp/>-<sp/>x0)</highlight></codeline>
<codeline lineno="459"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="460"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>also<sp/>returns<sp/>advective,<sp/>diffusive,<sp/>and<sp/>total<sp/>flux</highlight></codeline>
<codeline lineno="461"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a7e4c5d31dd6e7d7c2c45165bd7b27862" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=1.0,</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b=numpy.array((1.0,<sp/>0.0,<sp/>0.0)),</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a=1.0e-2,</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tStart=0.0,</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u0=0.1,</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x0=numpy.array((0.0,<sp/>0.0,<sp/>0.0))):</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae58d695dd18130b6497b0ca336de36ec" kindref="member">n_</ref><sp/>=<sp/>n</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a005d8ddec5e3d685cd2a404b00a7ea30" kindref="member">u0_</ref><sp/>=<sp/>u0</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a5fd815b98de9612963d60d2ad2b6d737" kindref="member">x0_</ref><sp/>=<sp/>x0</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref><sp/>=<sp/>b</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae3e31112c7e4c870e0722808e2ebac9c" kindref="member">a_</ref><sp/>=<sp/>a</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a4a7123452487c4339d18443bd676465f" kindref="member">tStart</ref><sp/>=<sp/>tStart</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ab2bc75f26e2987e8b3b74ed9eeef67b2" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>T<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a4a7123452487c4339d18443bd676465f" kindref="member">tStart</ref></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>(x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>.shape[0]]<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a5fd815b98de9612963d60d2ad2b6d737" kindref="member">x0_</ref>[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>.shape[0]]<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>*t)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exp_arg<sp/>=<sp/>old_div(numpy.dot(y,<sp/>y),<sp/>(4.0<sp/>*<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae3e31112c7e4c870e0722808e2ebac9c" kindref="member">a_</ref><sp/>*<sp/>t))</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>exp_arg<sp/>&gt;<sp/>100:</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a005d8ddec5e3d685cd2a404b00a7ea30" kindref="member">u0_</ref>*exp(-exp_arg)<sp/>/<sp/>(4.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae3e31112c7e4c870e0722808e2ebac9c" kindref="member">a_</ref>*pi*t)**(old_div(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae58d695dd18130b6497b0ca336de36ec" kindref="member">n_</ref>,<sp/>2.0))</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a1543ad0359d35ae1912fbcf1a033d367" kindref="member">duOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>T<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a4a7123452487c4339d18443bd676465f" kindref="member">tStart</ref></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>(x[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>.shape[0]]<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a5fd815b98de9612963d60d2ad2b6d737" kindref="member">x0_</ref>[:self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>.shape[0]]<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>*t)</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a5dc41319985a76409271c0436fe3c413" kindref="member">uOfXT</ref>(x,<sp/>T)*2.0*y/(4.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae3e31112c7e4c870e0722808e2ebac9c" kindref="member">a_</ref>*t)</highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1aabac51387ddaeab59277458a7e569569" kindref="member">advectiveFluxOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a60dc937fe09e7589eb0e7b6e5863b874" kindref="member">b_</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a5dc41319985a76409271c0436fe3c413" kindref="member">uOfXT</ref>(x,<sp/>T)</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a386d05173ed8442ee3a687b69c8e8ce0" kindref="member">diffusiveFluxOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1ae3e31112c7e4c870e0722808e2ebac9c" kindref="member">a_</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a30f91e1a99d5862a2d06798a455885ee" kindref="member">duOfXT</ref>(x,<sp/>T)</highlight></codeline>
<codeline lineno="496"><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a18082f036b52f7d9e5b585a226331aa4" kindref="member">totalFluxOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1aabac51387ddaeab59277458a7e569569" kindref="member">advectiveFluxOfXT</ref>(x,<sp/>T)<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a386d05173ed8442ee3a687b69c8e8ce0" kindref="member">diffusiveFluxOfXT</ref>(x,<sp/>T)</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501" refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC" kindref="compound">LinearADR_Decay_DiracIC</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC" kindref="compound">LinearAD_DiracIC</ref>):</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="503"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>of</highlight></codeline>
<codeline lineno="504"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="505"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>u_t<sp/>+<sp/>\nabla<sp/>\cdot<sp/>(bu<sp/>-<sp/>a<sp/>\nabla<sp/>u)<sp/>+<sp/>cu=<sp/>0</highlight></codeline>
<codeline lineno="506"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="507"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>on<sp/>an<sp/>infinite<sp/>domain<sp/>with<sp/>Dirac<sp/>initial<sp/>data.<sp/><sp/>Also</highlight></codeline>
<codeline lineno="508"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>returns<sp/>the<sp/>fluxes<sp/>(by<sp/>inheritance).</highlight></codeline>
<codeline lineno="509"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a7891aebbbb49c26573b9c765cb75ef64" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=1.0,</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b=numpy.array((1.0,<sp/>0.0,<sp/>0.0)),</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a=1.0e-2,</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c=1.0,</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tStart=0.0,</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u0=0.1,</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x0=numpy.array((0.0,<sp/>0.0,<sp/>0.0))):</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LinearAD_DiracIC.__init__(self,<sp/>n,<sp/>b,<sp/>a,<sp/>tStart,<sp/>u0,<sp/>x0)</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref><sp/>=<sp/>c</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a4ef544da1a1c62d26a170b59b8d660f2" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>T<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a4a7123452487c4339d18443bd676465f" kindref="member">tStart</ref></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>LinearAD_DiracIC.uOfXT(self,<sp/>x,<sp/>T)*exp(-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref>*t)</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a65802969618e6a4112213d224b4c049b" kindref="member">rOfUXT</ref>(self,<sp/>u,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref>*u</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a10080f9d4e4783cc232fd1f351a46617" kindref="member">drOfUXT</ref>(self,<sp/>u,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref></highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533" refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC" kindref="compound">NonlinearADR_Decay_DiracIC</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC" kindref="compound">LinearADR_Decay_DiracIC</ref>):</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="535"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>approximate<sp/>analytical<sp/>solution<sp/>of</highlight></codeline>
<codeline lineno="536"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="537"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>..<sp/>math::<sp/>u_t<sp/>+<sp/>\nabla<sp/>\cdot<sp/>(bu<sp/>-<sp/>a<sp/>\nabla<sp/>u)<sp/>+<sp/>cu^d=<sp/>0</highlight></codeline>
<codeline lineno="538"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>on<sp/>an<sp/>infinite<sp/>domain<sp/>with<sp/>Dirac<sp/>initial<sp/>data.</highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Also<sp/>returns<sp/>the<sp/>fluxes<sp/>(by<sp/>inheritance).</highlight></codeline>
<codeline lineno="541"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1a1736a4847c6204e978177790cb754f40" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=1.0,</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>b=numpy.array((1.0,<sp/>0.0,<sp/>0.0)),</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a=1.0e-2,</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c=1.0,</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d=2.0,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tStart=0.0,</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u0=0.1,</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x0=numpy.array((0.0,<sp/>0.0,<sp/>0.0))):</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LinearADR_Decay_DiracIC.__init__(self,<sp/>n,<sp/>b,<sp/>a,<sp/>c,<sp/>tStart,<sp/>u0,<sp/>x0)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref><sp/>=<sp/>d</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1a2d4dc62b7e43faba68c0590a85f4667e" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>T<sp/>+<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearAD__DiracIC_1a4a7123452487c4339d18443bd676465f" kindref="member">tStart</ref></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u1<sp/>=<sp/>LinearAD_DiracIC.uOfXT(self,<sp/>x,<sp/>T)</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>u1<sp/>&gt;<sp/>0.0:</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>u1*exp(old_div(-(2.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref>*t*pow(u1,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref>-1.0)),<sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref>+1.0)))</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>u1</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1a2633a95a6e1b2e9aca1085e76a37a1ec" kindref="member">rOfUXT</ref>(self,<sp/>u,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref>*(u**self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref>)</highlight></codeline>
<codeline lineno="565"><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1aa17ff6cb92f95944b957f98a142637a3" kindref="member">drOfUXT</ref>(self,<sp/>u,<sp/>x,<sp/>T):</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1LinearADR__Decay__DiracIC_1a88770a446d8830cb534a0e759e9342f8" kindref="member">c_</ref>*(u**(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1NonlinearADR__Decay__DiracIC_1acd404b052493cfeefff626543bf0c13f" kindref="member">d_</ref>-1))</highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570" refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u" kindref="compound">PlaneCouetteFlow_u</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="572"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Couette<sp/>Flow</highlight></codeline>
<codeline lineno="573"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.canalyticalSolutions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PlaneCouetteFlow_u</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1a3fc2119af377fde2b7b1b57e0e85bd47" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upperPlateVelocity=0.01,</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1a023ff528bc5ec296472e8d92ccc568be" kindref="member">iwork</ref><sp/>=<sp/>numpy.zeros((1,),<sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1abfadb40c699dc85e08d251397833c4e1" kindref="member">rwork</ref><sp/>=<sp/>numpy.array([upperPlateVelocity,</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation,</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[0],</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[1],</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[2]])</highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1a48773165ad158140f92ca667418bcb94" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uList<sp/>=<sp/>numpy.array([[0.0]])</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xList<sp/>=<sp/>numpy.array([x])</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nPoints<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.PlaneCouetteFlow_u(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1a023ff528bc5ec296472e8d92ccc568be" kindref="member">iwork</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__u_1abfadb40c699dc85e08d251397833c4e1" kindref="member">rwork</ref>,<sp/>t,<sp/>xList,<sp/>uList)</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>uList.flat[0]</highlight></codeline>
<codeline lineno="594"><highlight class="normal"></highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596" refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__v" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__v" kindref="compound">PlaneCouetteFlow_v</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="598"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Couette<sp/>Flow</highlight></codeline>
<codeline lineno="599"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__v_1a5687a7bf83df761614fab48ad41daab6" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upperPlateVelocity=0.01,</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__v_1a54713009f04cb7a04183588c7fd367f3" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611" refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__p" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__p" kindref="compound">PlaneCouetteFlow_p</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="613"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Couette<sp/>Flow</highlight></codeline>
<codeline lineno="614"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__p_1a63e53ca6e728fbf693a14545576d877b" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upperPlateVelocity=0.01,</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneCouetteFlow__p_1aa553090336468cf6f747153a4a63e39d" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0</highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u" kindref="compound">PlanePoiseuilleFlow_u</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.canalyticalSolutions<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PlanePoiseuilleFlow_u</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="629"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="630"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a52018d6ef31e55606b959b905e21be70" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q=0.0,</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>allocated<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays<sp/>and<sp/>load<sp/>in<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>(<sp/>(shape_0,shape_1,...),<sp/>typecode)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a9fd01ab37ae6d73635dc5ea73014ccd0" kindref="member">iwork</ref><sp/>=<sp/>numpy.zeros((1,),<sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a85f4566b831931337bc1cac97ee09194" kindref="member">rwork</ref><sp/>=<sp/>numpy.array([plateSeperation,</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu,</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p,</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q,</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[0],</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[1],</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin[2]])<sp/><sp/></highlight><highlight class="comment">#<sp/>numpy.array([component_0,component_2,...])<sp/>builds<sp/>a<sp/>double*<sp/>initialized<sp/>to<sp/>values<sp/>in<sp/>list<sp/>[...]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>wrapped<sp/>&quot;vectorized&quot;<sp/>analytical<sp/>solutions<sp/>that<sp/>Moira<sp/>wrote<sp/>with<sp/>a<sp/>point-wise<sp/>evaluation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a851b213b9d3d1f52a4be189fedbad63d" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>array<sp/>of<sp/>doubles<sp/>for<sp/>storing<sp/>solution<sp/>(just<sp/>the<sp/>solution<sp/>at<sp/>a<sp/>single<sp/>point)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uList<sp/>=<sp/>numpy.array([0.0])</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>array<sp/>of<sp/>double*&apos;s<sp/>for<sp/>storing<sp/>spatial<sp/>locations<sp/>(just<sp/>a<sp/>single<sp/>point<sp/>in<sp/>3D<sp/>in<sp/>this<sp/>case)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xList<sp/>=<sp/>numpy.array([x])</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>time<sp/>at<sp/>which<sp/>solution<sp/>is<sp/>evaluated<sp/>(this<sp/>is<sp/>a<sp/>steady<sp/>state<sp/>problem)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nPoints<sp/>=<sp/>1<sp/><sp/></highlight><highlight class="comment">#<sp/>just<sp/>a<sp/>single<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>make<sp/>call<sp/>to<sp/>wrapped<sp/>C<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.PlanePoiseuilleFlow_u(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a9fd01ab37ae6d73635dc5ea73014ccd0" kindref="member">iwork</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u_1a85f4566b831931337bc1cac97ee09194" kindref="member">rwork</ref>,<sp/>t,<sp/>xList,<sp/>uList)</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>uList[0]<sp/><sp/></highlight><highlight class="comment">#<sp/>return<sp/>value<sp/><sp/>of<sp/>solution<sp/>at<sp/>this<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight></codeline>
<codeline lineno="664" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v" kindref="compound">PlanePoiseuilleFlow_v</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="666"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="667"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v_1a1ad49f2b95beac46ac0186c983f847ae" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q=0.0,</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v_1a07d3b85acff0f4b4bcc2b9a02fceb3c6" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight></codeline>
<codeline lineno="681" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p" kindref="compound">PlanePoiseuilleFlow_p</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="683"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="684"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p_1aebc892a38d683b331bb793128d353a5d" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plateSeperation=1.0,</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>q=0.0,</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin=[0.0,<sp/>0.0,<sp/>0.0]):</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p_1a9fa1a8a95492f1b5c5af18fae7aa5d35" kindref="member">grad_p</ref><sp/>=<sp/>grad_p</highlight></codeline>
<codeline lineno="693"><highlight class="normal"></highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p_1a9eee96798e36db53f6a8a216efabbf02" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p_1a9fa1a8a95492f1b5c5af18fae7aa5d35" kindref="member">grad_p</ref>*x[0]</highlight></codeline>
<codeline lineno="696"><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight><highlight class="comment">#<sp/>encapsulate<sp/>analytical<sp/>solver<sp/>for<sp/>BuckleyLeverett<sp/>Riemann<sp/>problems</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespaceproteus_1_1ObjectiveFunctions" kindref="compound">proteus.ObjectiveFunctions</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>OsherFuncCoef</highlight></codeline>
<codeline lineno="700"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespaceproteus_1_1Optimizers" kindref="compound">proteus.Optimizers</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>fminbound</highlight></codeline>
<codeline lineno="701"><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal"></highlight></codeline>
<codeline lineno="703" refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln" kindref="compound">Buckley_Leverett_RiemannSoln</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a2776e6667424af07c2baaccae68e33f0" kindref="member">__init__</ref>(self,<sp/>coefficients,<sp/>uLeft=1.0,<sp/>uRight=0.0,<sp/>t0=0.0,<sp/>x0=0.0,<sp/>T=0.5,<sp/>ftol=1.0e-8,</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>useShallowCopyCoef=True):</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ought<sp/>to<sp/>start<sp/>with<sp/>range<sp/>and<sp/>spline<sp/>for<sp/>eval<sp/>later<sp/>I<sp/>guess</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a11918979cc97c2dca0c264239ee349ad" kindref="member">coefficients</ref><sp/>=<sp/>coefficients</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a87c1dfb85af174586fce250e21277ca8" kindref="member">uL</ref><sp/>=<sp/>uLeft</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5e1b12df7350bcd0b030593f4a344d05" kindref="member">uR</ref><sp/>=<sp/>uRight</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5b5ef6c4551bf42984f9d12ae72ae125" kindref="member">t0</ref><sp/>=<sp/>t0</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ae6d94423ffb219db1dc798bb633efcb7" kindref="member">x0</ref><sp/>=<sp/>x0</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a6a511608d2f8fd96ec652b95bd1992b1" kindref="member">T</ref><sp/>=<sp/>T</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ab63a0024989875702341ed33409e9a8f" kindref="member">ftol</ref><sp/>=<sp/>ftol</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a9612d6b68e65e865383d9a9e79825790" kindref="member">riemF</ref><sp/>=<sp/><ref refid="classproteus_1_1ObjectiveFunctions_1_1OsherFuncCoef" kindref="compound">OsherFuncCoef</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a87c1dfb85af174586fce250e21277ca8" kindref="member">uL</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5e1b12df7350bcd0b030593f4a344d05" kindref="member">uR</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a11918979cc97c2dca0c264239ee349ad" kindref="member">coefficients</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a6a511608d2f8fd96ec652b95bd1992b1" kindref="member">T</ref>-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5b5ef6c4551bf42984f9d12ae72ae125" kindref="member">t0</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ae6d94423ffb219db1dc798bb633efcb7" kindref="member">x0</ref>,</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>useShallowCopy=useShallowCopyCoef)</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a3dea066c9945f14880e4326e51172c49" kindref="member">solver</ref><sp/>=<sp/><ref refid="classproteus_1_1Optimizers_1_1fminbound" kindref="compound">fminbound</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a9612d6b68e65e865383d9a9e79825790" kindref="member">riemF</ref>,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ab63a0024989875702341ed33409e9a8f" kindref="member">ftol</ref>)</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>mwf<sp/>if<sp/>want<sp/>to<sp/>look<sp/>at<sp/>coefficients</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.generateAplot(x0,x0+1.0,101,T)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1adea248d000c9ee5996fd08de7095464b" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>t):</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>abs(t-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5b5ef6c4551bf42984f9d12ae72ae125" kindref="member">t0</ref>)<sp/>&lt;<sp/>1.0e-7:</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>x[0]-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ae6d94423ffb219db1dc798bb633efcb7" kindref="member">x0</ref><sp/>&lt;=<sp/>0.0:</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a87c1dfb85af174586fce250e21277ca8" kindref="member">uL</ref></highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5e1b12df7350bcd0b030593f4a344d05" kindref="member">uR</ref></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a9612d6b68e65e865383d9a9e79825790" kindref="member">riemF</ref>.xi<sp/>=<sp/>old_div((x[0]-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1ae6d94423ffb219db1dc798bb633efcb7" kindref="member">x0</ref>),<sp/>(t-self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5b5ef6c4551bf42984f9d12ae72ae125" kindref="member">t0</ref>))</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u,<sp/>f<sp/>=<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a3dea066c9945f14880e4326e51172c49" kindref="member">solver</ref>.solve(Guess_x=0.5*(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a87c1dfb85af174586fce250e21277ca8" kindref="member">uL</ref>+self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a5e1b12df7350bcd0b030593f4a344d05" kindref="member">uR</ref>))</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>u</highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a4ca638205b257a6774cbcfeb16a2755a" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a5dc41319985a76409271c0436fe3c413" kindref="member">uOfXT</ref>(x,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a6a511608d2f8fd96ec652b95bd1992b1" kindref="member">T</ref>)</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1Buckley__Leverett__RiemannSoln_1a623c5e86c7392b6dbfd9ac146e425336" kindref="member">generateAplot</ref>(self,<sp/>xLeft,<sp/>xRight,<sp/>nnx,<sp/>t,<sp/>filename=&apos;Buckley_Leverett_ex.dat&apos;):</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="734"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>exact<sp/>solution<sp/>to<sp/>a<sp/>file</highlight></codeline>
<codeline lineno="735"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dx<sp/>=<sp/>old_div((xRight-xLeft),<sp/>(nnx-1.))</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout<sp/>=<sp/>open(filename,<sp/></highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(nnx):</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>(xLeft+dx*i,<sp/>0.0,<sp/>0.0)</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>=<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base_1a5dc41319985a76409271c0436fe3c413" kindref="member">uOfXT</ref>(x,<sp/>t)</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.write(</highlight><highlight class="stringliteral">&apos;%12.5e<sp/><sp/>%12.5e<sp/>\n&apos;</highlight><highlight class="normal"><sp/>%<sp/>(x[0],<sp/>u))</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fout.close()</highlight></codeline>
<codeline lineno="744"><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight></codeline>
<codeline lineno="746" refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" kindref="compound">PlaneBase</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1SteadyState" kindref="compound">SteadyState</ref>):</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="748"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="749"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a067f25ae963397b59edab746c4683f3a" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta=0.0,</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm=1.0,</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L=[1.0,<sp/>1.0,<sp/>1.0]):</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a83f5cba304e3caef1c961293232a0bc7" kindref="member">plane_n</ref><sp/>=<sp/>numpy.array([<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(plane_theta)*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(plane_phi),</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(plane_theta)*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(plane_phi),</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(plane_phi)])</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(plane_phi<sp/>&gt;<sp/>old_div(-pi,<sp/>2.0)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>plane_phi<sp/>&lt;<sp/>old_div(pi,<sp/>2.0)):</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>plane_phi<sp/>==<sp/>0.0:</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight><highlight class="stringliteral">&quot;plate<sp/>is<sp/>in<sp/>x-y<sp/>plane&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi<sp/>=<sp/>old_div(pi,<sp/>2.0)</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi<sp/>=<sp/>atan(</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_div(-1.0,<sp/>(tan(plane_phi)*<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(v_theta-plane_theta))))</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1tests_1_1CLSVOF_1_1disc__ICs_1_1clsvof__p_1acb916366ed50abb893e36903fd6359e4" kindref="member">logEvent</ref>(</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;plate<sp/>is<sp/>is<sp/>parallel<sp/>to<sp/>z-axis,<sp/>using<sp/>angle<sp/>of<sp/>velocity<sp/>with<sp/>z-axis<sp/>instead<sp/>of<sp/>angle<sp/>with<sp/>x-axis&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta<sp/>=<sp/>plane_theta<sp/>-<sp/>old_div(pi,<sp/>2.0)</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1ad4ea4606fd3a354e4a1a2de510e0efb5" kindref="member">v_n</ref><sp/>=<sp/>numpy.array([<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(v_theta)*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(v_phi),</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(v_theta)*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(v_phi),</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(v_phi)])</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minZ<sp/>=<sp/>(0.0,<sp/>numpy.array([0.0,<sp/>0.0,<sp/>0.0]))</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxZ<sp/>=<sp/>(0.0,<sp/>numpy.array([0.0,<sp/>0.0,<sp/>0.0]))</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[0,<sp/>1]:</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>j<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[0,<sp/>1]:</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>[0,<sp/>1]:</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/>numpy.array([i*L[0],<sp/>j*L[1],<sp/>k*L[2]])</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Z<sp/>=<sp/>numpy.dot(x,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a83f5cba304e3caef1c961293232a0bc7" kindref="member">plane_n</ref>)</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Z<sp/>&lt;<sp/>minZ[0]:</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minZ<sp/>=<sp/>(Z,<sp/>x)</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Z<sp/>&gt;<sp/>maxZ[0]:</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxZ<sp/>=<sp/>(Z,<sp/>x)</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a37ade9d1be6738f8bb2e4aab3d6330c3" kindref="member">Zshift</ref><sp/>=<sp/>minZ[0]</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a5cc9ed437d4bc2d85ef82147104c24c1" kindref="member">Zsep</ref><sp/>=<sp/>maxZ[0]<sp/>-<sp/>minZ[0]</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1adb10ea7bf3021aeee05a143695968124" kindref="member">mu</ref><sp/>=<sp/>mu</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a66b0305da283541a5397f5a59bc2e153" kindref="member">grad_p</ref><sp/>=<sp/>grad_p</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1aabaa7772e1d0107b20b45e107dc12fcc" kindref="member">v_norm</ref><sp/>=<sp/>v_norm</highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1abdd99e1b4010b783eda9c3b71e39ab5c" kindref="member">Z</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>numpy.dot(x,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a83f5cba304e3caef1c961293232a0bc7" kindref="member">plane_n</ref>)<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a37ade9d1be6738f8bb2e4aab3d6330c3" kindref="member">Zshift</ref></highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a3fcaae1989766f02e181a3e286e04c17" kindref="member">X</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>numpy.dot(x,<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1ad4ea4606fd3a354e4a1a2de510e0efb5" kindref="member">v_n</ref>)</highlight></codeline>
<codeline lineno="800"><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a1651591e77315d3e11cdd43afaf6e583" kindref="member">U</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Z<sp/>=<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1abdd99e1b4010b783eda9c3b71e39ab5c" kindref="member">Z</ref>(x)</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Z*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1aabaa7772e1d0107b20b45e107dc12fcc" kindref="member">v_norm</ref>/self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a5cc9ed437d4bc2d85ef82147104c24c1" kindref="member">Zsep</ref>)<sp/>-<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a66b0305da283541a5397f5a59bc2e153" kindref="member">grad_p</ref>*Z*(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a5cc9ed437d4bc2d85ef82147104c24c1" kindref="member">Zsep</ref>-Z)/(2.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1adb10ea7bf3021aeee05a143695968124" kindref="member">mu</ref>)</highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"></highlight></codeline>
<codeline lineno="806" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u2" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u2" kindref="compound">PlanePoiseuilleFlow_u2</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" kindref="compound">PlaneBase</ref>):</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="808"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="809"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u2_1aa2413b502b11f46bcee1013a71ee8579" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta=0.0,</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm=1.0,</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L=[1.0,<sp/>1.0,<sp/>1.0]):</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlaneBase.__init__(self,</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta,</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi,</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta,</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi,</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm,</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu,</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p,</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L)</highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__u2_1af541b2cd911c39d08901d320becfa4b2" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a1651591e77315d3e11cdd43afaf6e583" kindref="member">U</ref>(x)*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1ad4ea4606fd3a354e4a1a2de510e0efb5" kindref="member">v_n</ref>[0]</highlight></codeline>
<codeline lineno="833"><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight></codeline>
<codeline lineno="835" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v2" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v2" kindref="compound">PlanePoiseuilleFlow_v2</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" kindref="compound">PlaneBase</ref>):</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="837"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="838"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v2_1a84a5dfbe5023e3504e2db03c4904cbbd" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta=0.0,</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm=1.0,</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L=[1.0,<sp/>1.0,<sp/>1.0]):</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlaneBase.__init__(self,</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta,</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi,</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta,</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi,</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm,</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu,</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p,</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L)</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__v2_1a591dd8e38dfdd9f01d50d002d73d2498" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a1651591e77315d3e11cdd43afaf6e583" kindref="member">U</ref>(x)*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1ad4ea4606fd3a354e4a1a2de510e0efb5" kindref="member">v_n</ref>[1]</highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"></highlight></codeline>
<codeline lineno="863" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__w2" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__w2" kindref="compound">PlanePoiseuilleFlow_w2</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" kindref="compound">PlaneBase</ref>):</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="865"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="866"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__w2_1a636c1038b6a9681b49493c772853a3a7" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta=0.0,</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm=1.0,</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L=[1.0,<sp/>1.0,<sp/>1.0]):</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlaneBase.__init__(self,</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta,</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi,</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta,</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi,</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm,</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu,</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p,</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L)</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__w2_1add9b96809c82145dac256369604ea727" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a1651591e77315d3e11cdd43afaf6e583" kindref="member">U</ref>(x)*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1ad4ea4606fd3a354e4a1a2de510e0efb5" kindref="member">v_n</ref>[2]</highlight></codeline>
<codeline lineno="889"><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"></highlight></codeline>
<codeline lineno="891" refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p2" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p2" kindref="compound">PlanePoiseuilleFlow_p2</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase" kindref="compound">PlaneBase</ref>):</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="893"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>v<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>plane<sp/>Poiseuille<sp/>Flow</highlight></codeline>
<codeline lineno="894"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p2_1afc322ce0bbb3a0b823bbd5e7d34d2070" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta=0.0,</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta=old_div(math.pi,<sp/>2.0),</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm=1.0,</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu=1.0,</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p=1.0,</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L=[1.0,<sp/>1.0,<sp/>1.0]):</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PlaneBase.__init__(self,</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_theta,</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>plane_phi,</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_theta,</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_phi,</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v_norm,</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mu,</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grad_p,</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L)</highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1PlanePoiseuilleFlow__p2_1a58333a0b5f7058f8dc2ba71814b73806" kindref="member">uOfX</ref>(self,<sp/>x):</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a66b0305da283541a5397f5a59bc2e153" kindref="member">grad_p</ref>*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1PlaneBase_1a3fcaae1989766f02e181a3e286e04c17" kindref="member">X</ref>(x)</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"></highlight></codeline>
<codeline lineno="919" refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u" kindref="compound">VortexDecay_u</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="921"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>the<sp/>vortex<sp/><sp/>decay<sp/>problem</highlight></codeline>
<codeline lineno="922"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a673c9c5c0272d81d514c553c21a5cfa3" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=2,</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Re=100.0):</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a299fd3357a9d7de27fde46cc5acbe5bd" kindref="member">n</ref><sp/>=<sp/>n</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1ab810149c55fcc18992239cb9ccd48d11" kindref="member">Re</ref><sp/>=<sp/>Re</highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a1e8980bdbcc950513effa58ff8436301" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>t):</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>return<sp/>-cos(x[0])*sin(x[1])*exp(-2.0*t)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a299fd3357a9d7de27fde46cc5acbe5bd" kindref="member">n</ref>*pi*x[0])*<ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a299fd3357a9d7de27fde46cc5acbe5bd" kindref="member">n</ref>*pi*x[1])*exp(-2.0<sp/>*<sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1a299fd3357a9d7de27fde46cc5acbe5bd" kindref="member">n</ref>*pi)**2<sp/>*<sp/>t<sp/>/<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__u_1ab810149c55fcc18992239cb9ccd48d11" kindref="member">Re</ref>)</highlight></codeline>
<codeline lineno="934"><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"></highlight></codeline>
<codeline lineno="936" refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v" kindref="compound">VortexDecay_v</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="938"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>the<sp/>vortex<sp/><sp/>decay<sp/>problem</highlight></codeline>
<codeline lineno="939"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a1651fbb7bf9c783b13d8d135e8e4b591" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=2,</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Re=100.0):</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a52b72a6fd71da0453b6a35bfb1782c5a" kindref="member">n</ref><sp/>=<sp/>n</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1ad0815a01251c77e7638607e1131cc7b5" kindref="member">Re</ref><sp/>=<sp/>Re</highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a452ca3569d09a4a63b090345cf2047ef" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>t):</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>return<sp/>sin(x[0])*cos(x[1])*exp(-2.0*t)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespaceproteus_1_1AnalysisTools_1adb22c8a0098552b9d8c9c060de23ebf1" kindref="member">sin</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a52b72a6fd71da0453b6a35bfb1782c5a" kindref="member">n</ref>*pi*x[0])*<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a52b72a6fd71da0453b6a35bfb1782c5a" kindref="member">n</ref>*pi*x[1])*exp(-2.0<sp/>*<sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1a52b72a6fd71da0453b6a35bfb1782c5a" kindref="member">n</ref>*pi)**2<sp/>*<sp/>t<sp/>/<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__v_1ad0815a01251c77e7638607e1131cc7b5" kindref="member">Re</ref>)</highlight></codeline>
<codeline lineno="951"><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight></codeline>
<codeline lineno="953" refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p" kindref="compound">VortexDecay_p</ref>(<ref refid="classproteus_1_1AnalyticalSolutions_1_1AS__base" kindref="compound">AS_base</ref>):</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="955"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>exact<sp/>solution<sp/>for<sp/>the<sp/>u<sp/>component<sp/>of<sp/><sp/>velocity<sp/>in<sp/>the<sp/>vortex<sp/><sp/>decay<sp/>problem</highlight></codeline>
<codeline lineno="956"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>constructor<sp/>or<sp/>initializer<sp/>function,<sp/>reads<sp/>in<sp/>parameters<sp/>needed<sp/>in<sp/>the<sp/>iwork<sp/>and<sp/>rwork<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1aaff7272dd3e10b30f0a56fc1040f3dcd" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n=2,</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Re=100.0):</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a09395b6971d0afb1d1962b37f183e31d" kindref="member">n</ref><sp/>=<sp/>n</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a066b60c2d4fb6b5f06b80c5b7f17b767" kindref="member">Re</ref><sp/>=<sp/>Re</highlight></codeline>
<codeline lineno="964"><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1aba8e3ba33f3136d87ba505d23514949b" kindref="member">uOfXT</ref>(self,<sp/>x,<sp/>t):</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>return<sp/>-self.Re*0.25*(cos(2.0*x[0])+cos(2.0*x[1]))*exp(-4.0*t)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-0.25*(<ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(2.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a09395b6971d0afb1d1962b37f183e31d" kindref="member">n</ref>*pi*x[0])<sp/>+<sp/><ref refid="namespaceproteus_1_1AnalysisTools_1aadff3106b5192c04163a4a3adc50f975" kindref="member">cos</ref>(2.0*self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a09395b6971d0afb1d1962b37f183e31d" kindref="member">n</ref>*pi*x[1]))*exp(-4.0<sp/>*<sp/>(self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a09395b6971d0afb1d1962b37f183e31d" kindref="member">n</ref>*pi)**2<sp/>*<sp/>t<sp/>/<sp/>self.<ref refid="classproteus_1_1AnalyticalSolutions_1_1VortexDecay__p_1a066b60c2d4fb6b5f06b80c5b7f17b767" kindref="member">Re</ref>)</highlight></codeline>
    </programlisting>
    <location file="AnalyticalSolutions.py"/>
  </compounddef>
</doxygen>
